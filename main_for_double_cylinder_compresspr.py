import kivy
kivy.require('1.0.7')

from kivy.config import Config
from kivy.core.window import Window

from kivy.app import App
from kivy.lang import Builder
from kivy.clock import Clock
from kivy.uix.widget import Widget
from kivy.uix.boxlayout import BoxLayout
from kivy.uix.floatlayout import FloatLayout
from kivy.uix.popup import Popup
from kivy.uix.label import Label
from kivy.properties import ObjectProperty, ListProperty
from matplotlib.backends.backend_agg import FigureCanvasAgg
from matplotlib.backend_bases import NavigationToolbar2
from kivy.base import EventLoop
from kivy.graphics.texture import Texture
from timeit import default_timer

import datetime
import time
import serial
import serial.tools.list_ports
import struct
import math
import os
import socket
import re

import pyautogui
import numpy as np
import matplotlib.pyplot as plt
import matplotlib
# matplotlib.use('Agg')
import visa
import threading
from pymodbus.client.sync import ModbusSerialClient as ModbusClient #initialize a serial RTU client instance

try:
    fp = open('.//Config//UI_default_setting.txt','r')
except:
    fp = open('C://Users//Eddie//verificationPlatform//EER//Config//UI_default_setting.txt','r')
col_value = []
for line in fp.readlines():
    col_value.append(line.split()[1])

if col_value[2] == 'True':
    width = 1920
    height = 1080
    Window.fullscreen = True
    Window.size = (int(width), int(height))
elif col_value[2] == 'False':
    width = col_value[3].split('*')[0]
    height = col_value[3].split('*')[1]
    Window.fullscreen = False
    Window.left, Window.top = 0, 30
    Window.size = (int(width), int(height))
Config.set('kivy', 'log_dir', os.path.dirname(os.path.abspath(__file__)) + '\kivy_log')

choosed_Tab = None
sysActiveFlag = False
pauseStateFlag = False

curveNum = 17
getReportInterval = int(col_value[6])

dataBufferSampleCnt = int(col_value[7])
dataBufferForTime = getReportInterval * dataBufferSampleCnt
dataBuffer = [[0] * (math.ceil(dataBufferForTime / getReportInterval) + 1) ] * curveNum
dataBufferStored = [[0] * (math.ceil(dataBufferForTime / getReportInterval) + 1) ] * curveNum

rptCnt = 0
rptCntStored = 0
mouse_x_rec = None

curveName_global = None
curvePos_global = None

############# color param ############
colorDict = {'Red': (1, .2, .2, 1), \
             'Orange': (1, .5, 0, 1), \
             'Yellow': (1, 1, 0, 1), \
             'Green' : (.5, 1, 0, 1), \
             'Blue'  : (0, 1, 1, 1), \
             'Pink'  : (1, .2, 1, 1),\
             'Purple': (.5, 0, 1, 1),\
             'Light Green': (.8, 1, .8),\
             'Light Blue': (.8, .9, 1),\
            }

colorDictHex = {'Red': 'ff3333', \
                'Orange': 'ff7f00', \
                'Yellow': 'ffff00', \
                'Green' : '7fff00', \
                'Blue'  : '00ffff', \
                'Pink'  : 'ff33ff',\
                'Purple': '7f00ff',\
                'Light Green'  : 'ccffcc',\
                'Light Blue'  : 'cce5ff'\
                }

color = ['Red', 'Orange', 'Yellow', 'Green', 'Blue', 'Pink', 'Purple', 'Light Green', 'Light Blue']
color_0 = ['Red', 'Orange', 'Yellow', 'Purple']
color_1 = ['Pink', 'Green', 'Blue']

############# reload param ############
loadFileFullPath = None
reload_timeInterval = None
reload_axis = None
reload_data = None
reload_data_len = None
reload_done_flag = False

##################################################################

class curve_param:
    def __init__(self, **kwargs):
        self.curveName = ['高壓', '低壓', '吐出溫度', '吸入溫度', '毛前溫度', '過冷度', '過熱度', '功率', '能力', 'COP', '壓縮機', '壓縮機電流', '壓縮機IPM', '風扇', '風扇電流', '風扇IPM', 'EEV']
        self.unitName = ['帕', '帕', '℃', '℃', '℃', '℃', '℃', 'W', 'kW/kW', '', 'RPS', 'A', '℃', 'RPM', 'A', '℃', '度', '']
        self.curvePos = {'壓縮機': 'G1_L', '壓縮機電流': 'G0_R', '壓縮機IPM': 'G0_L', \
                         '風扇': 'G1_R', '風扇電流': 'G0_R', '風扇IPM': 'G0_L', \
                         'EEV': 'G1_R' \
                        }
        self.reload_spinner_text_last = []
        for item in self.curvePos:
            self.reload_spinner_text_last.append('N/A')

        self.boardParaStrt = 10

class font_size:
    def __init__(self, **kwargs):
        self.lbl_rpt_font_size = 60
        self.title_lbl_font_size = 20
        self.instr_lbl_font_size = 36
        self.board_lbl_font_size = 30
        self.unit_font_size = 20
        self.raw_data_font_size = 26
        self.statisic_font_size = 50
        self.experiment_setting_font_size = 40
        self.environment_setting_font_size = 40
        self.temperature_line_font_size = 32    

class log_content:
    def __init__(self, **kwargs):
        self.UI_log = ''
        self.debug_log = ''
        self.script_content_raw = ''

#  [UART Port Settings]
class UART_board_port_setting:
    def __init__(self, **kwargs):
        self.serial = None
        self.BAUDRATE = 115200
        self.CRC_POLY = 0x04C11DB7
        self.custom_crc_table = {}
        self.timeout = 2
        self.detected_port = None
        self.recv_package_num = 8 # 2 bytes per package
                                  # CMD, compSpeed, EEV, fanSpeed, IPM, compCurrm, fanCurr, CRC
        self.error_response = ['Failed', 'TARGET TIMEOUT', 'COM port not found', 'SEVER TIMEOUT', 'CRC Failed', 'CMD collision', 'Please Restart/Open the Remote Sever']
        self.threadStartFlag = False

class sever_PC_setting:
    def __init__(self, **kwargs):
        self.SERVER_IP = '192.168.0.3'
        self.PORT_NUMBER = 7000
        self.SIZE = 1024
        self.mySocket = None
        self.timeout = 3

class UI_system_config:
    def __init__(self, **kwargs):
        # for UI bootup draw default fig
        self.bootUpFlag = True

        # UI status flag
        self.boardConnectionFlag = False
        self.chk_board_status_flag = False
        self.getReportFlag = False

        # script mode related
        self.scriptMode_Flag = False
        self.scriptStop_flag = False

        # monitor mode related
        self.monitorMode_Start_Flag = False
        self.monitorMode_Spinner_Fixed_Flag = False

        # prevent checkbox toggle by user under some condition
        self.checkboxFixedFlag = False        

        # only for board mode = False
        self.paramSetFlag = True

        # operating mode
        self.eerLabMode = False
        self.instrMode = False
        self.boardMode = True
        self.remoteMode = False

        # use to judge if start or set procedure is done
        self.setEEV_val = None

        # for report update
        self.compCurr_old = None
        self.fanCurr_old = None
        self.fan_old = None
        self.compIpm_old = None
        self.fanIpm_old = None
        self.comp_start_flag = False
        self.fan_start_flag = False
        self.fanCurr_start_flag = False
        self.alpha_comp = None
        self.alpha_fan = None
        self.alpha_ipm = None
        self.alpha_fanCurr = None

        # for file saveing
        self.sysActiveTime = None

        # for abnormal report from target handling
        self.prev_report = None

class tos5200:
    def __init__(self, **kwargs):
        self.DEV = None
        self.abort_flag = None
        self.port = "ASRL" + str(4) + "::INSTR"
        self.baudrate = 9600

class recorder:
    def __init__(self, **kwargs):
        self.DEV = None
        self.port = "ASRL" + str(4) + "::INSTR"
        self.baudrate = 9600
        self.TCP_IP = '192.168.0.239'
        self.TCP_PORT = 34152
        self.BUFFER_SIZE = 65536

class powerMeter:
    def __init__(self, **kwargs):
        self.DEV = None
        self.port = "USB0::0x0B21::0x0025::43325242313730323256::INSTR"
        # self.port = "GPIB0::2::INSTR"

class T_Machine:
    def __init__(self, **kwargs):
        self.DEV = None
        self.port = 'COM4'
        self.under_process_flag = False

class NF:
    def __init__(self, **kwargs):
        self.DEV = None
        self.port = 'GPIB0::2::INSTR'
        self.mode = None
        self.simulation_step_number = 9

class MDO4034C:
    def __init__(self, **kwargs):
        self.DEV = None
        self.port = "TCPIP::192.168.0.2::INSTR"

class instrument_config:
    def __init__(self, **kwargs):
        self.rm = None
        self.tos5200 = tos5200()
        self.recorder = recorder()
        self.powerMeter = powerMeter()
        self.T_Machine = T_Machine()
        self.NF = NF()
        self.MDO4034C = MDO4034C()

class figure_label:
    def __init__(self, **kwargs):
        self.left_min = None
        self.left_max = None
        self.right_min = None
        self.right_max = None

class figure_config:
    def __init__(self, **kwargs):
        self.figure0 = figure_label()
        self.figure1 = figure_label()

        self.figure0.left_min = 00
        self.figure0.left_max = 90
        self.figure0.right_min = 0
        self.figure0.right_max = 15

        self.figure1.left_min = -5
        self.figure1.left_max = 125
        self.figure1.right_min = -5
        self.figure1.right_max = 1010

class control_board_param:
    def __init__(self, **kwargs):
        self.compRPM_init = '63'
        self.EEVDeg_init = '220'
        self.FanSpeed_init = '840'

        self.compRPM_step = 1
        self.EEVDeg_step = 1
        self.FanSpeed_step = 60

        self.compRPM_min = 1
        self.compRPM_max = 120
        self.EEVDeg_min = 0
        self.EEVDeg_max = 480
        self.FanSpeed_min = 0
        self.FanSpeed_max = 1200

        self.allowable_mode = {(True, True, True): 'Normal_Mode', \
                        (True, False, False): 'Comp_Only_Mode', \
                        (False, True, False): 'EEV_Only_Mode', \
                        (False, False, True): 'Fan_Only_Mode', \
                        (True, True, False): 'Comp_EEV_Mode', \
                        (True, False, True): 'Comp_Fan_Mode', \
                        (False, True, True): 'EEV_Fan_Mode'}    

class script_param:
    def __init__(self, **kwargs):
        self.report_mapping = {'_壓縮機轉速_結果': 'lbl_rpt_10', '_壓縮機電流_結果': 'lbl_rpt_11', '_壓縮機IPM_結果': 'lbl_rpt_12', \
                               '_風扇轉速_結果': 'lbl_rpt_13', '_風扇電流_結果': 'lbl_rpt_14', '_風扇IPM_結果': 'lbl_rpt_15', \
                               '_EEV_結果': 'lbl_rpt_16', '_Scale_結果': 'lbl_rpt_17',\
                               '_壓縮機_參數': 'Input_compRPM', '_EEV_參數': 'Input_EEVDeg', '_風扇_參數': 'Input_FanSpeed', \
                               }

        self.self_define_var = {'_totalCnt': 0, '_passCnt': 0, '_failCnt': 0}
        self.script_start_time = None

class raw_data_param:
    def __init__(self, **kwargs):
        self.param_name_row_0 = ['室內乾球', '室內濕球', '室外乾球', '室外濕球', '風洞乾球', '風洞濕球', '零壓', '差壓']
        self.param_name_row_1 = ['高壓1', '低壓1', '高壓2', '低壓2', '高壓3', '低壓3', '過冷度', '過熱度']
        self.param_name_row_2 = ['吐出溫度', '吸入溫度', '毛前溫度', '室外感溫線4', '室外感溫線5', '室外感溫線6', '室外感溫線7', '室外感溫線8']
        self.param_name_row_3 = ['室內感溫線1', '室內感溫線2', '室內感溫線3', '室內感溫線4', '室內感溫線5', '室內感溫線6', '室內感溫線7', '室內感溫線8']
        self.param_name_row_4 = ['電壓', '電流', '功率', '功率因素', '總能力', '實測/標示', '能源效率比', '實測/標示']

        self.param_index_name = {'0001': '室內乾球1', '0002':  '室內濕球1', '0003': '室內乾球2', '0004': '室內濕球2', '0005': '室內乾球3', '0006':  '室內濕球3', '0007': '室內乾球4', '0008': '室內濕球4', \
                            '0009': '風洞乾球1', '0010':  '風洞濕球1', '0101': '風洞乾球2', '0102': '風洞濕球2', '0103': '風洞乾球3', '0104':  '風洞濕球3', '0105': '風洞乾球4', '0106': '風洞濕球4', \
                            '0107': '零壓1', '0108':  '零壓2', '0109': '零壓3', '0110': '零壓4', '0201': '差壓1', '0202':  '差壓2', '0203': '差壓3', '0204': '差壓4', \
                            '0205': '室外乾球1', '0206':  '室外濕球1', '0207': '室外乾球2', '0208': '室外濕球2', '0209': '室外乾球3', '0210':  '室外濕球3', '0301': '室外乾球4', '0302': '室外濕球4', \
                            '0303': '相對溼度', '0304': None, '0305': '冰水桶溫', '0306': '入水溫', '0307': '出水溫', '0308': '冰水流量', '0309': '高壓1', '0310': '高壓2', '0905': '高壓3', '0906': '低壓1', '0907': '低壓2', '0908': '低壓3', \
                            '0401': '室內感溫線1', '0402': '室內感溫線2', '0403': '室內感溫線3', '0404': '室內感溫線4', '0405': '室內感溫線5', '0406': '室內感溫線6', '0407': '室內感溫線7', '0408': '室內感溫線8', '0409': '室內感溫線9', '0410': '室內感溫線10', \
                            '0501': '室內感溫線11', '0502': '室內感溫線12', '0503': '室內感溫線13', '0504': '室內感溫線14', '0505': '室內感溫線15', '0506': '室內感溫線16', '0507': '室內感溫線17', '0508': '室內感溫線18', '0509': '室內感溫線19', '0510': '室內感溫線20', \
                            '0601': '室內感溫線21', '0602': '室內感溫線22', '0603': '室內感溫線23', '0604': '室內感溫線24', '0605': '室內感溫線25', '0606': '室內感溫線26', '0607': '室內感溫線27', '0608': '室內感溫線28', '0609': '室內感溫線29', '0610': '室內感溫線30', \
                            '0701': '室外感溫線1', '0702': '室外感溫線2', '0703': '室外感溫線3', '0704': '室外感溫線4', '0705': '室外感溫線5', '0706': '室外感溫線6', '0707': '室外感溫線7', '0708': '室外感溫線8', '0709': '室外感溫線9', '0710': '室外感溫線10', \
                            '0801': '室外感溫線11', '0802': '室外感溫線12', '0803': '室外感溫線13', '0804': '室外感溫線14', '0805': '室外感溫線15', '0806': '室外感溫線16', '0807': '室外感溫線17', '0808': '室外感溫線18', '0809': '室外感溫線19', '0810': '室外感溫線20', \
                            '0901': '室外感溫線21', '0902': '室外感溫線22', '0903': '室外感溫線23', '0904': '室外感溫線24'}
class setting_id:
    def __init__(self, **kwargs):
        self.default_setting = []
        self.experiment_setting_id = ['experiment_setting_save_cfg', 'test_name', 'machine_type_number', 'outdoor_machine_name', 'compressor_type_number', 'outdoor_machine_power', 'compressor_capacitor', 'outdoor_motor_type_number', \
                                'condenser_type_number', 'outdoor_motor_speed', 'evaporator_type_number', 'indoor_machine_name', 'capillary_type_number', 'indoor_motor_type_number', 'power_spec', \
                                'indoor_motor_speed', 'refrigerant', 'wind_hole_choose', 'wind_hole_power', 'rated_cooling_capacity', 'rated_warming_capacity', 'rated_cooling_eer', 'rated_warming_eer', \
                                'rated_cooling_power', 'rated_warming_power']

        self.environment_setting_id = ['environment_setting_name', 'environment_calculation', 'environment_indoor_dry', 'environment_indoor_wet', 'environment_outdoor_dry', 'environment_outdoor_wet']

        self.temperature_line_setting_id = ['temperature_line_setting_save_cfg', 'spinner_indoor_temp_line_0', 'spinner_indoor_temp_line_1', 'spinner_indoor_temp_line_2', 'spinner_indoor_temp_line_3', \
                                    'spinner_indoor_temp_line_4', 'spinner_indoor_temp_line_5', 'spinner_indoor_temp_line_6', 'spinner_indoor_temp_line_7', 'spinner_outdoor_temp_line_0', \
                                    'spinner_outdoor_temp_line_1', 'spinner_outdoor_temp_line_2', 'spinner_outdoor_temp_line_3', 'spinner_outdoor_temp_line_4', 'spinner_outdoor_temp_line_5', \
                                    'spinner_outdoor_temp_line_6', 'spinner_outdoor_temp_line_7']

        self.UI_setting_id = ['UI_com_port', 'debug_com_port', 'full_screen', 'resolution', 'monitor_mode_enable', 'graph_enable', 'graph_interval', 'graph_sample_cnt', 'compCurr_protect', 'fanCurr_protect', 'ipmTemp_protect', 'alpha_comp', 'alpha_fan', 'alpha_fanCurr', 'alpha_ipm', 'indoor_system', 'outdoor_system', 'power_supply', 'spray_head_2p5_1', 'spray_head_2p5_2', 'spray_head_3', 'spray_head_4', 'spray_head_6']

        self.tos5200_setting_id = ['tos5200_setting_save_cfg', 'tos5200_config_frequency', 'tos5200_config_voltage_test', 'tos5200_config_voltage_limit', 'tos5200_config_current_limit_upper', 'tos5200_config_current_limit_lower_active', 'tos5200_config_current_limit_lower', \
                            'tos5200_config_test_time_active', 'tos5200_config_test_time', 'tos5200_config_voltage_rise_time', 'tos5200_config_voltage_fall_time', 'tos5200_config_start_voltage', 'tos5200_config_meas_mode']

        self.NF_setting_id = ['NF_setting_save_cfg', 'NF_Continuous_Mode', 'NF_Continuous_AC_Voltage', 'NF_Continuous_DC_Voltage', 'NF_Continuous_Vrms_Limiter', 'NF_Continuous_Frequency', \
                        'NF_Continuous_Freq_Limiter_Low', 'NF_Continuous_Freq_Limiter_High', 'NF_Continuous_Start_Phase', 'NF_Continuous_Off_Phase', 'NF_Continuous_Current_Peak_Limiter_Checkbox', \
                        'NF_Continuous_Current_Peak_Limiter_Positive', 'NF_Continuous_Current_Peak_Limiter_Negative', 'NF_Continuous_Current_rms_Limiter_Checkbox', 'NF_Continuous_Current_rms_Limiter', \
                        'NF_Sequence_Step0_AC_Voltage', 'NF_Sequence_Step0_AC_Voltage_Mode', 'NF_Sequence_Step0_DC_Voltage', 'NF_Sequence_Step0_DC_Voltage_Mode', 'NF_Sequence_Step0_Frequency', 'NF_Sequence_Step0_Frequency_Mode', \
                        'NF_Sequence_Step0_Time', 'NF_Sequence_Step0_Start_Phase_Enable', 'NF_Sequence_Step0_Start_Phase', 'NF_Sequence_Step0_Off_Phase_Enable', 'NF_Sequence_Step0_Off_Phase', \
                        'NF_Sequence_Step1_AC_Voltage', 'NF_Sequence_Step1_AC_Voltage_Mode', 'NF_Sequence_Step1_DC_Voltage', 'NF_Sequence_Step1_DC_Voltage_Mode', 'NF_Sequence_Step1_Frequency', 'NF_Sequence_Step1_Frequency_Mode', \
                        'NF_Sequence_Step1_Time', 'NF_Sequence_Step1_Start_Phase_Enable', 'NF_Sequence_Step1_Start_Phase', 'NF_Sequence_Step1_Off_Phase_Enable', 'NF_Sequence_Step1_Off_Phase', 'NF_Sequence_Step1_Jump_To_Enable', \
                        'NF_Sequence_Step1_Jump_To', 'NF_Sequence_Step1_Jump_Count', 'NF_Sequence_Step1_Step_Termination', \
                        'NF_Sequence_Step2_AC_Voltage', 'NF_Sequence_Step2_AC_Voltage_Mode', 'NF_Sequence_Step2_DC_Voltage', 'NF_Sequence_Step2_DC_Voltage_Mode', 'NF_Sequence_Step2_Frequency', 'NF_Sequence_Step2_Frequency_Mode', \
                        'NF_Sequence_Step2_Time', 'NF_Sequence_Step2_Start_Phase_Enable', 'NF_Sequence_Step2_Start_Phase', 'NF_Sequence_Step2_Off_Phase_Enable', 'NF_Sequence_Step2_Off_Phase', 'NF_Sequence_Step2_Jump_To_Enable', \
                        'NF_Sequence_Step2_Jump_To', 'NF_Sequence_Step2_Jump_Count', 'NF_Sequence_Step2_Step_Termination', \
                        'NF_Sequence_Step3_AC_Voltage', 'NF_Sequence_Step3_AC_Voltage_Mode', 'NF_Sequence_Step3_DC_Voltage', 'NF_Sequence_Step3_DC_Voltage_Mode', 'NF_Sequence_Step3_Frequency', 'NF_Sequence_Step3_Frequency_Mode', \
                        'NF_Sequence_Step3_Time', 'NF_Sequence_Step3_Start_Phase_Enable', 'NF_Sequence_Step3_Start_Phase', 'NF_Sequence_Step3_Off_Phase_Enable', 'NF_Sequence_Step3_Off_Phase', 'NF_Sequence_Step3_Jump_To_Enable', \
                        'NF_Sequence_Step3_Jump_To', 'NF_Sequence_Step3_Jump_Count', 'NF_Sequence_Step3_Step_Termination', \
                        'NF_Sequence_Step4_AC_Voltage', 'NF_Sequence_Step4_AC_Voltage_Mode', 'NF_Sequence_Step4_DC_Voltage', 'NF_Sequence_Step4_DC_Voltage_Mode', 'NF_Sequence_Step4_Frequency', 'NF_Sequence_Step4_Frequency_Mode', \
                        'NF_Sequence_Step4_Time', 'NF_Sequence_Step4_Start_Phase_Enable', 'NF_Sequence_Step4_Start_Phase', 'NF_Sequence_Step4_Off_Phase_Enable', 'NF_Sequence_Step4_Off_Phase', 'NF_Sequence_Step4_Jump_To_Enable', \
                        'NF_Sequence_Step4_Jump_To', 'NF_Sequence_Step4_Jump_Count', 'NF_Sequence_Step4_Step_Termination', \
                        'NF_Sequence_Step5_AC_Voltage', 'NF_Sequence_Step5_AC_Voltage_Mode', 'NF_Sequence_Step5_DC_Voltage', 'NF_Sequence_Step5_DC_Voltage_Mode', 'NF_Sequence_Step5_Frequency', 'NF_Sequence_Step5_Frequency_Mode', \
                        'NF_Sequence_Step5_Time', 'NF_Sequence_Step5_Start_Phase_Enable', 'NF_Sequence_Step5_Start_Phase', 'NF_Sequence_Step5_Off_Phase_Enable', 'NF_Sequence_Step5_Off_Phase', 'NF_Sequence_Step5_Jump_To_Enable', \
                        'NF_Sequence_Step5_Jump_To', 'NF_Sequence_Step5_Jump_Count', 'NF_Sequence_Step5_Step_Termination', \
                        'NF_Sequence_Step6_AC_Voltage', 'NF_Sequence_Step6_AC_Voltage_Mode', 'NF_Sequence_Step6_DC_Voltage', 'NF_Sequence_Step6_DC_Voltage_Mode', 'NF_Sequence_Step6_Frequency', 'NF_Sequence_Step6_Frequency_Mode', \
                        'NF_Sequence_Step6_Time', 'NF_Sequence_Step6_Start_Phase_Enable', 'NF_Sequence_Step6_Start_Phase', 'NF_Sequence_Step6_Off_Phase_Enable', 'NF_Sequence_Step6_Off_Phase', 'NF_Sequence_Step6_Jump_To_Enable', \
                        'NF_Sequence_Step6_Jump_To', 'NF_Sequence_Step6_Jump_Count', 'NF_Sequence_Step6_Step_Termination', \
                        'NF_Sequence_Step7_AC_Voltage', 'NF_Sequence_Step7_AC_Voltage_Mode', 'NF_Sequence_Step7_DC_Voltage', 'NF_Sequence_Step7_DC_Voltage_Mode', 'NF_Sequence_Step7_Frequency', 'NF_Sequence_Step7_Frequency_Mode', \
                        'NF_Sequence_Step7_Time', 'NF_Sequence_Step7_Start_Phase_Enable', 'NF_Sequence_Step7_Start_Phase', 'NF_Sequence_Step7_Off_Phase_Enable', 'NF_Sequence_Step7_Off_Phase', 'NF_Sequence_Step7_Jump_To_Enable', \
                        'NF_Sequence_Step7_Jump_To', 'NF_Sequence_Step7_Jump_Count', 'NF_Sequence_Step7_Step_Termination', \
                        'NF_Sequence_Step8_AC_Voltage', 'NF_Sequence_Step8_AC_Voltage_Mode', 'NF_Sequence_Step8_DC_Voltage', 'NF_Sequence_Step8_DC_Voltage_Mode', 'NF_Sequence_Step8_Frequency', 'NF_Sequence_Step8_Frequency_Mode', \
                        'NF_Sequence_Step8_Time', 'NF_Sequence_Step8_Start_Phase_Enable', 'NF_Sequence_Step8_Start_Phase', 'NF_Sequence_Step8_Off_Phase_Enable', 'NF_Sequence_Step8_Off_Phase', 'NF_Sequence_Step8_Jump_To_Enable', \
                        'NF_Sequence_Step8_Jump_To', 'NF_Sequence_Step8_Jump_Count', 'NF_Sequence_Step8_Step_Termination', \
                        'NF_Sequence_Mode', 'NF_Sequence_time_unit',\
                        'NF_Simulation_Initial_AC_Voltage', 'NF_Simulation_Initial_Frequency', 'NF_Simulation_Initial_Time', 'NF_Simulation_Initial_Start_Phase_Enable', 'NF_Simulation_Initial_Start_Phase', 'NF_Simulation_Initial_Off_Phase_Enable', 'NF_Simulation_Initial_Off_Phase', \
                        'NF_Simulation_Normal1_AC_Voltage', 'NF_Simulation_Normal1_Frequency', 'NF_Simulation_Normal1_Time', 'NF_Simulation_Normal1_Start_Phase_Enable', 'NF_Simulation_Normal1_Start_Phase', 'NF_Simulation_Normal1_Off_Phase_Enable', 'NF_Simulation_Normal1_Off_Phase', \
                        'NF_Simulation_Trans1_AC_Voltage', 'NF_Simulation_Trans1_Frequency', 'NF_Simulation_Trans1_Time', 'NF_Simulation_Trans1_Start_Phase', 'NF_Simulation_Trans1_Off_Phase', \
                        'NF_Simulation_Abnormal_AC_Voltage', 'NF_Simulation_Abnormal_Frequency', 'NF_Simulation_Abnormal_Time', 'NF_Simulation_Abnormal_Start_Phase_Enable', 'NF_Simulation_Abnormal_Start_Phase', 'NF_Simulation_Abnormal_Off_Phase_Enable', 'NF_Simulation_Abnormal_Off_Phase', \
                        'NF_Simulation_Trans2_AC_Voltage', 'NF_Simulation_Trans2_Frequency', 'NF_Simulation_Trans2_Time', 'NF_Simulation_Trans2_Start_Phase', 'NF_Simulation_Trans2_Off_Phase', \
                        'NF_Simulation_Normal2_AC_Voltage', 'NF_Simulation_Normal2_Frequency', 'NF_Simulation_Normal2_Time', 'NF_Simulation_Normal2_Start_Phase_Enable', 'NF_Simulation_Normal2_Start_Phase', 'NF_Simulation_Normal2_Off_Phase_Enable', 'NF_Simulation_Normal2_Off_Phase', \
                        'NF_Simulation_repeat', 'NF_Simulation_time_unit']

        self.environment_setting_lbl = ['工況名', '計算方式', '室內乾球', '室內濕球', '室外乾球', '室外濕球']
        self.environment_temp_step = 1

        self.indoor_temperature_line_num = []
        for idx in range(1, 30):
            self.indoor_temperature_line_num.append(str(idx))

        self.outdoor_temperature_line_num = []
        for idx in range(1, 24):
            self.outdoor_temperature_line_num.append(str(idx))

class refri_table:
    def __init__(self, **kwargs):
        self.refri_table = {3.66 : -16.30, 3.76 : -15.70, 3.86 : -15.10, 3.97 : -14.50, 4.07 : -13.90, 4.17 : -13.40, 4.27 : -12.80, 4.38 : -12.30, 4.48 : -11.70, \
                    4.58 : -11.20, 4.68 : -10.70, 4.78 : -10.20, 4.89 :  -9.68, 4.99 :  -9.17, 5.09 :  -8.67, 5.19 :  -8.19, 5.29 :  -7.72, 5.40 :  -7.24, \
                    5.50 :  -6.77, 5.60 :  -6.30, 5.70 :  -5.85, 5.80 :  -5.40, 5.91 :  -4.95, 6.01 :  -4.50, 6.11 :  -4.06, 6.21 :  -3.63, 6.31 :  -3.15, \
                    6.42 :  -2.77, 6.52 :  -2.35, 6.62 :  -1.94, 6.72 :  -1.53, 6.82 :  -1.12, 6.93 :  -0.72, 7.03 :  -0.32, 7.13 :   0.09, 7.23 :   0.48, \
                    7.33 :   0.87, 7.44 :   1.25, 7.54 :   1.63, 7.64 :   2.01, 7.74 :   2.38, 7.84 :   2.75, 7.95 :   3.12, 8.05 :   3.49, 8.15 :   3.85, \
                    8.25 :   4.21, 8.35 :   4.56, 8.46 :   4.91, 8.56 :   5.26, 8.66 :   5.61, 8.76 :   5.95, 8.86 :   5.61, 8.97 :   6.63, 9.07 :   6.97, \
                    9.17 :   7.30, 9.27 :   7.64, 9.38 :   7.97, 9.48 :   8.29, 9.58 :   8.62, 9.68 :   8.94, 9.78 :   9.26, 9.89 :   9.57, 9.99 :   9.89, \
                    10.09:  10.20, 10.19:  10.51, 10.29:  10.82, 10.40:  11.13, 10.50:  11.43, 10.60:  11.73, 10.70:  12.03, 10.80:  12.33, 10.91:  12.63, \
                    11.01:  12.92, 11.11:  13.22, 11.21:  13.51, 11.31:  13.80, 11.42:  14.08, 11.52:  14.37, 11.62:  14.65, 11.72:  14.93, 11.82:  15.21, \
                    11.93:  15.48, 12.03:  15.76, 12.13:  16.04, 12.23:  16.32, 12.33:  16.58, 12.44:  16.85, 12.54:  17.12, 12.64:  17.39, 12.74:  17.66, \
                    12.84:  17.92, 12.95:  18.18, 13.05:  18.44, 13.15:  18.70, 13.25:  18.97, 13.35:  19.22, 13.46:  19.47, 13.56:  19.73, 13.66:  19.98, \
                    13.76:  20.24, 13.86:  20.48, 13.97:  20.73, 14.07:  20.98, 14.17:  21.23, 14.27:  21.48, 14.38:  21.72, 14.48:  21.96, 14.58:  22.20, \
                    14.68:  22.44, 14.78:  22.69, 14.89:  22.92, 14.99:  23.16, 15.09:  23.40, 15.19:  23.63, 15.29:  23.87, 15.40:  24.10, 15.50:  24.33, \
                    15.60:  24.56, 15.70:  24.79, 15.80:  25.02, 15.91:  25.25, 16.01:  25.47, 16.11:  25.70, 16.21:  25.92, 16.31:  26.15, 16.42:  26.37, \
                    16.52:  26.59, 16.62:  26.81, 16.72:  27.03, 16.82:  27.25, 16.93:  27.47, 17.03:  27.68, 17.13:  27.90, 17.23:  28.11, 17.33:  28.33, \
                    17.44:  28.54, 17.54:  28.75, 17.64:  28.96, 17.74:  29.17, 17.84:  29.39, 17.95:  29.59, 18.05:  29.80, 18.15:  30.00, 18.25:  30.21, \
                    18.35:  30.42, 18.46:  30.62, 18.56:  30.82, 18.66:  31.02, 18.76:  31.23, 18.86:  31.43, 18.97:  31.63, 19.07:  31.83, 19.17:  32.03, \
                    19.27:  32.23, 19.38:  32.43, 19.48:  32.62, 19.58:  32.82, 19.68:  33.01, 19.78:  33.21, 19.89:  33.40, 19.99:  33.59, 20.09:  33.78, \
                    20.19:  33.98, 20.29:  34.17, 20.40:  34.36, 20.50:  34.55, 20.60:  34.74, 20.70:  34.92, 20.80:  35.11, 20.91:  35.30, 21.01:  35.48, \
                    21.11:  35.67, 21.21:  35.85, 21.31:  36.04, 21.42:  36.22, 21.52:  36.40, 21.62:  36.58, 21.72:  36.77, 21.82:  36.95, 21.93:  37.13, \
                    22.03:  37.31, 22.13:  37.49, 22.23:  37.67, 22.33:  37.85, 22.44:  38.03, 22.54:  38.20, 22.64:  38.38, 22.74:  38.55, 22.84:  38.73, \
                    22.95:  38.90, 23.05:  39.07, 23.15:  39.25, 23.25:  39.42, 23.35:  39.59, 23.46:  39.77, 23.56:  39.94, 23.66:  40.11, 23.76:  40.28, \
                    23.86:  40.45, 23.97:  40.62, 24.07:  40.78, 24.17:  40.95, 24.27:  41.12, 24.38:  41.29, 24.48:  41.46, 24.58:  41.62, 24.68:  41.78, \
                    24.78:  41.95, 24.89:  42.11, 24.99:  42.28, 25.09:  42.44, 25.19:  42.60, 25.29:  42.76, 25.40:  42.93, 25.50:  43.09, 25.60:  43.25, \
                    25.70:  43.41, 25.80:  43.57, 25.91:  43.73, 26.01:  43.89, 26.11:  44.04, 26.21:  44.20, 26.31:  44.36, 26.42:  44.52, 26.52:  44.68, \
                    26.62:  44.83, 26.72:  44.99, 26.82:  45.14, 26.93:  45.30, 27.03:  45.46, 27.13:  45.61, 27.23:  45.76, 27.33:  45.91, 27.44:  46.06, \
                    27.54:  46.22, 27.64:  46.37, 27.74:  46.52, 27.84:  46.67, 27.95:  46.82, 28.05:  46.98, 28.15:  47.13, 28.25:  47.28, 28.35:  47.43, \
                    28.46:  47.58, 28.56:  47.73, 28.66:  47.87, 28.76:  48.02, 28.86:  48.16, 28.97:  48.31, 29.07:  48.46, 29.17:  48.60, 29.27:  48.75, \
                    29.38:  48.89, 29.48:  49.04, 29.58:  49.19, 29.68:  49.33, 29.78:  49.47, 29.89:  49.61, 29.99:  49.75, 30.09:  49.90, 30.19:  50.04, \
                    30.29:  50.18, 30.40:  50.32, 30.50:  50.46, 30.60:  50.61, 30.70:  50.75, 30.80:  50.89, 30.91:  51.03, 31.01:  51.17, 31.11:  51.31, \
                    31.21:  51.44, 31.31:  51.58, 31.42:  51.72, 31.52:  51.85, 31.62:  51.99, 31.72:  52.13, 31.82:  52.26, 31.93:  52.40, 32.03:  52.53, \
                    32.13:  52.67, 32.23:  52.81, 32.33:  52.94, 32.44:  53.08, 32.54:  53.21, 32.64:  53.35, 32.74:  53.48, 32.84:  53.61, 32.95:  53.75, \
                    33.05:  53.88, 33.15:  54.01, 33.25:  54.14, 33.35:  54.27, 33.46:  54.41, 33.56:  54.54, 33.66:  54.67, 33.76:  54.80, 33.86:  54.93, \
                    33.97:  55.06, 34.07:  55.19, 34.17:  55.32, 34.27:  55.44, 34.38:  55.57, 34.48:  55.70, 34.58:  55.83, 34.68:  55.96, 34.78:  56.09, \
                    34.89:  56.21, 34.99:  56.34, 35.09:  56.46, 35.19:  56.59, 35.29:  56.72, 35.40:  56.84, 35.50:  56.97, 35.60:  57.09, 35.70:  57.22, \
                    35.80:  57.34, 35.91:  57.46, 36.01:  57.59, 36.11:  57.71, 36.21:  57.84, 36.31:  57.96, 36.42:  58.08, 36.52:  58.21, 36.62:  58.33, \
                    36.72:  58.46, 36.82:  58.58, 36.93:  58.70, 37.03:  58.82, 37.13:  58.94, 37.23:  59.06, 37.33:  59.18, 37.44:  59.30, 37.54:  59.42, \
                    37.64:  59.54, 37.74:  59.66, 37.84:  59.77, 37.95:  59.89, 38.05:  60.01, 38.15:  60.13, 38.25:  60.25, 38.35:  60.37, 38.46:  60.48, \
                    38.56:  60.60, 38.66:  60.72, 38.76:  60.84, 38.86:  60.95, 38.97:  61.07, 39.07:  61.19, 39.17:  61.30, 39.27:  61.42, 39.38:  61.53, \
                    39.48:  61.65, 39.58:  61.76, 39.68:  61.88, 39.78:  61.99}

###################################################################################

def intp_pt(xmin, xmax, ymin, ymax, x):
    return ymin + (ymax - ymin) * (x - xmin) / (xmax - xmin)

class PopUpDialog(FloatLayout):
    text = ObjectProperty(None)
    cancel = ObjectProperty(None)

class PopUpDialogNoCancel(FloatLayout):
    text = ObjectProperty(None)

class LoadFileDialog(FloatLayout):
    chooseFile = ObjectProperty(None)
    cancel = ObjectProperty(None)

    def showFileName(self, selection):
        if len(selection) == 0:
            self.ids.fileName.text = ''
        else:
            fileName = selection[0].split("\\")[-1]
            self.ids.fileName.text = fileName

class LoadExpCfgDialog(FloatLayout):
    chooseExpCfg = ObjectProperty(None)
    cancel = ObjectProperty(None)

    def showExpCfgName(self, selection):
        if len(selection) == 0:
            self.ids.expCfgName.text = ''
        else:
            expCfgName = selection[0].split("\\")[-1]
            self.ids.expCfgName.text = expCfgName

class LoadTempCfgDialog(FloatLayout):
    chooseTempCfg = ObjectProperty(None)
    cancel = ObjectProperty(None)

    def showTempCfgName(self, selection):
        if len(selection) == 0:
            self.ids.tempCfgName.text = ''
        else:
            tempCfgName = selection[0].split("\\")[-1]
            self.ids.tempCfgName.text = tempCfgName

class LoadScriptCfgDialog(FloatLayout):
    chooseScriptCfg = ObjectProperty(None)
    cancel = ObjectProperty(None)

    def showScriptCfgName(self, selection):
        if len(selection) == 0:
            self.ids.scriptCfgName.text = ''
        else:
            scriptCfgName = selection[0].split("\\")[-1]
            self.ids.scriptCfgName.text = scriptCfgName

class LoadEnvCfgDialog(FloatLayout):
    chooseEnvCfg = ObjectProperty(None)
    cancel = ObjectProperty(None)

    font_size = 36

    environment_setting_lbl = ['工況名', '計算方式', '室內乾球', '室內濕球', '室外乾球', '室外濕球']

    def showEnvCfgName(self, selection):
        if len(selection) == 0:
            self.ids.envCfgName.text = ''
        else:
            envCfgName = selection[0].split("\\")[-1]
            self.ids.envCfgName.text = envCfgName

            fp = open(selection[0],'r')
            
            idx = 0
            for line in fp.readlines():
                if 'bias' in line:
                    pass
                else:
                    element = line.split()
                    self.ids['envCfgDetail_' + str(idx)].text = element[1]
                    idx = idx + 1

class Loadtos5200CfgDialog(FloatLayout):
    choosetos5200Cfg = ObjectProperty(None)
    cancel = ObjectProperty(None)

    def showtos5200CfgName(self, selection):
        if len(selection) == 0:
            self.ids.tos5200CfgName.text = ''
        else:
            tos5200CfgName = selection[0].split("\\")[-1]
            self.ids.tos5200CfgName.text = tos5200CfgName

class MatplotFigure(Widget):

    """Widget to show a matplotlib figure in kivy.
    The figure is rendered internally in an AGG backend then
    the rgb data is obtained and blitted into a kivy texture.
    """

    figure = ObjectProperty(None)
    _box_pos = ListProperty([0, 0])
    _box_size = ListProperty([0, 0])
    _img_texture = ObjectProperty(None)
    _bitmap = None
    _pressed = False
    figcanvas = ObjectProperty(None)
    # I Chose composition over MI because of name clashes

    def on_figure(self, obj, value):
        self.figcanvas = _FigureCanvas(self.figure, self)
        self.figcanvas._isDrawn = False
        l, b, w, h = self.figure.bbox.bounds
        w = int(math.ceil(w))
        h = int(math.ceil(h))
        self.width = w
        self.height = h

        # Texture
        self._img_texture = Texture.create(size=(w, h))

    def __init__(self, figure=None, *args, **kwargs):
        super(MatplotFigure, self).__init__(*args, **kwargs)
        self.figure = figure
        # Event binding
        EventLoop.window.bind(mouse_pos=self.on_mouse_move)
        self.bind(size=self._onSize)

    def _draw_bitmap(self):
        if self._bitmap is None:
            print("No bitmap!")
            return
        self._img_texture = Texture.create(size=(self.bt_w, self.bt_h))
        self._img_texture.blit_buffer(
            self._bitmap, colorfmt="rgb", bufferfmt='ubyte')
        self._img_texture.flip_vertical()

    def on_mouse_move(self, window, mouse_pos):
        """ Mouse move """
        global mouse_x_rec

        if self._pressed:  # Do not process this event if there's a touch_move
            return
        mouse_x, mouse_y = mouse_pos

        mouse_x_rec = mouse_x

        if self.collide_point(mouse_x, mouse_y):
            real_x, real_y = mouse_x - self.pos[0], mouse_y - self.pos[1]
            self.figcanvas.motion_notify_event(real_x, real_y, guiEvent=None)

    def on_touch_down(self, event):
        x, y = event.x, event.y

        if self.collide_point(x, y):
            self._pressed = True
            real_x, real_y = x - self.pos[0], y - self.pos[1]

            self.figcanvas.button_press_event(real_x, real_y, 1, guiEvent=event)

    def on_touch_move(self, event):
        """ Mouse move while pressed """
        
        x, y = event.x, event.y
        if self.collide_point(x, y):
            real_x, real_y = x - self.pos[0], y - self.pos[1]
            self.figcanvas.motion_notify_event(real_x, real_y, guiEvent=event)

    def on_touch_up(self, event):

        x, y = event.x, event.y
        if self._box_size[0] != 0 or self._box_size[1] != 0:
            self.reset_box()
        if self.collide_point(x, y):
            pos_x, pos_y = self.pos
            real_x, real_y = x - pos_x, y - pos_y
            self.figcanvas.button_release_event(real_x, real_y, 1, guiEvent=event)
            self._pressed = False

    def new_timer(self, *args, **kwargs):
        pass  # TODO

    def _onSize(self, o, size):
        if self.figure is None:
            return
        # Creat a new, correctly sized bitmap
        self._width, self._height = size
        self._isDrawn = False

        if self._width <= 1 or self._height <= 1:
            return

        dpival = self.figure.dpi
        winch = self._width / dpival
        hinch = self._height / dpival
        self.figure.set_size_inches(winch, hinch)
        self.figcanvas.resize_event()
        self.figcanvas.draw()

    def reset_box(self):
        self._box_size = 0, 0
        self._box_pos = 0, 0

    def draw_box(self, event, x0, y0, x1, y1):
        pos_x, pos_y = self.pos
        # Kivy coords
        x0 = pos_x + x0
        x1 = pos_x + x1
        y0 = pos_y + y0
        y1 = pos_y + y1
        self._box_pos = x0, y0
        self._box_size = x1 - x0, y1 - y0

class _FigureCanvas(FigureCanvasAgg):

    """Internal AGG Canvas"""

    def __init__(self, figure, widget, *args, **kwargs):
        self.widget = widget
        super(_FigureCanvas, self).__init__(figure, *args, **kwargs)

    def draw(self):
        """
        Render the figure using agg.
        """
        super(_FigureCanvas, self).draw()
        agg = self.get_renderer()
        w, h = agg.width, agg.height
        self._isDrawn = True

        self.widget.bt_w = w
        self.widget.bt_h = h
        self.widget._bitmap = agg.tostring_rgb()
        self.widget._draw_bitmap()

    def blit(self, bbox=None):
        # TODO bbox
        agg = self.get_renderer()
        w, h = agg.width, agg.height
        self.widget._bitmap = agg.tostring_rgb()
        self.widget.bt_w = w
        self.widget.bt_h = h
        self.widget._draw_bitmap()

    def print_figure(self, filename, *args, **kwargs):
        super(self.print_figure, self).print_figure(filename, *args, **kwargs)
        if self._isDrawn:
            self.draw()

class MatplotNavToolbar_0(BoxLayout):

    """Figure Toolbar"""
    info_lbl_0 = ObjectProperty(None)
    cursor_line_0 = ObjectProperty(None)
    _navtoolbar = None  # Internal NavToolbar logic
    figure_widget = ObjectProperty(None)

    def __init__(self, figure_widget=None, *args, **kwargs):
        super(MatplotNavToolbar_0, self).__init__(*args, **kwargs)
        self.figure_widget = figure_widget

    def on_figure_widget(self, obj, value):
        self.figure_widget.bind(figcanvas=self._canvas_ready)

    def _canvas_ready(self, obj, value):
        self._navtoolbar = _NavigationToolbar_0(value, self)
        self._navtoolbar.figure_widget = obj

class _NavigationToolbar_0(NavigationToolbar2):
    figure_widget = None

    def __init__(self, canvas, widget):
        self.widget = widget
        super(_NavigationToolbar_0, self).__init__(canvas)

    def _init_toolbar(self):
        pass

    def press_pan(self, event):
        """Callback for mouse button press in pan/zoom mode."""

        if (event.inaxes == None) or (event.inaxes.axes.title._text != 'partial freq'):
            pass
        else:
            if event.button == 1:
                self._button_pressed = 1
            elif event.button == 3:
                self._button_pressed = 3
            else:
                self._button_pressed = None
                return

            x, y = event.x, event.y
            self._xypress = []
            for i, a in enumerate(self.canvas.figure.get_axes()):
                if (x is not None and y is not None and a.in_axes(event) and
                        a.get_navigate() and a.can_pan()):
                    a.start_pan(x, y, event.button)
                    self._xypress.append((a, i))
                    self.canvas.mpl_disconnect(self._idDrag)
                    self._idDrag = self.canvas.mpl_connect('motion_notify_event', self.drag_pan)

            self.press(event)

    def press_zoom(self, event):
        """Callback for mouse button press in zoom to rect mode."""
        # If we're already in the middle of a zoom, pressing another
        # button works to "cancel"

        if (event.inaxes == None) or (event.inaxes.axes.title._text != 'partial freq'):
            pass
        else:

            if self._ids_zoom != []:
                for zoom_id in self._ids_zoom:
                    self.canvas.mpl_disconnect(zoom_id)
                self.release(event)
                self.draw()
                self._xypress = None
                self._button_pressed = None
                self._ids_zoom = []
                return

            if event.button == 1:
                self._button_pressed = 1
            elif event.button == 3:
                self._button_pressed = 3
            else:
                self._button_pressed = None
                return

            x, y = event.x, event.y
            self._xypress = []
            for i, a in enumerate(self.canvas.figure.get_axes()):
                if (x is not None and y is not None and a.in_axes(event) and
                        a.get_navigate() and a.can_zoom()):
                    self._xypress.append((x, y, a, i, a._get_view()))

            id1 = self.canvas.mpl_connect('motion_notify_event', self.drag_zoom)
            id2 = self.canvas.mpl_connect('key_press_event', self._switch_on_zoom_mode)
            id3 = self.canvas.mpl_connect('key_release_event', self._switch_off_zoom_mode)

            self._ids_zoom = id1, id2, id3
            self._zoom_mode = event.key

            self.press(event)

    def dynamic_update(self):
        self.canvas.draw()

    def draw_rubberband(self, event, x0, y0, x1, y1):
        self.figure_widget.draw_box(event, x0, y0, x1, y1)

    def mouse_move(self, event):
        self._set_cursor(event)

        if event.inaxes and event.inaxes.get_navigate():
            try:
                s = event.inaxes.format_coord(event.xdata, event.ydata)
            except (ValueError, OverflowError):
                pass
            else:
                artists = [a for a in event.inaxes.mouseover_set if
                            a.contains(event) and a.get_visible()]

                if artists:
                    a = max(artists, key=lambda x: x.zorder)
                    if a is not event.inaxes.patch:
                        data = a.get_cursor_data(event)
                        if data is not None:
                            s += ' [%s]' % a.format_cursor_data(data)

                if len(self.mode):
                    s = s + event.inaxes.xaxis.label._text + '\t' + event.inaxes.title._text
                    self.set_message('%s, %s' % (self.mode, s))
                else:
                    s = s + event.inaxes.xaxis.label._text + '\t' + event.inaxes.title._text
                    self.set_message(s)
        else:
            self.set_message(self.mode)

    def set_message(self, s):
        global sysActiveFlag, pauseStateFlag, getReportInterval
        global mouse_x_rec, choosed_Tab, dataBufferStored, rptCntStored
        global colorDictHex, color_0
        global curveName_global, curvePos_global

        try:
            if (sysActiveFlag == False or pauseStateFlag == True) and 'Graph0' in s and rptCntStored > 0 and choosed_Tab == 'Real-Time':

                string = s.split("x=")[1].split(" ")[0]
                idx = float(string)

                text = 'x = {}'.format(round(idx, 2))

                plotIdx = 0
                for curveIdx, value in enumerate(curveName_global):
                    if value in curvePos_global and 'G0' in curvePos_global[value]:      
                        y = round(intp_pt(math.floor(idx / getReportInterval), math.ceil(idx / getReportInterval), dataBufferStored[curveIdx][len(dataBufferStored[curveIdx]) - rptCntStored + math.floor(idx / getReportInterval)], dataBufferStored[curveIdx][len(dataBufferStored[curveIdx]) - rptCntStored + math.ceil(idx / getReportInterval)], idx / getReportInterval), 2)
                        text = text + '    ' + '[color=' + colorDictHex[color_0[plotIdx]] + ']{}[/color] = {},'.format(curveName_global[curveIdx], y)
                        plotIdx = plotIdx + 1
                    else:
                        pass                

                for item in self.widget.cursor_line_0.canvas.before.get_group('Rect'):
                    item.pos = mouse_x_rec, 567

                for item in self.widget.cursor_line_0.canvas.before.get_group('Color'):
                    item.rgba = (1, 1, 1, 1)

                self.widget.info_lbl_0.text = text
                self.widget.info_lbl_0.pos = 800, 742
            else:
                for item in self.widget.cursor_line_0.canvas.before.get_group('Color'):
                    item.rgba = (1, 1, 1, 0)

                    self.widget.info_lbl_0.text = ''
        except:
            pass

class MatplotNavToolbar_1(BoxLayout):

    """Figure Toolbar"""
    info_lbl_1 = ObjectProperty(None)
    cursor_line_1 = ObjectProperty(None)
    _navtoolbar = None  # Internal NavToolbar logic
    figure_widget = ObjectProperty(None)

    def __init__(self, figure_widget=None, *args, **kwargs):
        super(MatplotNavToolbar_1, self).__init__(*args, **kwargs)
        self.figure_widget = figure_widget

    def on_figure_widget(self, obj, value):
        self.figure_widget.bind(figcanvas=self._canvas_ready)

    def _canvas_ready(self, obj, value):
        self._navtoolbar = _NavigationToolbar_1(value, self)
        self._navtoolbar.figure_widget = obj

class _NavigationToolbar_1(NavigationToolbar2):
    figure_widget = None

    def __init__(self, canvas, widget):
        self.widget = widget
        super(_NavigationToolbar_1, self).__init__(canvas)

    def _init_toolbar(self):
        pass

    def press_pan(self, event):
        """Callback for mouse button press in pan/zoom mode."""

        if (event.inaxes == None) or (event.inaxes.axes.title._text != 'partial freq'):
            pass
        else:
            if event.button == 1:
                self._button_pressed = 1
            elif event.button == 3:
                self._button_pressed = 3
            else:
                self._button_pressed = None
                return

            x, y = event.x, event.y
            self._xypress = []
            for i, a in enumerate(self.canvas.figure.get_axes()):
                if (x is not None and y is not None and a.in_axes(event) and
                        a.get_navigate() and a.can_pan()):
                    a.start_pan(x, y, event.button)
                    self._xypress.append((a, i))
                    self.canvas.mpl_disconnect(self._idDrag)
                    self._idDrag = self.canvas.mpl_connect('motion_notify_event', self.drag_pan)

            self.press(event)

    def press_zoom(self, event):
        """Callback for mouse button press in zoom to rect mode."""
        # If we're already in the middle of a zoom, pressing another
        # button works to "cancel"

        if (event.inaxes == None) or (event.inaxes.axes.title._text != 'partial freq'):
            pass
        else:

            if self._ids_zoom != []:
                for zoom_id in self._ids_zoom:
                    self.canvas.mpl_disconnect(zoom_id)
                self.release(event)
                self.draw()
                self._xypress = None
                self._button_pressed = None
                self._ids_zoom = []
                return

            if event.button == 1:
                self._button_pressed = 1
            elif event.button == 3:
                self._button_pressed = 3
            else:
                self._button_pressed = None
                return

            x, y = event.x, event.y
            self._xypress = []
            for i, a in enumerate(self.canvas.figure.get_axes()):
                if (x is not None and y is not None and a.in_axes(event) and
                        a.get_navigate() and a.can_zoom()):
                    self._xypress.append((x, y, a, i, a._get_view()))

            id1 = self.canvas.mpl_connect('motion_notify_event', self.drag_zoom)
            id2 = self.canvas.mpl_connect('key_press_event', self._switch_on_zoom_mode)
            id3 = self.canvas.mpl_connect('key_release_event', self._switch_off_zoom_mode)

            self._ids_zoom = id1, id2, id3
            self._zoom_mode = event.key

            self.press(event)

    def dynamic_update(self):
        self.canvas.draw()

    def draw_rubberband(self, event, x0, y0, x1, y1):
        self.figure_widget.draw_box(event, x0, y0, x1, y1)

    def mouse_move(self, event):
        self._set_cursor(event)

        if event.inaxes and event.inaxes.get_navigate():
            try:
                s = event.inaxes.format_coord(event.xdata, event.ydata)
            except (ValueError, OverflowError):
                pass
            else:
                artists = [a for a in event.inaxes.mouseover_set if
                            a.contains(event) and a.get_visible()]

                if artists:
                    a = max(artists, key=lambda x: x.zorder)
                    if a is not event.inaxes.patch:
                        data = a.get_cursor_data(event)
                        if data is not None:
                            s += ' [%s]' % a.format_cursor_data(data)

                if len(self.mode):
                    s = s + event.inaxes.xaxis.label._text + '\t' + event.inaxes.title._text
                    self.set_message('%s, %s' % (self.mode, s))
                else:
                    s = s + event.inaxes.xaxis.label._text + '\t' + event.inaxes.title._text
                    self.set_message(s)
        else:
            self.set_message(self.mode)

    def set_message(self, s):
        global sysActiveFlag, pauseStateFlag, getReportInterval
        global mouse_x_rec, choosed_Tab, dataBufferStored, rptCntStored
        global colorDictHex, color_1
        global curveName_global, curvePos_global
        
        try:
            if (sysActiveFlag == False or pauseStateFlag == True) and 'Graph1' in s and rptCntStored > 0 and choosed_Tab == 'Real-Time':

                string = s.split("x=")[1].split(" ")[0]
                idx = float(string)

                text = 'x = {}'.format(round(idx, 2))

                plotIdx = 0
                for curveIdx, value in enumerate(curveName_global):
                    if curveName_global[curveIdx] in curvePos_global and 'G1' in curvePos_global[value]:
                            y = round(intp_pt(math.floor(idx / getReportInterval), math.ceil(idx / getReportInterval), dataBufferStored[curveIdx][len(dataBufferStored[curveIdx]) - rptCntStored + math.floor(idx / getReportInterval)], dataBufferStored[curveIdx][len(dataBufferStored[curveIdx]) - rptCntStored + math.ceil(idx / getReportInterval)], idx / getReportInterval), 2)
                            text = text + '    ' + '[color=' + colorDictHex[color_1[plotIdx]] + ']{}[/color] = {},'.format(curveName_global[curveIdx], y)
                            plotIdx = plotIdx + 1
                    else:
                        pass

                for item in self.widget.cursor_line_1.canvas.before.get_group('Rect'):
                    item.pos = mouse_x_rec, 59

                for item in self.widget.cursor_line_1.canvas.before.get_group('Color'):
                    item.rgba = (1, 1, 1, 1)

                self.widget.info_lbl_1.text = text
                self.widget.info_lbl_1.pos = 800, 234
            else:
                for item in self.widget.cursor_line_1.canvas.before.get_group('Color'):
                    item.rgba = (1, 1, 1, 0)
                
                self.widget.info_lbl_1.text = ''
        except:
            pass

class MatplotNavToolbar_reload_0(BoxLayout):

    """Figure Toolbar"""
    info_lbl_0 = ObjectProperty(None)
    cursor_line_0 = ObjectProperty(None)
    move_btn_reload_0 = ObjectProperty(None)
    zoom_in_btn_reload_0 = ObjectProperty(None)
    _navtoolbar = None  # Internal NavToolbar logic
    figure_widget = ObjectProperty(None)

    def __init__(self, figure_widget=None, *args, **kwargs):
        super(MatplotNavToolbar_reload_0, self).__init__(*args, **kwargs)
        self.figure_widget = figure_widget

    def on_figure_widget(self, obj, value):
        self.figure_widget.bind(figcanvas=self._canvas_ready)

    def _canvas_ready(self, obj, value):
        self._navtoolbar = _NavigationToolbar_reload_0(value, self)
        self._navtoolbar.figure_widget = obj

class _NavigationToolbar_reload_0(NavigationToolbar2):
    figure_widget = None

    def __init__(self, canvas, widget):
        self.widget = widget
        super(_NavigationToolbar_reload_0, self).__init__(canvas)

    def _init_toolbar(self):
        self.widget.move_btn_reload_0.bind(on_press=self.pan)
        self.widget.zoom_in_btn_reload_0.bind(on_press=self.zoom)

    def press_pan(self, event):
        """Callback for mouse button press in pan/zoom mode."""

        if event.button == 1:
            self._button_pressed = 1
        elif event.button == 3:
            self._button_pressed = 3
        else:
            self._button_pressed = None
            return

        x, y = event.x, event.y
        self._xypress = []
        for i, a in enumerate(self.canvas.figure.get_axes()):
            if (x is not None and y is not None and a.in_axes(event) and
                    a.get_navigate() and a.can_pan()):
                a.start_pan(x, y, event.button)
                self._xypress.append((a, i))
                self.canvas.mpl_disconnect(self._idDrag)
                self._idDrag = self.canvas.mpl_connect('motion_notify_event', self.drag_pan)

        self.press(event)

    def press_zoom(self, event):
        """Callback for mouse button press in zoom to rect mode."""
        # If we're already in the middle of a zoom, pressing another
        # button works to "cancel"

        if self._ids_zoom != []:
            for zoom_id in self._ids_zoom:
                self.canvas.mpl_disconnect(zoom_id)
            self.release(event)
            self.draw()
            self._xypress = None
            self._button_pressed = None
            self._ids_zoom = []
            return

        if event.button == 1:
            self._button_pressed = 1
        elif event.button == 3:
            self._button_pressed = 3
        else:
            self._button_pressed = None
            return

        x, y = event.x, event.y
        self._xypress = []
        for i, a in enumerate(self.canvas.figure.get_axes()):
            if (x is not None and y is not None and a.in_axes(event) and
                    a.get_navigate() and a.can_zoom()):
                self._xypress.append((x, y, a, i, a._get_view()))

        id1 = self.canvas.mpl_connect('motion_notify_event', self.drag_zoom)
        id2 = self.canvas.mpl_connect('key_press_event', self._switch_on_zoom_mode)
        id3 = self.canvas.mpl_connect('key_release_event', self._switch_off_zoom_mode)

        self._ids_zoom = id1, id2, id3
        self._zoom_mode = event.key

        self.press(event)

    def dynamic_update(self):
        self.canvas.draw()

    def draw_rubberband(self, event, x0, y0, x1, y1):
        self.figure_widget.draw_box(event, x0, y0, x1, y1)

    def mouse_move(self, event):
        self._set_cursor(event)

        if event.inaxes and event.inaxes.get_navigate():
            try:
                s = event.inaxes.format_coord(event.xdata, event.ydata)
            except (ValueError, OverflowError):
                pass
            else:
                artists = [a for a in event.inaxes.mouseover_set if
                            a.contains(event) and a.get_visible()]

                if artists:
                    a = max(artists, key=lambda x: x.zorder)
                    if a is not event.inaxes.patch:
                        data = a.get_cursor_data(event)
                        if data is not None:
                            s += ' [%s]' % a.format_cursor_data(data)

                if len(self.mode):
                    s = s + event.inaxes.xaxis.label._text + '\t' + event.inaxes.title._text
                    self.set_message('%s, %s' % (self.mode, s))
                else:
                    s = s + event.inaxes.xaxis.label._text + '\t' + event.inaxes.title._text
                    self.set_message(s)
        else:
            self.set_message(self.mode)

    def set_message(self, s):
        global choosed_Tab
        global reload_axis, reload_data, reload_timeInterval
        global colorDictHex, color, color_0

        if choosed_Tab == 'Reload' and len(s) != 0 and reload_axis!= None and 'Graph0' in s:

            string = s.split("x=")[1].split(" ")[0]
            idx = float(string)

            text = 'x = {}'.format(round(idx, 2))

            plotIdx = 0
            for curveIdx, value in enumerate(reload_axis):
                if 'G0' in value:                   
                    y = round(intp_pt(math.floor(idx / reload_timeInterval), math.ceil(idx / reload_timeInterval), reload_data[curveIdx][math.floor(idx / reload_timeInterval)], reload_data[curveIdx][math.ceil(idx / reload_timeInterval)], idx / reload_timeInterval), 2)
                    text = text + '    ' + '[color=' + colorDictHex[color_0[plotIdx]] + ']{}[/color] = {},'.format(curveName_global[curveIdx], y)
                    plotIdx = plotIdx + 1
                else:
                    pass                    

            for item in self.widget.cursor_line_0.canvas.before.get_group('Rect'):
                item.pos = mouse_x_rec, 587

            for item in self.widget.cursor_line_0.canvas.before.get_group('Color'):
                item.rgba = (1, 1, 1, 1)

            self.widget.info_lbl_0.text = text
            self.widget.info_lbl_0.pos = 800, 762
        else:
            for item in self.widget.cursor_line_0.canvas.before.get_group('Color'):
                item.rgba = (1, 1, 1, 0)

                self.widget.info_lbl_0.text = ''

class MatplotNavToolbar_reload_1(BoxLayout):

    """Figure Toolbar"""
    info_lbl_1 = ObjectProperty(None)
    cursor_line_1 = ObjectProperty(None)
    move_btn_reload_1 = ObjectProperty(None)
    zoom_in_btn_reload_1 = ObjectProperty(None)
    _navtoolbar = None  # Internal NavToolbar logic
    figure_widget = ObjectProperty(None)

    def __init__(self, figure_widget=None, *args, **kwargs):
        super(MatplotNavToolbar_reload_1, self).__init__(*args, **kwargs)
        self.figure_widget = figure_widget

    def on_figure_widget(self, obj, value):
        self.figure_widget.bind(figcanvas=self._canvas_ready)

    def _canvas_ready(self, obj, value):
        self._navtoolbar = _NavigationToolbar_reload_1(value, self)
        self._navtoolbar.figure_widget = obj

class _NavigationToolbar_reload_1(NavigationToolbar2):
    figure_widget = None

    def __init__(self, canvas, widget):
        self.widget = widget
        super(_NavigationToolbar_reload_1, self).__init__(canvas)

    def _init_toolbar(self):
        self.widget.move_btn_reload_1.bind(on_press=self.pan)
        self.widget.zoom_in_btn_reload_1.bind(on_press=self.zoom)

    def press_pan(self, event):
        """Callback for mouse button press in pan/zoom mode."""

        if event.button == 1:
            self._button_pressed = 1
        elif event.button == 3:
            self._button_pressed = 3
        else:
            self._button_pressed = None
            return

        x, y = event.x, event.y
        self._xypress = []
        for i, a in enumerate(self.canvas.figure.get_axes()):
            if (x is not None and y is not None and a.in_axes(event) and
                    a.get_navigate() and a.can_pan()):
                a.start_pan(x, y, event.button)
                self._xypress.append((a, i))
                self.canvas.mpl_disconnect(self._idDrag)
                self._idDrag = self.canvas.mpl_connect('motion_notify_event', self.drag_pan)

        self.press(event)

    def press_zoom(self, event):
        """Callback for mouse button press in zoom to rect mode."""
        # If we're already in the middle of a zoom, pressing another
        # button works to "cancel"

        if self._ids_zoom != []:
            for zoom_id in self._ids_zoom:
                self.canvas.mpl_disconnect(zoom_id)
            self.release(event)
            self.draw()
            self._xypress = None
            self._button_pressed = None
            self._ids_zoom = []
            return

        if event.button == 1:
            self._button_pressed = 1
        elif event.button == 3:
            self._button_pressed = 3
        else:
            self._button_pressed = None
            return

        x, y = event.x, event.y
        self._xypress = []
        for i, a in enumerate(self.canvas.figure.get_axes()):
            if (x is not None and y is not None and a.in_axes(event) and
                    a.get_navigate() and a.can_zoom()):
                self._xypress.append((x, y, a, i, a._get_view()))

        id1 = self.canvas.mpl_connect('motion_notify_event', self.drag_zoom)
        id2 = self.canvas.mpl_connect('key_press_event', self._switch_on_zoom_mode)
        id3 = self.canvas.mpl_connect('key_release_event', self._switch_off_zoom_mode)

        self._ids_zoom = id1, id2, id3
        self._zoom_mode = event.key

        self.press(event)

    def dynamic_update(self):
        self.canvas.draw()

    def draw_rubberband(self, event, x0, y0, x1, y1):
        self.figure_widget.draw_box(event, x0, y0, x1, y1)

    def mouse_move(self, event):
        self._set_cursor(event)

        if event.inaxes and event.inaxes.get_navigate():
            try:
                s = event.inaxes.format_coord(event.xdata, event.ydata)
            except (ValueError, OverflowError):
                pass
            else:
                artists = [a for a in event.inaxes.mouseover_set if
                            a.contains(event) and a.get_visible()]

                if artists:
                    a = max(artists, key=lambda x: x.zorder)
                    if a is not event.inaxes.patch:
                        data = a.get_cursor_data(event)
                        if data is not None:
                            s += ' [%s]' % a.format_cursor_data(data)

                if len(self.mode):
                    s = s + event.inaxes.xaxis.label._text + '\t' + event.inaxes.title._text
                    self.set_message('%s, %s' % (self.mode, s))
                else:
                    s = s + event.inaxes.xaxis.label._text + '\t' + event.inaxes.title._text
                    self.set_message(s)
        else:
            self.set_message(self.mode)

    def set_message(self, s):
        global choosed_Tab
        global reload_axis, reload_data, reload_timeInterval
        global colorDictHex, color

        if choosed_Tab == 'Reload' and len(s) != 0  and reload_axis!= None and 'Graph1' in s:

            string = s.split("x=")[1].split(" ")[0]
            idx = float(string)

            text = 'x = {}'.format(round(idx, 2))

            plotIdx = 0
            for curveIdx, value in enumerate(reload_axis):
                if 'G1' in value:
                    y = round(intp_pt(math.floor(idx / reload_timeInterval), math.ceil(idx / reload_timeInterval), reload_data[curveIdx][math.floor(idx / reload_timeInterval)], reload_data[curveIdx][math.ceil(idx / reload_timeInterval)], idx / reload_timeInterval), 2)
                    text = text + '    ' + '[color=' + colorDictHex[color_1[plotIdx]] + ']{}[/color] = {},'.format(curveName_global[curveIdx], y)
                    plotIdx = plotIdx + 1
                else:
                    pass    

            for item in self.widget.cursor_line_1.canvas.before.get_group('Rect'):
                item.pos = mouse_x_rec, 60

            for item in self.widget.cursor_line_1.canvas.before.get_group('Color'):
                item.rgba = (1, 1, 1, 1)

            self.widget.info_lbl_1.text = text
            self.widget.info_lbl_1.pos = 800, 235
        else:
            for item in self.widget.cursor_line_1.canvas.before.get_group('Color'):
                item.rgba = (1, 1, 1, 0)
            
            self.widget.info_lbl_1.text = ''

class Main(BoxLayout):

    def __init__(self, **kwargs):
        # make sure we aren't overriding any important functionality
        super(Main, self).__init__(**kwargs)
        global curveName_global, curvePos_global
        global choosed_Tab

        self.curve_param = curve_param()
        self.font_size= font_size()
        self.refri_table = refri_table()
        
        self.raw_data_param = raw_data_param()
        self.control_board_param = control_board_param()
        self.script_param = script_param()
        self.setting_id = setting_id()

        self.UART_board = UART_board_port_setting()
        self.sever_PC = sever_PC_setting()
        self.UI_system = UI_system_config()
        self.instrument_config = instrument_config()
        self.figure_config = figure_config()
        self.log_content = log_content()

        choosed_Tab = '設定'

        curveName_global = self.curve_param.curveName
        curvePos_global = self.curve_param.curvePos

        if self.UI_system.instrMode == True or self.UI_system.eerLabMode == True:
            self.instrument_config.rm = visa.ResourceManager()
            if self.UI_system.eerLabMode == True:                
                self.open_dev_conn()
            else:
                pass

        self.load_default_setting()

        mouse_move_thread = threading.Thread(target=self.mouse_move, daemon= True)
        mouse_move_thread.start()

    def bootup(self):

        if self.UI_system.bootUpFlag == True:
            self.UI_system.bootUpFlag = False

            self.ids['Input_FanSpeed'].text = self.control_board_param.FanSpeed_init

            for figIdx in range(2):
                plt.close('all')
                self.ids['fig_'+str(figIdx)].clear_widgets()

                fig = plt.figure()

                matplotlib.rc('axes', edgecolor=(1, 1, 1))            

                ax1 = plt.subplot()
                ax2 = ax1.twinx()
                ax1.set_title('Graph' + str(figIdx))
                ax1.set_xlabel('Second', color=(1, 1, 1))

                self.graphSetting(ax1, ax2, fig, 'Init', True, True)
                plt.tight_layout(pad=1.5, h_pad=0, w_pad=0, rect=(-0.03, -0.04, 1.03, 1.02))

                figure_wgt_whole = self.ids['fig_'+str(figIdx)]  # MatplotFigure
                figure_wgt_whole.figure = fig

            for figIdx in range(2):
                plt.close('all')
                self.ids['fig_'+str(figIdx)].clear_widgets()

                fig = plt.figure()

                matplotlib.rc('axes', edgecolor=(1, 1, 1))            

                ax1 = plt.subplot()
                ax2 = ax1.twinx()
                ax1.set_title('Graph' + str(figIdx))
                ax1.set_xlabel('Second', color=(1, 1, 1))

                self.graphSetting(ax1, ax2, fig, 'Init', True, True)
                plt.tight_layout(pad=1.5, h_pad=0, w_pad=0, rect=(-0.03, -0.04, 1.03, 1.02))

                figure_wgt_whole = self.ids['reload_fig_'+str(figIdx)]  # MatplotFigure
                figure_wgt_whole.figure = fig

                self.monitor_mode_enable_change()
        else:
            pass

    def mouse_move(self):
        
        os.system('script.exe')

    ################## CRC checking with target ############################3
    def int_to_bytes(self, i):
        return [(i >> 24) & 0xFF, (i >> 16) & 0xFF, (i >> 8) & 0xFF, i & 0xFF]

    def generate_crc32_table(self, _poly):

        for i in range(256):
            c = i << 24

            for j in range(8):
                c = (c << 1) ^ _poly if (c & 0x80000000) else c << 1

            self.UART_board.custom_crc_table[i] = c & 0xffffffff

    def custom_crc32(self, buf):
        crc = 0xffffffff

        for integer in buf:
            b = self.int_to_bytes(integer)

            for byte in b:
                crc = ((crc << 8) & 0xffffffff) ^ self.UART_board.custom_crc_table[(crc >> 24) ^ byte]
                    
        return crc
    #########################################################################

########################## popup interative dialog ##########################

    def popUp_interactive(self, text):

        content = PopUpDialog(text= text, cancel=self.dismiss_popup)
        self._popup = Popup(title='', content=content,
                    auto_dismiss=True, size_hint=(0.2, 0.2))
        self._popup.open()

#############################################################################

###########################  remote mode ########################################
    def remote_mode_create_socket(self, cmd):

        if self.sever_PC.mySocket == None:
            # create socket
            print('# Creating socket')
            try:
                self.sever_PC.mySocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                self.sever_PC.mySocket.settimeout(self.sever_PC.timeout)

                # Connect to remote server
                print('# Connecting to server...')

                self.sever_PC.mySocket.connect((self.sever_PC.SERVER_IP , self.sever_PC.PORT_NUMBER))
                print('# Sever Connected')                

                if cmd == None:
                    pass
                else:
                    self.sever_PC.mySocket.send(cmd.encode('utf-8'))
                
            except socket.error:
                print('Failed to create socket')
                self.popUp_interactive('Please Restart/Open the Remote Sever')
                self.sever_PC.mySocket = None
        else:
            if cmd == None:
                pass
            else:
                self.sever_PC.mySocket.send(cmd.encode('utf-8'))

    def recv_data_from_sever(self):
        try:
            data = self.sever_PC.mySocket.recv(self.sever_PC.SIZE)
            resp = data.decode("utf-8")             
        except socket.timeout:
            print('CMD to Sever TIMEOUT')
            resp = 'SEVER TIMEOUT' 
            self.sever_PC.mySocket = None

        return resp

##################################################################

    def command_content_handle(self, command):
        # return

        if command == 'Connect':
            return 0x0, 0, 0, 0, 0, 0
        elif command == 'Start':
            if self.ids['cool_warm_mode'].text == 'Warm':
                if self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Normal_Mode':
                    return 0x27A, int(self.ids['Input_compRPM'].text) * 3, int(self.ids['Input_EEVDeg'].text), int(int(self.ids['Input_FanSpeed'].text) / 15), 1000, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_Only_Mode':
                    return 0x20A, int(self.ids['Input_compRPM'].text) * 3, 0, 0, 0, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'EEV_Only_Mode':
                    return 0x212, 0, int(self.ids['Input_EEVDeg'].text), 0, 0, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Fan_Only_Mode':
                    return 0x222, 0, 0, int(int(self.ids['Input_FanSpeed'].text) / 15), 0, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_EEV_Mode':
                    return 0x21A, int(self.ids['Input_compRPM'].text) * 3, int(self.ids['Input_EEVDeg'].text), 0, 0, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_Fan_Mode':
                    return 0x22A, int(self.ids['Input_compRPM'].text) * 3, 0, int(int(self.ids['Input_FanSpeed'].text) / 15), 0, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'EEV_Fan_Mode':
                    return 0x232, 0, int(self.ids['Input_EEVDeg'].text), int(int(self.ids['Input_FanSpeed'].text) / 15), 0, 0
                else:
                    assert False
            elif self.ids['cool_warm_mode'].text == 'Cool':
                if self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Normal_Mode':
                    return 0x7A, int(self.ids['Input_compRPM'].text) * 3, int(self.ids['Input_EEVDeg'].text), int(int(self.ids['Input_FanSpeed'].text) / 15), 1000, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_Only_Mode':
                    return 0xA, int(self.ids['Input_compRPM'].text) * 3, 0, 0, 0, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'EEV_Only_Mode':
                    return 0x12, 0, int(self.ids['Input_EEVDeg'].text), 0, 0, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Fan_Only_Mode':
                    return 0x22, 0, 0, int(int(self.ids['Input_FanSpeed'].text) / 15), 0, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_EEV_Mode':
                    return 0x1A, int(self.ids['Input_compRPM'].text) * 3, int(self.ids['Input_EEVDeg'].text), 0, 0, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_Fan_Mode':
                    return 0x2A, int(self.ids['Input_compRPM'].text) * 3, 0, int(int(self.ids['Input_FanSpeed'].text) / 15), 0, 0
                elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'EEV_Fan_Mode':
                    return 0x32, 0, int(self.ids['Input_EEVDeg'].text), int(int(self.ids['Input_FanSpeed'].text) / 15), 0, 0
                else:
                    assert False  
            else:
                assert False
        elif command == 'Stop':
            return 0x3, 0, 0, 0, 0, 0
        elif command == 'Set':
            if self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Normal_Mode':
                return 0x47C, int(self.ids['Input_compRPM'].text) * 3, int(self.ids['Input_EEVDeg'].text), int(int(self.ids['Input_FanSpeed'].text) / 15), 1000, 0
            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_Only_Mode':
                return 0x40C, int(self.ids['Input_compRPM'].text) * 3, 0, 0, 0, 0
            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'EEV_Only_Mode':
                return 0x414, 0, int(self.ids['Input_EEVDeg'].text), 0, 0, 0
            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Fan_Only_Mode':
                return 0x424, 0, 0, int(int(self.ids['Input_FanSpeed'].text) / 15), 0, 0
            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_EEV_Mode':
                return 0x41C, int(self.ids['Input_compRPM'].text) * 3, int(self.ids['Input_EEVDeg'].text), 0, 0, 0
            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_Fan_Mode':
                return 0x42C, int(self.ids['Input_compRPM'].text) * 3, 0, int(int(self.ids['Input_FanSpeed'].text) / 15), 0, 0
            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'EEV_Fan_Mode':
                return 0x434, 0, int(self.ids['Input_EEVDeg'].text), int(int(self.ids['Input_FanSpeed'].text) / 15), 0, 0
            else:
                assert False    
        elif command == 'Get':
            return 0x5FD, 0, 0, 0, 0, 0
        else:
            print(command)
            assert False

    def SendGet(self, command, times):

        if times >= 5:
            return 'CMD collision'

        print('*************************{}*************************'.format(command))
        
        
        CMD, CompRPM, EEVDeg, FanSpeed, CurrentScale, Angle = self.command_content_handle(command)

        try:
            if self.UI_system.boardMode == True:
                if self.UI_system.remoteMode == True:

                    command_send = 'Board' + ' ' + \
                                   str(CMD) + ' ' + \
                                   str(CompRPM) + ' ' + \
                                   str(EEVDeg) + ' ' + \
                                   str(FanSpeed) + ' ' + \
                                   str(CurrentScale)

                    self.remote_mode_create_socket(None)

                    if self.sever_PC.mySocket == None:
                        return 'Please Restart/Open the Remote Sever'

                    try:
                        self.sever_PC.mySocket.send(command_send.encode('utf-8'))  
                    except ConnectionResetError:
                        self.sever_PC.mySocket.close()
                        self.remote_mode_create_socket(command_send)                            

                    readshort = self.recv_data_from_sever()

                    if readshort in self.UART_board.error_response:
                        pass
                    else:
                        readshort = readshort.split()
                else:
                    if command == 'Connect' and self.UART_board.detected_port == None:
                        ports = list(serial.tools.list_ports.comports())

                        if len(ports) == 0:
                            self.popUp_interactive("UI Com port detection is Failed")
                            return 'Failed'                        
                        else:                                  

                            content = PopUpDialogNoCancel(text= "Detecting UI Com port. Please wait...")
                            self._popup = Popup(title='', content=content,
                                        auto_dismiss=False, size_hint=(0.2, 0.2))
                            self._popup.open()

                            for port in ports:
                                
                                self.UART_board.detected_port = port[0].split('M')[1]
                                resp = self.SendGet('Connect', 0)

                                if resp in self.UART_board.error_response:
                                    self.UART_board.detected_port = None
                                else:                       
                                    self._popup.dismiss()
                                    return resp
                                
                                if port == ports[-1]:

                                    self._popup.dismiss()
                                    self.popUp_interactive("UI Com port detection is Failed")

                                    return 'Failed'

                    else:                          
                        ser = serial.Serial(
                                            port= 'com' + self.UART_board.detected_port,
                                            baudrate=self.UART_board.BAUDRATE,
                                            parity=serial.PARITY_NONE,
                                            stopbits=serial.STOPBITS_ONE,
                                            bytesize=serial.EIGHTBITS,
                                            timeout=self.UART_board.timeout
                                            )
                        header = 0x5566
                        #  generate CRC
                        self.generate_crc32_table(self.UART_board.CRC_POLY)
                        buf = [header, CMD, CompRPM, EEVDeg, FanSpeed, CurrentScale]            
                        crc = self.custom_crc32(buf)&0xFFFF #take only 16bit

                        print('Command Send to Target: ', header,CMD, CompRPM, EEVDeg, FanSpeed, CurrentScale, crc)
                        # sendbin = struct.pack('<HHHHHHhH', header, CMD, CompRPM, EEVDeg, FanSpeed, CurrentScale, Angle, crc)
                        sendbin = struct.pack('<HHHHHHH', header, CMD, CompRPM, EEVDeg, FanSpeed, CurrentScale, crc)   
                        
                        ser.write(sendbin)

                        start = default_timer()
                        if ser.readable:
                            readbin = ser.read(self.UART_board.recv_package_num * 2) 
                        print('response time : {}'.format(default_timer() - start))

                        if default_timer() - start >= self.UART_board.timeout - 0.01:
                            readshort = 'TARGET TIMEOUT'
                        elif len(readbin) < self.UART_board.recv_package_num * 2:
                            readshort = 'Failed'
                        else:
                            
                            readshort = struct.unpack('<HHHHhHHH', readbin)
                            print('Response received from Target: ',readshort)

                            #  check crc
                            self.generate_crc32_table(self.UART_board.CRC_POLY)
                            buf = list(readshort[0:self.UART_board.recv_package_num - 1])
                            crc = self.custom_crc32(buf)&0xFFFF #take only 16bit

                            if crc!=readshort[self.UART_board.recv_package_num - 1]:
                                readshort = 'CRC Failed'
                            else:
                                readshort = (str(readshort[0]) + ' ' + str(readshort[1]) + ' ' + str(readshort[2]) + ' ' + str(readshort[3])  + ' ' + str(readshort[4]) + ' ' + str(readshort[5]) + ' ' + str(readshort[6])).split()

                        ser.close()

            else: # self.UI_system.boardMode == False
                if self.UI_system.remoteMode == True:
                    pass
                else: # self.UI_system.remoteMode == False
                    readshort = 'fake response'
            
        except serial.serialutil.SerialException as e:
            if 'FileNotFoundError' in str(e):
                print('Error: COM port not found')
                readshort = 'COM port not found'
            elif 'PermissionError' in str(e):
                print('Error: CMD collision')
                time.sleep(.5)
                times = times + 1
                readshort = self.SendGet(command, times)
            else:
                print('Serial Error: ', e)
                readshort = 'Failed'
        except OSError as e:
            if '[WinError 10038] 嘗試操作的對象不是通訊端。' in str(e):
                readshort = 'Please Restart/Open the Remote Sever'
                self.sever_PC.mySocket = None
                self.popUp_interactive('Please Restart/Open the Remote Sever')
            else:
                print('OSError: ', e)
                readshort = 'Failed'
        except Exception as e:
            print(e)
            readshort = 'Failed'

        print('========================={}========================='.format(command))
        return readshort           

####################  board log ##########################################

    def debug_port_thread(self):
        if self.ids['UI_com_port'].text == self.ids['debug_com_port'].text:
            pass
        elif self.UART_board.threadStartFlag == True:
            pass
        else:
            self.UART_board.threadStartFlag = True
            debug_thread = threading.Thread(target=self.getDebugMsg, daemon= True)
            debug_thread.start()

    def getDebugMsg(self):
        while True:
            try:
                ser = serial.Serial(
                        port='com' + self.ids['debug_com_port'].text,
                        baudrate=self.UART_board.BAUDRATE,
                        parity=serial.PARITY_NONE,
                        stopbits=serial.STOPBITS_ONE,
                        bytesize=serial.EIGHTBITS)

                ser.isOpen()

                line = ''

                while True:

                    data = ser.read(1).decode('utf-8')
                    if data:
                        
                        if data == '\r':
                            self.Debug_Log_Control(line + '\n')
                            line = ''
                        elif data == '\n':
                            pass
                        else:
                            line = line + data
            except serial.serialutil.SerialException as e:
                if 'FileNotFoundError' in str(e):
                    self.Debug_Log_Control('COM PORT not found\n')
                    time.sleep(1)
                    
                elif 'PermissionError' in str(e):
                    self.Debug_Log_Control('COM PORT PermissionError\n')
                    break
                else:              
                    print(e)
                    break

    def Debug_Log_Control(self, log):

        # print log out
        self.log_content.debug_log = self.log_content.debug_log + log
        log_list = self.log_content.debug_log.split('\n')
        if len(log_list) > 50:
            log_list = log_list[len(log_list) - 50:]
        else:
            pass
        
        debug_log_content = ''
        for item in log_list:
            debug_log_content = debug_log_content + item + '\n'

        self.ids['lbl_debug_log'].text = debug_log_content
        self.ids['scroll_debug_log'].scroll_y = 0
        self.ids['scroll_debug_log'].update_from_scroll()   

        # save log
        if self.UI_system.sysActiveTime == None:
            pass
        else:
            currentDir = os.path.dirname(os.path.realpath('__file__'))
            rptPath = os.path.join(currentDir, 'Logs\\')

            if not os.path.exists(rptPath):
                os.makedirs(rptPath)

            fp = open(rptPath + 'Board_Log_' + self.UI_system.sysActiveTime + '.txt','a')
            
            fp.write(log)
            fp.close()

#############################################################################

################ GUI Log ###############################################

    def UI_Log_Control(self, log):

        # print log out
        self.log_content.UI_log = self.log_content.UI_log + log
        log_list = self.log_content.UI_log.split('\n')[:-1]
        if len(log_list) > 50:
            log_list = log_list[len(log_list) - 50:]
        else:
            pass
        
        log_content = ''
        for item in log_list:
            log_content = log_content + item + '\n'

        self.ids['lbl_log'].text = log_content
        self.ids['scroll_log'].scroll_y = 0
        self.ids['scroll_log'].update_from_scroll()   

        # save log
        if self.UI_system.sysActiveTime == None:
            pass
        else:
            currentDir = os.path.dirname(os.path.realpath('__file__'))
            rptPath = os.path.join(currentDir, 'Logs\\')

            if not os.path.exists(rptPath):
                os.makedirs(rptPath)

            fp = open(rptPath + 'UI_Log_' + self.UI_system.sysActiveTime + '.txt','a')
            
            fp.write(log)
            fp.close()
#################################################################

########### Script ##############################################

    def scriptSaveData(self):
        global curveNum

        currentDir = os.path.dirname(os.path.realpath('__file__'))
        rptPath = os.path.join(currentDir, 'Reports\\')

        fp = open(rptPath + 'Script_Report_' + self.script_param.script_start_time + '.txt','a')
        
        fp.write(self.ids['Input_compRPM'].text + '\t')
        fp.write(self.ids['Input_EEVDeg'].text + '\t')
        fp.write(self.ids['Input_FanSpeed'].text + '\t')

        for curveIdx in range(curveNum):
            fp.write(self.ids['lbl_rpt_'+str(curveIdx)].text + '\t')

        for key, val in self.script_param.self_define_var.items():
            fp.write(str(val) + '\t')

        fp.write('\n')
        fp.close()

    def scriptStop(self):

        self.UI_system.scriptStop_flag = True
        self.UI_system.scriptMode_Flag = False

        self.ids['lbl_script'].text = '[color=808080]' + self.log_content.script_content_raw.replace('\t', '    ') + '[/color]'

    def scriptStart(self):
        global sysActiveFlag

        if sysActiveFlag == True:
            pass
        else:

            # resp = self.SendGet('Connect', 0)

            # if resp in self.UART_board.error_response:
            #     pass
            # else:
            now = datetime.datetime.now()
            self.script_param.script_start_time = str(now.year) + '_' + str(now.month) + '_' + str(now.day) + '_' + str(now.hour) + '_' + str(now.minute) + '_' + str(now.second)

            currentDir = os.path.dirname(os.path.realpath('__file__'))
            rptPath = os.path.join(currentDir, 'Reports\\')

            if not os.path.exists(rptPath):
                os.makedirs(rptPath)

            fp = open(rptPath + 'Script_Report_' + self.script_param.script_start_time + '.txt','a')

            fp.write('壓縮機' + '\t')
            fp.write('EEV' + '\t')
            fp.write('風扇' + '\t')

            for curveIdx in range(curveNum):
                fp.write(self.curve_param.curveName[curveIdx] + '\t')

            for key, val in self.script_param.self_define_var.items():
                fp.write(key + '\t')
                self.script_param.self_define_var[key] = 0

            fp.write('\n')

            self.UI_system.scriptStop_flag = False
            self.UI_system.scriptMode_Flag = True

            script_thread = threading.Thread(target=self.scriptExeThread, daemon= True)
            script_thread.start()            

    def scriptExeThread(self):

        script_content = self.log_content.script_content_raw.split('\n')
        
        lineIdx = 0
        loopStrtIdx = 0
        while True:
            if self.UI_system.scriptStop_flag == True:
                break
            else:
                line = script_content[lineIdx]
                
                if len(line.split()) == 0 or line[0][0] == '#':
                    lineIdx = lineIdx + 1
                else:
                    element_0 = line.split(' ')[0]
                    indent_level = element_0.count('\t')

                    line = line.split()

                    if line[0] == 'Start':
                    
                        self.change_script_line_color(lineIdx)

                        for idx, val in enumerate(line):
                            if idx == 0:
                                pass
                            else:
                                if 'eval' in val:
                                    start = val.find('_eval(') + 6
                                    end = val.rfind(')')
                                    string = val[start:end]
                                    string_split = re.split('\+|-|\*|/|\(|\)', string)
                                    for item in string_split:
                                        if item in self.script_param.report_mapping:
                                            string = string.replace(item, self.ids[self.script_param.report_mapping[item]].text)
                                        elif item in self.script_param.self_define_var:
                                            string = string.replace(item, self.script_param.self_define_var[item])                                            
                                        else:
                                            pass

                                    line[idx] = str(eval(string))
                                else:
                                    if val in self.script_param.report_mapping:
                                        line[idx] = self.ids[val].text
                                    elif val in self.script_param.self_define_var:       
                                        line[idx] = self.script_param.self_define_var[val]
                                    else:
                                        pass

                        self.ids['set_enable_Comp'].active = True if line[1] != 'N/A' else False
                        if line[1] != 'N/A':
                            self.ids['set_enable_Comp'].active = True
                            if line[1] != 'hold':
                                self.ids['Input_compRPM'].text = line[1]
                            else:
                                pass                            
                        else:
                            self.ids['set_enable_Comp'].active = False

                        if line[2] != 'N/A':
                            self.ids['set_enable_EEV'].active = True
                            if line[2] != 'hold':
                                self.ids['Input_EEVDeg'].text = line[2]
                            else:
                                pass                                
                        else:
                            self.ids['set_enable_EEV'].active = False                    

                        if line[3] != 'N/A':
                            self.ids['set_enable_Fan'].active = True
                            if line[3] != 'hold':
                                self.ids['Input_FanSpeed'].text = line[3]
                            else:
                                pass         
                        else:
                            self.ids['set_enable_Fan'].active = False                          

                        self.start_button_pressed()

                        while self.UI_system.chk_board_status_flag == True:
                            time.sleep(.5)
                        lineIdx = lineIdx + 1

                        indent_level_next, lineIdx = self.indent_level_check(lineIdx)

                        if indent_level_next > indent_level:
                            print('Unexpected indent')
                            assert False
                        elif indent_level_next < indent_level:
                            lineIdx = self.jump_out_if_statement(lineIdx, indent_level)
                        else:
                            pass

                    elif line[0] == 'Set':

                        self.change_script_line_color(lineIdx)

                        for idx, val in enumerate(line):
                            if idx == 0:
                                pass
                            else:
                                if 'eval' in val:
                                    start = val.find('_eval(') + 6
                                    end = val.rfind(')')
                                    string = val[start:end]
                                    string_split = re.split('\+|-|\*|/|\(|\)', string)
                                    for item in string_split:
                                        if item in self.script_param.report_mapping:
                                            string = string.replace(item, self.ids[self.script_param.report_mapping[item]].text)
                                        elif item in self.script_param.self_define_var:
                                            string = string.replace(item, self.script_param.self_define_var[item])                                            
                                        else:
                                            pass

                                    line[idx] = str(eval(string))
                                else:
                                    if val in self.script_param.report_mapping:
                                        line[idx] = self.ids[val].text
                                    elif val in self.script_param.self_define_var:       
                                        line[idx] = self.script_param.self_define_var[val]                                        
                                    else:
                                        pass

                        self.ids['Input_compRPM'].text = line[1] if line[1] != 'hold' else self.ids['Input_compRPM'].text
                        self.ids['Input_EEVDeg'].text = line[2] if line[2] != 'hold' else self.ids['Input_EEVDeg'].text
                        self.ids['Input_FanSpeed'].text = line[3] if line[3] != 'hold' else self.ids['Input_FanSpeed'].text              

                        self.set_button_pressed()

                        while self.UI_system.chk_board_status_flag == True:
                            time.sleep(.5)
                        lineIdx = lineIdx + 1

                        indent_level_next, lineIdx = self.indent_level_check(lineIdx)

                        if indent_level_next > indent_level:
                            print('Unexpected indent')
                            assert False
                        elif indent_level_next < indent_level:
                            lineIdx = self.jump_out_if_statement(lineIdx, indent_level)
                        else:
                            pass

                    elif line[0] == 'Stop':

                        self.change_script_line_color(lineIdx)

                        self.update_statistic_report()

                        self.stop_button_pressed(False)
     
                        lineIdx = lineIdx + 1

                        indent_level_next, lineIdx = self.indent_level_check(lineIdx)
                    
                        if indent_level_next > indent_level:
                            print('Unexpected indent')
                            assert False
                        elif indent_level_next < indent_level:
                            lineIdx = self.jump_out_if_statement(lineIdx, indent_level)
                        else:
                            pass

                    elif line[0] == 'Updt_Statistic':

                        self.change_script_line_color(lineIdx)

                        self.update_statistic_report()

                        lineIdx = lineIdx + 1

                        indent_level_next, lineIdx = self.indent_level_check(lineIdx)

                        if indent_level_next > indent_level:
                            print('Unexpected indent')
                            assert False
                        elif indent_level_next < indent_level:
                            lineIdx = self.jump_out_if_statement(lineIdx, indent_level)
                        else:
                            pass

                    elif line[0] == 'Get':

                        self.change_script_line_color(lineIdx)
                        self.getReport(1)
                        lineIdx = lineIdx + 1

                        indent_level_next, lineIdx = self.indent_level_check(lineIdx)
                    
                        if indent_level_next > indent_level:
                            print('Unexpected indent')
                            assert False
                        elif indent_level_next < indent_level:
                            lineIdx = self.jump_out_if_statement(lineIdx, indent_level)
                        else:
                            pass

                    elif line[0] == 'Sleep':
                        
                        self.change_script_line_color(lineIdx)

                        time.sleep(int(line[1]))
                        lineIdx = lineIdx + 1

                        indent_level_next, lineIdx = self.indent_level_check(lineIdx)

                        if indent_level_next > indent_level:
                            print('Unexpected indent')
                            assert False
                        elif indent_level_next < indent_level:
                            lineIdx = self.jump_out_if_statement(lineIdx, indent_level)
                        else:
                            pass

                    elif line[0] == 'if':

                        self.change_script_line_color(lineIdx)

                        lineIdx = self.if_statement_handle(lineIdx, indent_level)

                        indent_level_next, lineIdx_chk = self.indent_level_check(lineIdx)

                        if lineIdx_chk < lineIdx or indent_level_next != indent_level + 1:
                            assert False
                        else:
                            pass

                    elif line[0] == 'Save':

                        self.change_script_line_color(lineIdx)

                        lineIdx = lineIdx + 1
                        self.scriptSaveData()

                        indent_level_next, lineIdx = self.indent_level_check(lineIdx)

                        if indent_level_next > indent_level:
                            print('Unexpected indent')
                            assert False
                        elif indent_level_next < indent_level:
                            lineIdx = self.jump_out_if_statement(lineIdx, indent_level)
                        else:
                            pass

                    elif line[0] == 'Calc': #only for self-define variables
                        
                        self.change_script_line_color(lineIdx)

                        lineIdx = lineIdx + 1

                        if line[1] in self.script_param.self_define_var:
                            string = line[2]
                            string_split = re.split('\+|-|\*|/|\(|\)', string)
                            for item in string_split:
                                if item in self.script_param.report_mapping:
                                    string = string.replace(item, self.ids[self.script_param.report_mapping[item]].text)
                                elif item in self.script_param.self_define_var:
                                    string = string.replace(item, str(self.script_param.self_define_var[item]))
                                else:
                                    pass

                            self.script_param.self_define_var[line[1]] = str(eval(string))
                        elif line[1] in self.script_param.report_mapping:
                            string = line[2]
                            string_split = re.split('\+|-|\*|/|\(|\)', string)
                            for item in string_split:
                                if item in self.script_param.report_mapping:
                                    string = string.replace(item, self.ids[self.script_param.report_mapping[item]].text)
                                elif item in self.script_param.self_define_var:
                                    string = string.replace(item, str(self.script_param.self_define_var[item]))
                                else:
                                    pass

                            self.ids[self.script_param.report_mapping[line[1]]].text = str(eval(string))                            
                        else:
                            assert False

                        indent_level_next, lineIdx = self.indent_level_check(lineIdx)

                        if indent_level_next > indent_level:
                            print('Unexpected indent')
                            assert False
                        elif indent_level_next < indent_level:
                            lineIdx = self.jump_out_if_statement(lineIdx, indent_level)
                        else:
                            pass

                    elif line[0] == 'LoopStrt':              

                        self.change_script_line_color(lineIdx)

                        loopStrtIdx = lineIdx
                        lineIdx = lineIdx + 1

                        indent_level_next, lineIdx = self.indent_level_check(lineIdx)

                        if indent_level != 0:
                            print('LoopStrt indent unexpected')
                            assert False    
                        elif indent_level_next != indent_level:
                            print('Unexpected indent')
                            assert False        

                    elif line[0] == 'LoopEnd':   

                        self.change_script_line_color(lineIdx)

                        lineIdx = loopStrtIdx

                    elif line[0] == 'END':

                        self.change_script_line_color(lineIdx)                        

                        print('END')
                        break                  
                    else:
                        print('Unrecognized command: ', line[0])
                        assert False

    def update_statistic_report(self):
        self.ids['total_test_cnt'].text = str("{0:.0f}".format(float(self.script_param.self_define_var['_totalCnt'])))
        self.ids['pass_test_cnt'].text = str("{0:.0f}".format(float(self.script_param.self_define_var['_passCnt'])))
        self.ids['fail_test_cnt'].text = str("{0:.0f}".format(float(self.script_param.self_define_var['_failCnt'])))

        self.ids['pass_rate'].text = str("{0:.2f}".format( 100 * float(self.script_param.self_define_var['_passCnt']) / float(self.script_param.self_define_var['_totalCnt'])))

    def if_statement_handle(self, lineIdx, indent_level):

        script_content = self.log_content.script_content_raw.split('\n')
        line = script_content[lineIdx].split()

        if 'eval' in line[1]:
            start = line[1].find('_eval(') + 6
            end = line[1].rfind(')')
            string = line[1][start:end]
            string_split = re.split('\+|-|\*|/|\(|\)', string)
            for item in string_split:
                if item in self.script_param.report_mapping:
                    string = string.replace(item, self.ids[self.script_param.report_mapping[item]].text)
                elif item in self.script_param.self_define_var:
                    string = string.replace(item, self.script_param.self_define_var[item])                       
                else:
                    pass

            left = float(eval(string))
        else:
            if '_' == line[1][0]:
                if line[1] in self.script_param.report_mapping:
                    left = float(self.ids[self.script_param.report_mapping[line[1]]].text)
                elif line[1] in self.script_param.self_define_var:
                    left = float(self.script_param.self_define_var[line[1]])
            else:
                left = float(line[1])
        
        if 'eval' in line[3]:
            start = line[3].find('_eval(') + 6
            end = line[3].rfind(')')
            string = line[3][start:end]
            string_split = re.split('\+|-|\*|/|\(|\)', string)
            for item in string_split:
                if item in self.script_param.report_mapping:
                    string = string.replace(item, self.ids[self.script_param.report_mapping[item]].text)
                elif item in self.script_param.self_define_var:
                    string = string.replace(item, self.script_param.self_define_var[item])                        
                else:
                    pass

            right = float(eval(string))            
        else:
            if '_' == line[3][0]:
                if line[3] in self.script_param.report_mapping:
                    right = float(self.ids[self.script_param.report_mapping[line[3]]].text)
                elif line[3] in self.script_param.self_define_var:
                    right = float(self.script_param.self_define_var[line[3]])
            else:
                right = float(line[3])

        if '>=' == line[2]:
            if left >= right:
                lineIdx = lineIdx + 1
                return lineIdx
            else:
                while True:
                    lineIdx = lineIdx + 1
                    indent_level_next, lineIdx = self.indent_level_check(lineIdx)
                    if indent_level_next != indent_level:
                        pass
                    else:
                        line = script_content[lineIdx].split()
                        if 'elif' == line[0]:
                            return self.if_statement_handle(lineIdx, indent_level)
                        elif 'else' == line[0]:
                            return lineIdx + 1
        elif '>' == line[2]:
            if left > right:
                lineIdx = lineIdx + 1
                return lineIdx
            else:
                while True:
                    lineIdx = lineIdx + 1
                    indent_level_next, lineIdx = self.indent_level_check(lineIdx)
                    if indent_level_next != indent_level:
                        pass
                    else:
                        line = script_content[lineIdx].split()
                        if 'elif' == line[0]:
                            return self.if_statement_handle(lineIdx, indent_level)
                        elif 'else' == line[0]:
                            return lineIdx + 1
        elif '<=' == line[2]:
            if left <= right:
                lineIdx = lineIdx + 1
                return lineIdx
            else:
                while True:
                    lineIdx = lineIdx + 1
                    indent_level_next, lineIdx = self.indent_level_check(lineIdx)
                    if indent_level_next != indent_level:
                        pass
                    else:
                        line = script_content[lineIdx].split()
                        if 'elif' == line[0]:
                            return self.if_statement_handle(lineIdx, indent_level)
                        elif 'else' == line[0]:
                            return lineIdx + 1
        elif '<' == line[2]:
            if left < right:
                lineIdx = lineIdx + 1
                return lineIdx
            else:
                while True:
                    lineIdx = lineIdx + 1
                    indent_level_next, lineIdx = self.indent_level_check(lineIdx)
                    if indent_level_next != indent_level:
                        pass
                    else:
                        line = script_content[lineIdx].split()
                        if 'elif' == line[0]:
                            return self.if_statement_handle(lineIdx, indent_level)
                        elif 'else' == line[0]:
                            return lineIdx + 1
        elif '==' == line[2]:
            if left == right:
                lineIdx = lineIdx + 1
                return lineIdx
            else:
                while True:
                    lineIdx = lineIdx + 1
                    indent_level_next, lineIdx = self.indent_level_check(lineIdx)
                    if indent_level_next != indent_level:
                        pass
                    else:
                        line = script_content[lineIdx].split()
                        if 'elif' == line[0]:
                            return self.if_statement_handle(lineIdx, indent_level)
                        elif 'else' == line[0]:
                            return lineIdx + 1
        elif '!=' == line[2]:
            if left != right:
                lineIdx = lineIdx + 1
                return lineIdx
            else:
                while True:
                    lineIdx = lineIdx + 1
                    indent_level_next, lineIdx = self.indent_level_check(lineIdx)
                    if indent_level_next != indent_level:
                        pass
                    else:
                        line = script_content[lineIdx].split()
                        if 'elif' == line[0]:
                            return self.if_statement_handle(lineIdx, indent_level)
                        elif 'else' == line[0]:
                            return lineIdx + 1
        else:
            print('Unrecognized statement')
            assert False

    def jump_out_if_statement(self, lineIdx, indent_level):

        script_content = self.log_content.script_content_raw.split('\n')

        while True:
            line = script_content[lineIdx]
            if len(line.split()) == 0 or line[0][0] == '#':
                lineIdx = lineIdx + 1
            else:
                element_0 = line.split(' ')[0]
                indent_level_next = element_0.count('\t')

                line = line.split()
                if indent_level_next <= indent_level:
                    if line[0] == 'elif' or line[0] == 'else':
                        indent_level = indent_level_next
                        lineIdx = lineIdx + 1
                    else:
                        break
                else:
                    lineIdx = lineIdx + 1

        return lineIdx

    def indent_level_check(self, lineIdx):

        script_content = self.log_content.script_content_raw.split('\n')

        while True:
            line = script_content[lineIdx]
            if len(line.split()) == 0 or line[0][0] == '#':
                lineIdx = lineIdx + 1
            else:
                element_0 = line.split(' ')[0]
                break

        return element_0.count('\t'), lineIdx

    def change_script_line_color(self, lineIdx):

        script_content = self.log_content.script_content_raw.split('\n')

        text = ''
        for idx, line in enumerate(script_content):
            if lineIdx == idx:
                line = '[color=ffff00]' + line + '[/color]'
            else:
                pass
            
            text = text + line + '\n'
        
        self.ids['lbl_script'].text = text.replace('\t', '    ')

########################################################################

    def init_flow(self):
        self.global_var_init()
        self.fileInit()

    def global_var_init(self):
        global curveNum
        global getReportInterval, dataBufferSampleCnt, dataBufferForTime, dataBuffer, dataBufferStored, rptCnt

        getReportInterval = float(self.ids['graph_interval'].text)
        dataBufferSampleCnt = int(self.ids['graph_sample_cnt'].text)
        dataBufferForTime = getReportInterval * dataBufferSampleCnt

        dataBuffer = [[0] * (math.ceil(dataBufferForTime / getReportInterval) + 1) ] * curveNum
        dataBufferStored = [[0] * (math.ceil(dataBufferForTime / getReportInterval) + 1) ] * curveNum
        rptCnt = 0
        self.UI_system.prev_report = None

        now = datetime.datetime.now()
        self.UI_system.sysActiveTime = str(now.year) + '_' + str(now.month) + '_' + str(now.day) + '_' + str(now.hour) + '_' + str(now.minute) + '_' + str(now.second)

        self.UI_system.alpha_comp, self.UI_system.alpha_fan, self.UI_system.alpha_fanCurr, self.UI_system.alpha_ipm = float(self.ids['alpha_comp'].text), float(self.ids['alpha_fan'].text), float(self.ids['alpha_fanCurr'].text), float(self.ids['alpha_ipm'].text)

        self.UI_system.compCurr_old = None
        self.UI_system.fanCurr_old = None
        self.UI_system.fan_old = None
        self.UI_system.compIpm_old = None
        self.UI_system.fanIpm_old = None

        self.UI_system.comp_start_flag = False
        self.UI_system.fan_start_flag = False
        self.UI_system.fanCurr_start_flag = False

        self.UI_system.monitorMode_Start_Flag = False
        self.UI_system.getReportFlag = False

    def fileInit(self):
        global curveNum, getReportInterval

        currentDir = os.path.dirname(os.path.realpath('__file__'))
        rptPath = os.path.join(currentDir, 'Reports\\')

        if not os.path.exists(rptPath):
            os.makedirs(rptPath)

        fp = open(rptPath + 'Report_' + self.UI_system.sysActiveTime + '.txt','a')

        fp.write('Sample Interval(s)\t' + str(getReportInterval) + '\n')

        fp.write('Curve Param\t')
        for item in self.curve_param.curveName:
            if item in self.curve_param.curvePos:
                fp.write(str(self.curve_param.curvePos[item]) + '\t')
            else:
                fp.write('N/A' + '\t')

        fp.write('\n\n')
        
        for curveIdx in range(curveNum):
            fp.write(self.curve_param.curveName[curveIdx] + '\t')

        fp.write('\n')
        fp.close()

    def start_mode_param_reset(self):
        global sysActiveFlag, getReportInterval

        sysActiveFlag = True                                    
        self.UI_system.chk_board_status_flag = True
        self.UI_system.setEEV_val = int(self.ids['Input_EEVDeg'].text)

        Clock.schedule_interval(self.report_task, getReportInterval)
        if self.ids['graph_enable'].text == 'True':
            Clock.schedule_interval(self.updtGraph, getReportInterval)
        else:
            pass

        if self.UI_system.remoteMode == False:
            self.debug_port_thread()
        else:
            pass
    def UI_reset(self):
        self.stop_mode_param_reset()
        self.UI_system.boardConnectionFlag = False

    def stop_mode_param_reset(self):
        global dataBufferStored, dataBuffer, rptCntStored, rptCnt
        global pauseStateFlag, sysActiveFlag

        sysActiveFlag = False
        pauseStateFlag = False
  
        self.UI_system.getReportFlag = False
        self.UI_system.chk_board_status_flag = False

        Clock.unschedule(self.report_task)
        Clock.unschedule(self.updtGraph)

        dataBufferStored = dataBuffer.copy()   
        rptCntStored = rptCnt

    def set_mode_reset_param(self):

        self.UI_system.chk_board_status_flag = True
        self.UI_system.setEEV_val = int(self.ids['Input_EEVDeg'].text)

        self.UI_system.chk_board_status_flag = True

        # reset AR value
        self.UI_system.fan_start_flag = False
        self.UI_system.fanCurr_start_flag = False
        self.UI_system.comp_start_flag = False

        if self.UI_system.scriptMode_Flag == True: # for checking if processing is done under script mode
            Clock.schedule_interval(self.report_task, getReportInterval)

    def change_button_color(self, source):
        global pauseStateFlag
        global dataBuffer, dataBufferStored, rptCnt, rptCntStored

        if self.ids['monitor_mode_enable'].text == 'True':
            self.ids['btn_conn'].text = 'Start'
            self.ids['btn_start'].background_color = [.5, .5, .5, 1]            
            self.ids['btn_start'].text = '[color=555555]Start[/color]'
            self.ids['btn_stop'].background_color = [.5, .5, .5, 1]            
            self.ids['btn_stop'].text = '[color=555555]Stop[/color]'
            self.ids['btn_set'].background_color = [.5, .5, .5, 1]            
            self.ids['btn_set'].text = '[color=555555]Set[/color]'
            self.ids['lbl_conn'].text = '[color=ff3333]未開始[/color]'
            if self.UI_system.monitorMode_Start_Flag == True:
                self.ids['btn_conn'].text = 'Stop'
                self.ids['lbl_conn'].text = '[color=7fff00]監測中[/color]'
            else: # self.UI_system.monitorMode_Start_Flag == False:
                self.ids['btn_conn'].text = 'Start'
                self.ids['lbl_conn'].text = '[color=ff3333]未開始[/color]'
        else: # self.ids['monitor_mode_enable'].text == 'False':
            if self.UI_system.boardConnectionFlag == True:
                self.ids['btn_conn'].text = 'Reset'
                self.ids['lbl_conn'].text = '[color=7fff00]已連線[/color]'
                if sysActiveFlag == True:
                    if source == 'Start':
                        if self.ids['btn_start'].text == 'Start':
                            pauseStateFlag = False
                            self.ids['btn_start'].text = 'Pause'
                        elif self.ids['btn_start'].text == 'Pause':
                            pauseStateFlag = True            
                            dataBufferStored = dataBuffer.copy()             
                            rptCntStored = rptCnt      
                            self.ids['btn_start'].text = self.ids['btn_start'].text.replace('Pause', 'Cont\'')
                        elif self.ids['btn_start'].text == 'Cont\'':
                            pauseStateFlag = False
                            self.ids['btn_start'].text = self.ids['btn_start'].text.replace('Cont\'', 'Pause')
                    else:
                        pass  
                else: # sysActiveFlag == False:
                    self.ids['btn_start'].text = 'Start'
                    self.ids['btn_stop'].text = 'Stop'
                    self.ids['btn_set'].text = 'Set'
            else: # self.UI_system.boardConnectionFlag == False:
                self.ids['btn_conn'].text = 'Conn'
                self.ids['lbl_conn'].text = '[color=ff3333]未連線[/color]'
                self.ids['btn_start'].text = 'Start'
                self.ids['btn_stop'].text = 'Stop'
                self.ids['btn_set'].text = 'Set'

            if self.UI_system.chk_board_status_flag == True:
                self.ids['btn_start'].background_color = [.5, .5, .5, 1]            
                self.ids['btn_start'].text = '[color=555555]' + self.ids['btn_start'].text + '[/color]'
                self.ids['btn_stop'].background_color = [.5, .5, .5, 1]        
                self.ids['btn_stop'].text = '[color=555555]' + self.ids['btn_stop'].text + '[/color]'
                self.ids['btn_set'].background_color = [.5, .5, .5, 1]                         
                self.ids['btn_set'].text = '[color=555555]' + self.ids['btn_set'].text + '[/color]'
            else:
                self.ids['btn_start'].background_color = [1, 1, 1, 1]             
                if 'Start' in self.ids['btn_start'].text:
                    self.ids['btn_start'].text = 'Start'
                elif 'Pause' in self.ids['btn_start'].text:
                    self.ids['btn_start'].text = 'Pause'
                elif 'Cont\'' in self.ids['btn_start'].text:
                    self.ids['btn_start'].text = 'Cont\''
                else:
                    assert False
                self.ids['btn_stop'].background_color = [1, 1, 1, 1]       
                self.ids['btn_stop'].text = 'Stop'
                self.ids['btn_set'].background_color = [1, 1, 1, 1]       
                self.ids['btn_set'].text = 'Set'

    def monitor_mode_enable_change(self):
        global sysActiveFlag

        if sysActiveFlag == False:
            self.change_button_color('Monitor')
        else: # sysActiveFlag == True
            if self.UI_system.monitorMode_Spinner_Fixed_Flag == False:
                if self.ids['monitor_mode_enable'].text == 'True':
                    self.UI_system.monitorMode_Spinner_Fixed_Flag = True
                    self.ids['monitor_mode_enable'].text == 'False'
                else:
                    self.UI_system.monitorMode_Spinner_Fixed_Flag = True
                    self.ids['monitor_mode_enable'].text == 'True'
            else:
                self.UI_system.monitorMode_Spinner_Fixed_Flag = False

    def threading_conn(self):
        global sysActiveFlag
        
        resp = self.SendGet('Connect', 0)
        if resp in self.UART_board.error_response:
            self.UI_Log_Control('Conn CMD :{}\n'.format(resp))   
            if  resp == 'Please Restart/Open the Remote Sever':
                self.UI_reset()
            else:
                pass
        elif resp == 'fake response':
            self.UI_Log_Control('Conn CMD set Successfully\n') 
            self.UI_Log_Control('Target is in idle state\n')
        elif (int(resp[0]) & 0x7) == 0x0:
            self.UI_Log_Control('Conn CMD set Successfully\n')
            if (int(resp[0]) & 0x8000) == 0x8000:
                self.UI_Log_Control('Target is already started\n')  

                self.init_flow()
                sysActiveFlag = True                                   
                
                Clock.schedule_interval(self.report_task, getReportInterval)
                if self.ids['graph_enable'].text == 'True':
                    Clock.schedule_interval(self.updtGraph, getReportInterval)
                else:
                    pass

                if self.UI_system.remoteMode == False and self.UI_system.boardMode == True:
                    self.debug_port_thread()
                else:
                    pass
            else:
                self.UI_Log_Control('Target is in idle state\n')

            self.UI_system.boardConnectionFlag = True
        else:
            self.UI_Log_Control('WARNING! Unexpected response {} for Connect Command\n'.format(resp))

        self.change_button_color('Conn')

    def conn_button_pressed(self):
        global sysActiveFlag, getReportInterval, rptCnt

        if self.ids['monitor_mode_enable'].text == 'False':
            if self.UI_system.boardConnectionFlag == False: 
                if self.UI_system.chk_board_status_flag == False:                              
                    threading.Thread(target=self.threading_conn, daemon= True).start()
                else: # self.UI_system.chk_board_status_flag = True
                    self.UI_Log_Control('[color=ff0000]' + 'System is busy' + '[/color]' + '\n' + \
                                '[color=ff8000]' + 'Please press the button after processing down' + '[/color]' + '\n' \
                                )   
            else: # self.UI_system.boardConnectionFlag = True
                self.UI_Log_Control('[color=ff0000]' + 'UI reset' + '[/color]' + '\n' + '[color=ccffcc]' + \
                            'Please Press the Conn when Ready' + '[/color]' + '\n' \
                            )
                self.UI_reset()           
        else: # self.ids['monitor_mode_enable'].text == 'True'            
            if self.UI_system.monitorMode_Start_Flag == False:
                resp = self.SendGet('Connect', 0)
                if resp in self.UART_board.error_response:
                    pass
                else:
                    self.init_flow()
                    sysActiveFlag = True
                    self.UI_system.monitorMode_Start_Flag = True
                                       
                    Clock.schedule_interval(self.report_task, getReportInterval)
                    if self.ids['graph_enable'].text == 'True':
                        Clock.schedule_interval(self.updtGraph, getReportInterval)
                    else:
                        pass

                    if self.UI_system.remoteMode == False:
                        self.debug_port_thread()
                    else:
                        pass                    
            else: # self.UI_system.monitorMode_Start_Flag == True
                self.UI_system.monitorMode_Start_Flag = False
                self.UI_reset()              
                
        self.change_button_color('Conn')

    def start_button_pressed(self):
        global sysActiveFlag

        self.textInputRangeChk()
        if self.ids['monitor_mode_enable'].text == 'False':
            if self.UI_system.chk_board_status_flag == False:
                if self.UI_system.boardConnectionFlag == True:                
                    if (self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active) in self.control_board_param.allowable_mode:
                        if sysActiveFlag == False:
                            self.UI_Log_Control('[color=7fff00]' + self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] + '[/color]' + '\n')

                            resp = self.SendGet('Start', 0)

                            if resp in self.UART_board.error_response:
                                self.UI_Log_Control('Start CMD :{}\n'.format(resp))  
                                if  resp == 'Please Restart/Open the Remote Sever':
                                    self.UI_reset()
                                else:
                                    pass   
                            elif resp == 'fake response' or (int(resp[0]) & 0x7) == 0x2:
                                self.UI_Log_Control('Start CMD set Successfully\n' + \
                                            'Please wait for the system processing...\n' \
                                            ) 
                                self.init_flow()
                                self.start_mode_param_reset()                        
                            else:
                                self.UI_Log_Control('WARNING! Unexpected response {} for Start Command\n'.format(resp))     
                        else: # sysActiveFlag == True
                            pass               
                    else:
                        string = ''
                        for key, value in self.control_board_param.allowable_mode.items():
                            string = string + '[color=ffff00]' + value + '[/color]' + '\n'
                        self.UI_Log_Control('[color=ff0000]' + 'Operating mode is not allowed' + '[/color]' + '\n' + \
                                    '壓縮機 : {}'.format('Enabled' if self.ids['set_enable_Comp'].active else 'Disabled') + '\n' + \
                                    'EEV : {}'.format('Enabled' if self.ids['set_enable_EEV'].active else 'Disabled') + '\n' + \
                                    '風扇 : {}'.format('Enabled' if self.ids['set_enable_Fan'].active else 'Disabled') + '\n' + \
                                    'Supported modes:' + '\n' + string \
                                    )
                else: #self.UI_system.boardConnectionFlag == False
                    pass
            else: #self.UI_system.chk_board_status_flag == False
                self.UI_Log_Control('[color=ff0000]' + 'System is busy' + '[/color]' + '\n' + \
                            '[color=ff8000]' + 'Please press the button after processing down' + '[/color]' + '\n' \
                            )
        else: # self.ids['monitor_mode_enable'].text == 'True'
            pass

        self.change_button_color('Start')

    def stop_button_pressed(self, force):
        global sysActiveFlag

        if self.ids['monitor_mode_enable'].text == 'False' or force == True:
            if self.UI_system.chk_board_status_flag == False or force == True:
                if self.UI_system.boardConnectionFlag == True:
                    if sysActiveFlag == True:
                        resp = self.SendGet('Stop', 0)
                        if resp in self.UART_board.error_response:
                            self.UI_Log_Control('Stop CMD :{}\n'.format(resp))
                            if  resp == 'Please Restart/Open the Remote Sever':
                                self.UI_reset() 
                            else:
                                pass
                        else:
                            if resp == 'fake response' or (int(resp[0]) & 0x7) == 0x3:
                                self.UI_Log_Control('Stop CMD set Successfully\n' + \
                                            '==========Testcase END==========\n' \
                                            )    
                                self.stop_mode_param_reset()           
                            else:
                                self.UI_Log_Control('WARNING! Unexpected response {} for Stop Command\n'.format(resp))
                    else: # sysActiveFlag == False
                        pass
                else: # self.UI_system.boardConnectionFlag == False
                    pass
            else:
                self.UI_Log_Control('[color=ff0000]' + 'System is busy' + '[/color]' + '\n'+ \
                            '[color=ff8000]' + 'Please press the button after processing down' + '[/color]' + '\n' \
                            ) 
        else: # self.ids['monitor_mode_enable'].text == 'True':
            pass

        self.change_button_color('Stop')

    def set_button_pressed(self):
        global getReportInterval

        self.textInputRangeChk() 

        if self.ids['monitor_mode_enable'].text == 'False':
            if self.UI_system.chk_board_status_flag == False:
                if self.UI_system.boardConnectionFlag == True and self.UI_system.boardMode == True:

                    resp = self.SendGet('Set', 0)

                    if resp in self.UART_board.error_response:
                        self.UI_Log_Control('Set CMD :{}\n'.format(resp))
                        if  resp == 'Please Restart/Open the Remote Sever':
                            self.UI_reset()
                        else:
                            pass
                    else:
                        if resp == 'fake response' or (int(resp[0]) & 0x7) == 0x4:
                            self.UI_Log_Control('Set CMD set Successfully\n') 

                            if self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Normal_Mode':
                                self.UI_Log_Control('壓縮機轉速 = {}\n電子膨脹閥開度 = {}\n風扇檔位 = {}\nScale = {}\n'.format(int(self.ids['Input_compRPM'].text), int(self.ids['Input_EEVDeg'].text), int(self.ids['Input_FanSpeed'].text), 1))
                            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_Only_Mode':
                                self.UI_Log_Control('壓縮機轉速 = {}\n電子膨脹閥開度 = {}\n風扇檔位 = {}\nScale = {}\n'.format(int(self.ids['Input_compRPM'].text), 0, 0, 1))
                            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'EEV_Only_Mode':
                                self.UI_Log_Control('壓縮機轉速 = {}\n電子膨脹閥開度 = {}\n風扇檔位 = {}\nScale = {}\n'.format(0, int(self.ids['Input_EEVDeg'].text), 0, 1))
                            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Fan_Only_Mode':
                                self.UI_Log_Control('壓縮機轉速 = {}\n電子膨脹閥開度 = {}\n風扇檔位 = {}\nScale = {}\n'.format(0, 0, int(self.ids['Input_FanSpeed'].text), 1))
                            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_EEV_Mode':
                                self.UI_Log_Control('壓縮機轉速 = {}\n電子膨脹閥開度 = {}\n風扇檔位 = {}\nScale = {}\n'.format(int(self.ids['Input_compRPM'].text), int(self.ids['Input_EEVDeg'].text), 0, 1))                            
                            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'Comp_Fan_Mode':
                                self.UI_Log_Control('壓縮機轉速 = {}\n電子膨脹閥開度 = {}\n風扇檔位 = {}\nScale = {}\n'.format(int(self.ids['Input_compRPM'].text), 0, int(self.ids['Input_FanSpeed'].text), 1))
                            elif self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] == 'EEV_Fan_Mode':
                                self.UI_Log_Control('壓縮機轉速 = {}\n電子膨脹閥開度 = {}\n風扇檔位 = {}\nScale = {}\n'.format(0, int(self.ids['Input_EEVDeg'].text), int(self.ids['Input_FanSpeed'].text), 1))
                            else:
                                assert False             
    
                            self.UI_Log_Control('Please wait for the system processing...\n')
                            self.set_mode_reset_param()
                        else:
                            self.UI_Log_Control('WARNING! Unexpected response {} for Set Command\n'.format(resp)) 
                else:
                    self.UI_system.paramSetFlag = True
            else:
                self.UI_Log_Control('[color=ff0000]' + 'System is busy' + '[/color]' + '\n' + \
                            '[color=ff8000]' + 'Please press the button after processing down' + '[/color]' + '\n' \
                            )       
        else: # self.ids['monitor_mode_enable'].text == 'True':        
            pass

        self.change_button_color('Set')

    def set_enable_active(self, identity):
        global sysActiveFlag

        if self.UI_system.checkboxFixedFlag == True:
            self.UI_system.checkboxFixedFlag = False
        else:
            if sysActiveFlag == True:
                self.UI_system.checkboxFixedFlag = True
                if self.ids[identity].active == True:                   
                    self.ids[identity].active = False
                else:
                    self.ids[identity].active = True
            else:
                pass        

    def range_button_pressed(self, btn, text_input, step, unit):
        
        if unit == 'int':
            if btn.text == '-':
                text_input.text = str(int(text_input.text) - step)
            elif btn.text == '+':
                text_input.text = str(int(text_input.text) + step)
            else:
                assert False
        elif unit == 'float':
            if btn.text == '-':
                text_input.text = str(round(float(text_input.text) - step, 3))
            elif btn.text == '+':
                text_input.text = str(round(float(text_input.text) + step, 3))
            else:
                assert False

    def textInputRangeChk(self):
        if int(self.ids['Input_compRPM'].text) > self.control_board_param.compRPM_max:
            self.ids['Input_compRPM'].text = str(self.control_board_param.compRPM_max)
        elif int(self.ids['Input_compRPM'].text) < self.control_board_param.compRPM_min:
            self.ids['Input_compRPM'].text = str(self.control_board_param.compRPM_min)
        else:
            pass

        if int(self.ids['Input_EEVDeg'].text) > self.control_board_param.EEVDeg_max:
            self.ids['Input_EEVDeg'].text = str(self.control_board_param.EEVDeg_max)
        elif int(self.ids['Input_EEVDeg'].text) < self.control_board_param.EEVDeg_min:
            self.ids['Input_EEVDeg'].text = str(self.control_board_param.EEVDeg_min)
        else:
            pass

        if int(self.ids['Input_FanSpeed'].text) > self.control_board_param.FanSpeed_max:
            self.ids['Input_FanSpeed'].text = str(self.control_board_param.FanSpeed_max)
        elif int(self.ids['Input_FanSpeed'].text) < self.control_board_param.FanSpeed_min:
            self.ids['Input_FanSpeed'].text = str(self.control_board_param.FanSpeed_min)
        else:
            pass

        self.ids['Input_FanSpeed'].text = str(int(round(int(self.ids['Input_FanSpeed'].text) / 60.0) * 60))


    def open_dev_conn(self):

        self.instrument_config.recorder.DEV = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.instrument_config.recorder.DEV.connect((self.instrument_config.recorder.TCP_IP, self.instrument_config.recorder.TCP_PORT))

        #  need to receive first time after connect success
        data = self.instrument_config.recorder.DEV.recv(self.instrument_config.recorder.BUFFER_SIZE)
        print("received data:", data.decode('utf-8'))

        self.instrument_config.powerMeter.DEV = self.instrument_config.rm.open_resource(self.instrument_config.powerMeter.port, read_termination ='\n')
        response = self.instrument_config.powerMeter.DEV.query('*IDN?')
        print('power meter IDN: ', response)

    def report_task(self, timeDiff):
        global sysActiveFlag

        if sysActiveFlag == True:
            thread_get_report = threading.Thread(target=self.getReport, args=(timeDiff,))
            thread_get_report.start()   

    def getReport(self, timeDiff):
        global sysActiveFlag, rptCnt, curveNum

        print("Get Report, Time diff = ", timeDiff)

        if self.UI_system.getReportFlag == False:
            self.UI_system.getReportFlag = True
            UI_reset = False

            resp = self.SendGet('Get', 0)

            if resp in self.UART_board.error_response:
                self.UI_Log_Control('Get CMD :{}\n'.format(resp))
                resp = self.UI_system.prev_report if self.UI_system.prev_report != None else (0, 0, 0, 0, 0, 0, 0)
                response = (str(resp[0]) + ' ' + str(resp[1]) + ' ' + str(resp[2]) + ' ' + str(resp[3])  + ' ' + str(resp[4])+ ' ' + str(resp[5]) + ' ' + str(resp[6])).split()     
            else:
                response = resp
                if self.UI_system.chk_board_status_flag == True:
                    if response == 'fake response':
                        self.UI_Log_Control('System Processing Done\n')
                        
                        if self.UI_system.scriptMode_Flag == True: # have to be here because 'Start' and 'Set' in script mode need wait for this flag to continue
                            Clock.unschedule(self.report_task)
                            Clock.unschedule(self.updtGraph)

                        self.UI_system.chk_board_status_flag = False

                    elif ((int(response[0]) & 0xC000) == 0xC000) and ((int(response[2]) == self.UI_system.setEEV_val) or self.control_board_param.allowable_mode[(self.ids['set_enable_Comp'].active, self.ids['set_enable_EEV'].active, self.ids['set_enable_Fan'].active)] in ['Fan_Only_Mode', 'Comp_Only_Mode', 'Comp_Fan_Mode']):
                        self.UI_Log_Control('System Processing Done\n')
                        
                        if self.UI_system.scriptMode_Flag == True: # have to be here because 'Start' and 'Set' in script mode need wait for this flag to continue
                            Clock.unschedule(self.report_task)
                            Clock.unschedule(self.updtGraph)

                        self.UI_system.chk_board_status_flag = False  
                    else:
                        pass
                        
                    self.change_button_color('Get')
                else:
                    pass

                if response == 'fake response' or (int(response[0]) & 0x7) == 0x5:
                    self.UI_system.prev_report = resp
                else:
                    self.UI_Log_Control('WARNING! Unexpected response {} for Get Command\n'.format(resp))
                    resp = self.UI_system.prev_report if self.UI_system.prev_report != None else (0, 0, 0, 0, 0, 0, 0, 0)
                    response = (str(resp[0]) + ' ' + str(resp[1]) + ' ' + str(resp[2]) + ' ' + str(resp[3])  + ' ' + str(resp[4])+ ' ' + str(resp[5]) + ' ' + str(resp[6]) + ' ' + str(resp[7])).split()  

            if self.UI_system.eerLabMode == True:
                self.getReportFromPowerMeter()
                self.getReportFromRecorder()
                self.ability_calculation()

            capData = []
            for idx, item in enumerate(range(curveNum)):
                if 'EEV' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.boardMode == True:
                        capData.append(int(response[2]))
                    else:
                        if self.UI_system.paramSetFlag == True:
                            capData.append(float(self.ids['Input_EEVDeg'].text))
                        else:
                            capData.append(float(self.ids['lbl_rpt_' + str((self.curve_param.curveName).index("EEV"))].text))
                elif '壓縮機電流' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.boardMode == True:
                        if self.UI_system.comp_start_flag == True:
                            compCurr_new = float(response[5]) * 0.01174 * 2
                            compCurr = self.UI_system.compCurr_old * (1 - self.UI_system.alpha_comp) + compCurr_new * self.UI_system.alpha_comp
                            self.UI_system.compCurr_old = compCurr
                            capData.append(round(compCurr, 2))
                        else:
                            if float(response[5]) != 0:
                                self.UI_system.comp_start_flag = True
                                compCurr_new = float(response[5]) * 0.01174 * 2
                                self.UI_system.compCurr_old = compCurr_new
                                capData.append(round(compCurr_new, 2))
                            else:
                                capData.append(0)
                    else:
                        capData.append(item)          
                elif '壓縮機IPM' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.boardMode == True:
                        if self.UI_system.compIpm_old == None:
                            if int(response[4]) < 500:
                                ipm_new = int(response[4])
                                self.UI_system.compIpm_old = ipm_new
                                capData.append(ipm_new)   
                            else:
                                ipm_new = 0
                                self.UI_system.compIpm_old = None
                                capData.append(0)   
                        else:
                            ipm_new = int(response[4]) if int(response[4]) < 500 else self.UI_system.compIpm_old
                            ipm = self.UI_system.compIpm_old * (1 - self.UI_system.alpha_ipm) + ipm_new * self.UI_system.alpha_ipm
                            self.UI_system.compIpm_old = ipm
                            capData.append(ipm)                  

                    else:
                        capData.append(item) 
                elif '風扇IPM' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    capData.append(0)
                    # if self.UI_system.boardMode == True:
                    #     if self.UI_system.fanIpm_old == None:
                    #         if int(response[4]) < 500:
                    #             ipm_new = int(response[4])
                    #             self.UI_system.fanIpm_old = ipm_new
                    #             capData.append(ipm_new)   
                    #         else:
                    #             ipm_new = 0
                    #             self.UI_system.fanIpm_old = None
                    #             capData.append(0)   
                    #     else:
                    #         ipm_new = int(response[4]) if int(response[4]) < 500 else self.UI_system.fanIpm_old
                    #         ipm = self.UI_system.fanIpm_old * (1 - self.UI_system.alpha_ipm) + ipm_new * self.UI_system.alpha_ipm
                    #         self.UI_system.fanIpm_old = ipm
                    #         capData.append(ipm)                  
                    # else:
                    #     capData.append(item) 
                elif '風扇電流' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.boardMode == True:
                        if self.UI_system.fanCurr_start_flag == True:
                            fanCurr_new = float(response[6]) * 0.01174 * 2
                            fanCurr = self.UI_system.fanCurr_old * (1 - self.UI_system.alpha_fanCurr) + fanCurr_new * self.UI_system.alpha_fanCurr
                            self.UI_system.fanCurr_old = fanCurr
                            capData.append(round(fanCurr, 2))
                        else:
                            if float(response[6]) != 0:
                                self.UI_system.fanCurr_start_flag = True
                                fanCurr_new = float(response[6]) * 0.01174 * 2
                                self.UI_system.fanCurr_old = fanCurr_new
                                capData.append(round(fanCurr_new, 2))
                            else:
                                capData.append(0)
                    else:
                        capData.append(item)                                                  
                elif '壓縮機' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.boardMode == True:
                        capData.append(float(response[1]) / 3)
                    else:
                        if self.UI_system.paramSetFlag == True:
                            capData.append(float(self.ids['Input_compRPM'].text))
                        else:
                            capData.append(float(self.ids['lbl_rpt_' + str((self.curve_param.curveName).index("壓縮機"))].text))
                elif '風扇' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.boardMode == True:
                        if self.UI_system.fan_start_flag == True:
                            fan_new = int(int(response[3]) * 15) if int(int(response[3]) * 15) < 2000 else self.UI_system.fan_old
                            fan = self.UI_system.fan_old * (1 - self.UI_system.alpha_fan) + fan_new * self.UI_system.alpha_fan
                            self.UI_system.fan_old = fan
                            capData.append(fan)                     
                        else:
                            if int(response[3]) != 0:
                                if int(int(response[3]) * 15) < 2000:
                                    self.UI_system.fan_start_flag = True
                                    fan_new = int(int(response[3]) * 15)
                                    self.UI_system.fan_old = fan_new
                                    capData.append(fan_new)        
                                else:
                                    capData.append(0)        
                            else:
                                capData.append(0)                              
                    else:
                        if self.UI_system.paramSetFlag == True:
                            capData.append(float(self.ids['Input_FanSpeed'].text))
                        else:
                            capData.append(float(self.ids['lbl_rpt_' + str((self.curve_param.curveName).index("風扇"))].text))
                elif '高壓' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.eerLabMode == True:
                        capData.append(round(float(self.ids['lbl_raw_data_val_1_4'].text), 1))
                    else:
                        capData.append('N/A')
                elif '低壓' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.eerLabMode == True:
                        capData.append(round(float(self.ids['lbl_raw_data_val_1_5'].text), 1))
                    else:
                        capData.append('N/A')    
                elif '吐出溫度' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.eerLabMode == True:
                        capData.append(round(float(self.ids['lbl_raw_data_val_2_0'].text), 1))
                    else:
                        capData.append('N/A')     
                elif '吸入溫度' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.eerLabMode == True:
                        capData.append(round(float(self.ids['lbl_raw_data_val_2_1'].text), 1))
                    else:
                        capData.append('N/A')    
                elif '毛前溫度' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.eerLabMode == True:
                        capData.append(round(float(self.ids['lbl_raw_data_val_2_2'].text), 1))
                    else:
                        capData.append('N/A') 
                elif '過冷度' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.eerLabMode == True:
                        capData.append(round(float(self.ids['lbl_raw_data_val_1_6'].text), 2))
                    else:
                        capData.append('N/A') 
                elif '過熱度' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.eerLabMode == True:
                        capData.append(round(float(self.ids['lbl_raw_data_val_1_7'].text), 2))
                    else:
                        capData.append('N/A')              
                elif '功率' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.eerLabMode == True:
                        capData.append(round(float(self.ids['lbl_raw_data_val_4_2'].text), 2))
                    else:
                        capData.append('N/A')                 
                elif '能力' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.eerLabMode == True:
                        capData.append(round(float(self.ids['lbl_raw_data_val_4_4'].text), 0))
                    else:
                        capData.append('N/A')   
                elif 'COP' in self.ids['lbl_rpt_curve_name_' + str(idx)].text:
                    if self.UI_system.eerLabMode == True:
                        capData.append(round(float(self.ids['lbl_raw_data_val_4_6'].text), 2))
                    else:
                        capData.append('N/A')  
                else:                                                                                                                                                                                                            
                    capData.append(item)

            self.updt_lbl_rpt(capData) 
            self.updt_lbl_color()
            self.saveData(capData)

            for curveIdx in range(curveNum):
                lis = dataBuffer[curveIdx][1:]
                lis.append(capData[curveIdx])
                dataBuffer[curveIdx] = lis     

            if UI_reset == True:
                self.UI_reset()
            else:
                pass

            rptCnt = rptCnt + 1

            if self.UI_system.paramSetFlag == True:
                self.UI_system.paramSetFlag = False
            self.UI_system.getReportFlag = False

            self.check_protection()
        else: #self.UI_system.getReportFlag = True
            print('Previous Get CMD is not Done yet')

    def check_protection(self):
        global curveNum

        force_off_flag = False
        if self.UI_system.boardMode == True:
            for curveIdx in range(curveNum):                
                if '壓縮機電流' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if float(self.ids['lbl_rpt_' + str(curveIdx)].text) > float(self.ids['compCurr_protect'].text):
                        self.UI_Log_Control('Compressor Current Exceeds Threshold\n' + \
                                        'Force off\n' \
                                    )
                        force_off_flag = True
                    else:
                        pass
                elif '風扇電流' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if float(self.ids['lbl_rpt_' + str(curveIdx)].text) > float(self.ids['fanCurr_protect'].text):
                        self.UI_Log_Control('Fan Current Exceeds Threshold\n' + \
                                        'Force off\n' \
                                    )
                        force_off_flag = True
                    else:
                        pass
                elif '壓縮機IPM' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if float(self.ids['lbl_rpt_' + str(curveIdx)].text) > float(self.ids['ipmTemp_protect'].text):
                        self.UI_Log_Control('IPM Temperature Exceeds Threshold\n' + \
                                        'Force off\n' \
                                    )
                        force_off_flag = True
                    else:
                        pass
                else:    
                    pass
        else:
            pass

        if force_off_flag == True:
            if self.ids['monitor_mode_enable'].text == 'False':
                self.stop_button_pressed(True)
            else:
                self.force_stop_under_monitor_mode()
        else:
            pass

    def refri_sat_temp(self):
        high_press = float(self.ids['lbl_raw_data_val_1_4'].text)
        low_press = float(self.ids['lbl_raw_data_val_1_5'].text)

        return self.refri_table.refri_table[min(self.refri_table.refri_table, key=lambda x:abs(x-high_press))], self.refri_table.refri_table[min(self.refri_table.refri_table, key=lambda x:abs(x-low_press))]

    def ability_calculation(self):
        pressure = 100658.1

        dry_ball_hole = float(self.ids['lbl_raw_data_val_0_4'].text)
        wet_ball_hole = float(self.ids['lbl_raw_data_val_0_5'].text)
        
        water_vapor_pressure_hole = 0.621121 * np.exp((18.678 - wet_ball_hole/234.5) * (wet_ball_hole / (257.14 + wet_ball_hole))) * 1000
        Ws_hole = 0.62198 * water_vapor_pressure_hole / (pressure - wet_ball_hole)
        W_hole = ((2501 - 2.381 * wet_ball_hole) * Ws_hole - 1.006 * (dry_ball_hole - wet_ball_hole)) / (2501 + 1.805 * dry_ball_hole - 4.186 * wet_ball_hole)
        specific_volumn_hole = 0.2871 * (dry_ball_hole + 273.15) * (1 + 1.6078 * W_hole) / (pressure / 1000)
        enthalpy_hole = 1.006 * dry_ball_hole + W_hole * (2501 + 1.805 * dry_ball_hole)

        dry_ball_indoor = float(self.ids['lbl_raw_data_val_0_0'].text)
        wet_ball_indoor = float(self.ids['lbl_raw_data_val_0_1'].text)
        
        water_vapor_pressure_indoor = 0.621121 * np.exp((18.678 - wet_ball_indoor/234.5) * (wet_ball_indoor / (257.14 + wet_ball_indoor))) * 1000
        Ws_indoor = 0.62198 * water_vapor_pressure_indoor / (pressure - wet_ball_indoor)
        W_indoor = ((2501 - 2.381 * wet_ball_indoor) * Ws_indoor - 1.006 * (dry_ball_indoor - wet_ball_indoor)) / (2501 + 1.805 * dry_ball_indoor - 4.186 * wet_ball_indoor)
        # specific_volumn_indoor = 0.2871 * (dry_ball_indoor + 273.15) * (1 + 1.6078 * W_indoor) / (pressure / 1000)
        enthalpy_indoor = 1.006 * dry_ball_indoor + W_indoor * (2501 + 1.805 * dry_ball_indoor)

        pressure_diff = float(self.ids['lbl_raw_data_val_0_7'].text)

        wind_speed = math.sqrt(2 * 9.81 * pressure_diff * specific_volumn_hole) if pressure_diff > 0 else 0

        spray_total = 0
        for idx, item in enumerate(['2p5_1', '2p5_2', '3', '4', '6']):
            if self.ids['spray_head_' + item].active == True:
                if '2p5' in item:
                    spray_total = spray_total + math.pi * (2.5 ** 2)
                else:
                    spray_total = spray_total + math.pi * ((float(item)/2) ** 2)
            else:
                pass
        
        wind_volumn = wind_speed * 39.37 * spray_total
        wind_volumn_m3 = wind_volumn * (0.0254 ** 3)
        
        instrument_heat_loss = round((dry_ball_indoor - dry_ball_hole) * 6.5, 0)
        ability = wind_volumn_m3 * (enthalpy_indoor - enthalpy_hole) / (specific_volumn_hole * (1 + W_hole)) * 1000
        # print(instrument_heat_loss, ability)
        self.ids['lbl_raw_data_val_4_4'].text = str("{0:.0f}".format(round(ability * 0.98  + instrument_heat_loss, 0)))
        self.ids['lbl_raw_data_val_4_5'].text = str("{0:.2f}".format(float(self.ids['lbl_raw_data_val_4_4'].text) / 5000 * 100))
        self.ids['lbl_raw_data_val_4_6'].text = str("{0:.2f}".format(ability / float(self.ids['lbl_raw_data_val_4_2'].text)))

    def getReportFromRecorder(self):

        #record the required oaram for temp line
        outdoor_temp_line = {}
        indoor_temp_line = {}
        for idx in range(8):
            if self.ids['spinner_outdoor_temp_line_'+str(idx)].text != 'Disable':
                param_name = '室外感溫線' + self.ids['spinner_outdoor_temp_line_'+str(idx)].text
                outdoor_temp_line[param_name] = 'N/A'
            else:
                pass
            if self.ids['spinner_indoor_temp_line_'+str(idx)].text != 'Disable':
                param_name = '室內感溫線' + self.ids['spinner_indoor_temp_line_'+str(idx)].text
                indoor_temp_line[param_name] = 'N/A'
            else:
                pass

        CMD = "FData,0\r\n"
        self.instrument_config.recorder.DEV.send(CMD.encode('utf-8'))
        data = self.instrument_config.recorder.DEV.recv(self.instrument_config.recorder.BUFFER_SIZE)
        decodeData = data.decode('utf-8')
        for itemIdx, item in enumerate(decodeData.split('\r\n')):
            if itemIdx > 2 and itemIdx < 103:
                array = item.split()
                if array[0] == 'N':
                    try:
                        element_name = self.raw_data_param.param_index_name[array[1]]
                    except:
                        print('{} not in param_index_name Dict'.format(array[1]))
                        continue

                    if element_name in outdoor_temp_line:
                        if len(array) == 4:
                            value_array = array[3].split('E')
                            value = round(int(value_array[0]) * (10 ** int(value_array[1])), 2)                    
                        elif len(array) == 3:
                            value_array = array[2].split('E')
                            value = round(int(value_array[0]) * (10 ** int(value_array[1])), 2)

                        outdoor_temp_line[element_name] = str(value)
                    elif element_name in indoor_temp_line:
                        if len(array) == 4:
                            value_array = array[3].split('E')
                            value = round(int(value_array[0]) * (10 ** int(value_array[1])), 2)                    
                        elif len(array) == 3:
                            value_array = array[2].split('E')
                            value = round(int(value_array[0]) * (10 ** int(value_array[1])), 2)

                        indoor_temp_line[element_name] = str(value)                        
                    else:
                        for rowIdx in range(2):
                            for idx in range(8):
                                if rowIdx == 0:
                                    if idx == 2 or idx == 3:
                                        param_name = self.ids['lbl_raw_data_name_' + str(rowIdx) + '_' + str(idx)].text + self.ids['outdoor_system'].text
                                    else:
                                        param_name = self.ids['lbl_raw_data_name_' + str(rowIdx) + '_' + str(idx)].text + self.ids['indoor_system'].text
                                else:
                                    param_name = self.ids['lbl_raw_data_name_' + str(rowIdx) + '_' + str(idx)].text

                                if param_name == element_name:
                                    if len(array) == 4:
                                        value_array = array[3].split('E')
                                        value = round(int(value_array[0]) * (10 ** int(value_array[1])), 2)
                                        self.ids['lbl_raw_data_val_' + str(rowIdx) + '_' + str(idx)].text = str(value)
                                        self.ids['lbl_raw_data_unit_' + str(rowIdx) + '_' + str(idx)].text = array[2]                    
                                    elif len(array) == 3:
                                        value_array = array[2].split('E')
                                        value = round(int(value_array[0]) * (10 ** int(value_array[1])), 2)
                                        self.ids['lbl_raw_data_val_' + str(rowIdx) + '_' + str(idx)].text = str(value)
                                        self.ids['lbl_raw_data_unit_' + str(rowIdx) + '_' + str(idx)].text = ''
                                    else:
                                        print(array)    
                                        assert False     
                        
                else:
                    if array[0] == 'O':
                        print('O', array)
                        try:
                            element_name = self.raw_data_param.param_index_name[array[1]]
                        except:
                            print('{} not in param_index_name Dict'.format(array[1]))
                            continue

                        if element_name in outdoor_temp_line:
                            value = 'OF'  
                            outdoor_temp_line[element_name] = str(value)
                        elif element_name in indoor_temp_line:
                            value = 'OF'  
                            indoor_temp_line[element_name] = str(value)                        
                        else:
                            for rowIdx in range(2):
                                for idx in range(8):      
                                    if rowIdx == 0:
                                        if idx == 2 or idx == 3:
                                            param_name = self.ids['lbl_raw_data_name_' + str(rowIdx) + '_' + str(idx)].text + self.ids['outdoor_system'].text
                                        else:
                                            param_name = self.ids['lbl_raw_data_name_' + str(rowIdx) + '_' + str(idx)].text + self.ids['indoor_system'].text
                                    else:
                                        param_name = self.ids['lbl_raw_data_name_' + str(rowIdx) + '_' + str(idx)].text

                                    if param_name == element_name:
                                        if len(array) == 4:
                                            self.ids['lbl_raw_data_val_' + str(rowIdx) + '_' + str(idx)].text = 'OF'
                                            self.ids['lbl_raw_data_unit_' + str(rowIdx) + '_' + str(idx)].text = array[2]                    
                                        elif len(array) == 3:
                                            self.ids['lbl_raw_data_val_' + str(rowIdx) + '_' + str(idx)].text = 'OF'
                                            self.ids['lbl_raw_data_unit_' + str(rowIdx) + '_' + str(idx)].text = ''
                                        else:
                                            print(array)    
                                            assert False            

                    elif array[0] == 'S':
                        print('S', array)
                        try:
                            element_name = self.raw_data_param.param_index_name[array[1]]
                        except:
                            print('{} not in param_index_name Dict'.format(array[1]))
                            continue

                        if element_name in outdoor_temp_line:
                            value = 'S'            
                            outdoor_temp_line[element_name] = str(value)
                        elif element_name in indoor_temp_line:
                            value = 'S'
                            indoor_temp_line[element_name] = str(value)                        
                        else:
                            for rowIdx in range(2):
                                for idx in range(8):     
                                    if rowIdx == 0:
                                        if idx == 2 or idx == 3:
                                            param_name = self.ids['lbl_raw_data_name_' + str(rowIdx) + '_' + str(idx)].text + self.ids['outdoor_system'].text
                                        else:
                                            param_name = self.ids['lbl_raw_data_name_' + str(rowIdx) + '_' + str(idx)].text + self.ids['indoor_system'].text
                                    else:
                                        param_name = self.ids['lbl_raw_data_name_' + str(rowIdx) + '_' + str(idx)].text

                                    if param_name == element_name:
                                            self.ids['lbl_raw_data_val_' + str(rowIdx) + '_' + str(idx)].text = 'S'
                                            self.ids['lbl_raw_data_unit_' + str(rowIdx) + '_' + str(idx)].text = ''  
                    elif array[0] == 'EN':
                        pass
                    else:
                        print(array)
                        assert False

        for rowIdx in range(2, 4):
            if rowIdx == 2:
                for idx in range(8):
                    if self.ids['spinner_outdoor_temp_line_'+str(idx)].text == 'Disable':
                        self.ids['lbl_raw_data_val_' + str(rowIdx) + '_' + str(idx)].text = '--'
                        self.ids['lbl_raw_data_unit_' + str(rowIdx) + '_' + str(idx)].text = ''  
                    else:
                        self.ids['lbl_raw_data_val_' + str(rowIdx) + '_' + str(idx)].text = outdoor_temp_line['室外感溫線' + self.ids['spinner_outdoor_temp_line_'+str(idx)].text]
                        self.ids['lbl_raw_data_unit_' + str(rowIdx) + '_' + str(idx)].text = '℃'
            elif rowIdx == 3:
                for idx in range(8):
                    if self.ids['spinner_indoor_temp_line_'+str(idx)].text == 'Disable':
                        self.ids['lbl_raw_data_val_' + str(rowIdx) + '_' + str(idx)].text = '--'
                        self.ids['lbl_raw_data_unit_' + str(rowIdx) + '_' + str(idx)].text = ''  
                    else:
                        self.ids['lbl_raw_data_val_' + str(rowIdx) + '_' + str(idx)].text = indoor_temp_line['室內感溫線' + self.ids['spinner_indoor_temp_line_'+str(idx)].text]
                        self.ids['lbl_raw_data_unit_' + str(rowIdx) + '_' + str(idx)].text = '℃'
            else:
                assert False

        high_press_sat_temp, low_press_sat_temp = self.refri_sat_temp()
        # print(high_press_sat_temp, low_press_sat_temp)
        self.ids['lbl_raw_data_val_1_6'].text = str(round(high_press_sat_temp - float(self.ids['lbl_raw_data_val_2_2'].text), 2))
        self.ids['lbl_raw_data_unit_1_6'].text = '℃'
        
        self.ids['lbl_raw_data_val_1_7'].text = str(round(float(self.ids['lbl_raw_data_val_2_1'].text) - low_press_sat_temp, 2))
        self.ids['lbl_raw_data_unit_1_7'].text = '℃'

    def getReportFromPowerMeter(self):

        try:
            pmData = self.instrument_config.powerMeter.DEV.query('NUM:VAL?').split(',')

            if self.ids['power_supply'].text == '1':
                voltage = float(pmData[0].split('E')[0]) * 10**int(pmData[0].split('E')[1])
                current = float(pmData[1].split('E')[0]) * 10**int(pmData[1].split('E')[1])
                power = float(pmData[2].split('E')[0]) * 10**int(pmData[2].split('E')[1])
                pf = float(pmData[10].split('E')[0]) * 10**int(pmData[10].split('E')[1]) if pmData[10] != 'INF' else 'INF'
            elif self.ids['power_supply'].text == '2':
                voltage = float(pmData[3].split('E')[0]) * 10**int(pmData[3].split('E')[1])
                current = float(pmData[4].split('E')[0]) * 10**int(pmData[4].split('E')[1])
                power = float(pmData[5].split('E')[0]) * 10**int(pmData[5].split('E')[1])
                pf = float(pmData[11].split('E')[0]) * 10**int(pmData[11].split('E')[1]) if pmData[11] != 'INF' else 'INF'
            elif self.ids['power_supply'].text == '3':
                voltage = float(pmData[6].split('E')[0]) * 10**int(pmData[6].split('E')[1])
                current = float(pmData[7].split('E')[0]) * 10**int(pmData[7].split('E')[1])
                power = float(pmData[8].split('E')[0]) * 10**int(pmData[8].split('E')[1])
                pf = float(pmData[12].split('E')[0]) * 10**int(pmData[12].split('E')[1]) if pmData[12] != 'INF' else 'INF'

            self.ids['lbl_raw_data_val_4_0'].text = str("{0:.2f}".format(round(voltage, 2)))
            self.ids['lbl_raw_data_val_4_1'].text = str("{0:.3f}".format(round(current, 3)))
            self.ids['lbl_raw_data_val_4_2'].text = str("{0:.2f}".format(round(power, 3)))
            self.ids['lbl_raw_data_val_4_3'].text = str("{0:.4f}".format(round(pf, 4)))
        except:
            print('!!!!!!!!!!!!!!!!!!!!!')
            print(pmData)

    def updt_lbl_rpt(self, capData):
        global curveNum, pauseStateFlag

        if pauseStateFlag == False:
            for curveIdx in range(curveNum):
                    
                if '壓縮機IPM' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.2f}".format(round(capData[curveIdx], 2)))
                elif '風扇IPM' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.2f}".format(round(capData[curveIdx], 2)))
                elif 'EEV' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    self.ids['lbl_rpt_' + str(curveIdx)].text = str(round(capData[curveIdx]))
                elif '壓縮機電流' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.2f}".format(round(capData[curveIdx], 2)))
                elif '風扇電流' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.2f}".format(round(capData[curveIdx], 2)))
                elif '壓縮機' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.2f}".format(round(capData[curveIdx], 2)))                        
                elif '風扇' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    self.ids['lbl_rpt_' + str(curveIdx)].text = str(round(capData[curveIdx]))
                elif '高壓' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if self.UI_system.eerLabMode == True:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.1f}".format(round(capData[curveIdx], 1)))
                    else:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = capData[curveIdx]
                elif '低壓' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if self.UI_system.eerLabMode == True:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.1f}".format(round(capData[curveIdx], 1)))
                    else:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = capData[curveIdx]
                elif '吐出溫度' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if self.UI_system.eerLabMode == True:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.1f}".format(round(capData[curveIdx], 1)))
                    else:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = capData[curveIdx]
                elif '吸入溫度' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if self.UI_system.eerLabMode == True:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.1f}".format(round(capData[curveIdx], 1)))
                    else:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = capData[curveIdx]
                elif '毛前溫度' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if self.UI_system.eerLabMode == True:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.1f}".format(round(capData[curveIdx], 1)))
                    else:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = capData[curveIdx]
                elif '過冷度' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if self.UI_system.eerLabMode == True:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.2f}".format(round(capData[curveIdx], 2)))
                    else:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = capData[curveIdx]
                elif '過熱度' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if self.UI_system.eerLabMode == True:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.2f}".format(round(capData[curveIdx], 2)))
                    else:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = capData[curveIdx]
                elif '功率' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if self.UI_system.eerLabMode == True:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.2f}".format(round(capData[curveIdx], 2)))
                    else:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = capData[curveIdx]
                elif 'COP' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if self.UI_system.eerLabMode == True:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.2f}".format(round(capData[curveIdx], 2)))
                    else:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = capData[curveIdx]
                elif '能力' in self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text:
                    if self.UI_system.eerLabMode == True:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.0f}".format(round(capData[curveIdx], 0)))
                    else:
                        self.ids['lbl_rpt_' + str(curveIdx)].text = capData[curveIdx]
                else:    
                    self.ids['lbl_rpt_' + str(curveIdx)].text = str("{0:.3f}".format(round(capData[curveIdx], 3)))

        else:
            pass

    def updt_lbl_color(self):
        global curveNum, colorDictHex, color, color_0, color_1

        plotIdx_0 = 0
        plotIdx_1 = 0
        for curveIdx in range(curveNum):
            if self.curve_param.curveName[curveIdx] in self.curve_param.curvePos:
                if 'G0' in self.curve_param.curvePos[self.curve_param.curveName[curveIdx]]:
                    self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text = '[color=' + colorDictHex[color_0[plotIdx_0]] + ']' + self.curve_param.curveName[curveIdx] + '[/color]'
                    plotIdx_0 = plotIdx_0 + 1
                elif 'G1' in self.curve_param.curvePos[self.curve_param.curveName[curveIdx]]:
                    self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text = '[color=' + colorDictHex[color_1[plotIdx_1]] + ']' + self.curve_param.curveName[curveIdx] + '[/color]'
                    plotIdx_1 = plotIdx_1 + 1
                else:
                    self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text = '[color=333333]' + self.curve_param.curveName[curveIdx] + '[/color]'
            elif self.curve_param.curveName[curveIdx] in ['高壓', '低壓', '吐出溫度', '吸入溫度', '毛前溫度', '過冷度', '過熱度', '功率', '能力', 'COP']:
                if self.UI_system.eerLabMode == True:
                    self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text = self.curve_param.curveName[curveIdx]
                else:
                    self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text = '[color=333333]' + self.curve_param.curveName[curveIdx] + '[/color]'     
            else:
                self.ids['lbl_rpt_curve_name_' + str(curveIdx)].text = '[color=333333]' + self.curve_param.curveName[curveIdx] + '[/color]' 

    def graphSetting(self, ax1, ax2, fig, souce, left, right):

        ax1.grid()
        ax1.set_facecolor((0, 0, 0))
        fig.set_facecolor((0, 0, 0))
        ax1.tick_params(axis='x', colors=(1, 1, 1))
        ax1.tick_params(axis='y', colors=(1, 1, 1))
        ax2.tick_params(axis='y', colors=(1, 1, 1))

        fontP = matplotlib.font_manager.FontProperties(fname='ARIALUNI.TTF')

        if souce == 'Init':
            pass
        else:
            
            if left == True:
                legend = ax1.legend(bbox_to_anchor=(0, 1), loc=2, borderaxespad=0, facecolor=(0, 0, 0, 0), prop=fontP)
                legend.get_frame().set_alpha(0)
                for text in legend.get_texts():
                    text.set_color("w")         
            else:
                pass   

            if right == True:
                legend = ax2.legend(bbox_to_anchor=(1, 1), loc=1, borderaxespad=0, facecolor=(0, 0, 0, 0), prop=fontP)
                legend.get_frame().set_alpha(0)
                for text in legend.get_texts():
                    text.set_color("w")
            else:
                pass

    def updtGraph(self, timeDiff):
        global pauseStateFlag, curveNum, getReportInterval
        global dataBuffer, rptCnt, dataBufferForTime, dataBufferSampleCnt
        global colorDict, color, color_0, color_1

        start = default_timer()

        if pauseStateFlag == False and rptCnt !=0:
            
            if rptCnt == 1:
                tmp = [0]
            elif rptCnt * getReportInterval - dataBufferForTime <= 0:
                tmp = [item for item in range(0, rptCnt, 1)]
            else:
                tmp = [item for item in range((rptCnt - 1), (rptCnt - 2 - dataBufferSampleCnt), -1)]
                tmp = list(reversed(tmp))

            x = [item * getReportInterval for item in tmp] 

            plt.close('all')
            for graphIdx in range(2):
                plotIdx = 0
                label_max_left = None
                label_min_left = None
                label_max_right = None
                label_min_right = None
              
                figure_wgt_whole = self.ids['fig_'+str(graphIdx)]  # MatplotFigure
                # self.ids['fig_'+str(graphIdx)].clear_widgets()
                figure_wgt_whole.figure = plt.figure(graphIdx)  ###################


                matplotlib.rc('axes', edgecolor=(1, 1, 1))
                ax1 = plt.subplot()
                ax2 = ax1.twinx()
                ax1.set_title('Graph' + str(graphIdx))
                ax1.set_xlabel('Second', color=(1, 1, 1))

                for curveIdx in range(curveNum):
                    if self.curve_param.curveName[curveIdx] in self.curve_param.curvePos:
                        if 'G' + str(graphIdx) in self.curve_param.curvePos[self.curve_param.curveName[curveIdx]]:
                            if 'L' in self.curve_param.curvePos[self.curve_param.curveName[curveIdx]]:
                                if graphIdx == 0:
                                    if self.curve_param.curveName[curveIdx] in ['壓縮機電流', '風扇電流']:
                                        ax1.plot(x, dataBuffer[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx] + '(abs_AR x 2)' + '(' + self.curve_param.unitName[curveIdx] + ')', color=colorDict[color_0[plotIdx]])
                                    else:
                                        ax1.plot(x, dataBuffer[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx] + '(' + self.curve_param.unitName[curveIdx] + ')', color=colorDict[color_0[plotIdx]])    
                                else:
                                    if self.curve_param.curveName[curveIdx] in ['壓縮機電流', '風扇電流']:
                                        ax1.plot(x, dataBuffer[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx] + '(abs_AR x 2)' + '(' + self.curve_param.unitName[curveIdx] + ')', color=colorDict[color_1[plotIdx]])    
                                    else:
                                        ax1.plot(x, dataBuffer[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx] + '(' + self.curve_param.unitName[curveIdx] + ')', color=colorDict[color_1[plotIdx]])    
                                label_max_left = max(label_max_left, max(dataBuffer[curveIdx][-1 * len(x):])) if label_max_left != None else max(dataBuffer[curveIdx][-1 * len(x):])
                                label_min_left = min(label_min_left, min(dataBuffer[curveIdx][-1 * len(x):])) if label_min_left != None else min(dataBuffer[curveIdx][-1 * len(x):])
                            elif 'R' in self.curve_param.curvePos[self.curve_param.curveName[curveIdx]]:
                                if graphIdx == 0:
                                    if self.curve_param.curveName[curveIdx] in ['壓縮機電流', '風扇電流']:
                                        ax2.plot(x, dataBuffer[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx] + '(abs_AR x 2)' + '(' + self.curve_param.unitName[curveIdx] + ')', color=colorDict[color_0[plotIdx]])    
                                    else:
                                        ax2.plot(x, dataBuffer[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx] + '(' + self.curve_param.unitName[curveIdx] + ')', color=colorDict[color_0[plotIdx]])    
                                else:
                                    if self.curve_param.curveName[curveIdx] in ['壓縮機電流', '風扇電流']:
                                        ax2.plot(x, dataBuffer[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx] + '(abs_AR x 2)' + '(' + self.curve_param.unitName[curveIdx] + ')', color=colorDict[color_1[plotIdx]])    
                                    else:
                                        ax2.plot(x, dataBuffer[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx] + '(' + self.curve_param.unitName[curveIdx] + ')', color=colorDict[color_1[plotIdx]])                           
                                label_max_right = max(label_max_right, max(dataBuffer[curveIdx][-1 * len(x):])) if label_max_right != None else max(dataBuffer[curveIdx][-1 * len(x):])
                                label_min_right = min(label_min_right, min(dataBuffer[curveIdx][-1 * len(x):])) if label_min_right != None else min(dataBuffer[curveIdx][-1 * len(x):])
                            plotIdx = plotIdx + 1
                        else:
                            pass
                    else:
                        pass

                plt.xlim([x[-1] - dataBufferForTime, x[-1]])

                if label_max_left != None and label_min_left != None:
                    diff = label_max_left - label_min_left
                    label_min_left = label_min_left - diff / 20.0
                    label_max_left = label_max_left + diff / 20.0
                    ax1.set_ylim([round(label_min_left, 2), round(label_max_left, 2)])

                    plotLeft = True
                else:
                    plotLeft = False

                if label_max_right != None and label_min_right != None:
                    diff = label_max_right - label_min_right
                    label_min_right = label_min_right - diff / 20.0
                    label_max_right = label_max_right + diff / 20.0
                    ax2.set_ylim([round(label_min_right, 2), round(label_max_right, 2)])
                    
                    plotRight = True
                else:
                    plotRight = False

                if graphIdx == 0:
                    ax1.set_ylim([self.figure_config.figure0.left_min, self.figure_config.figure0.left_max])
                    ax2.set_ylim([self.figure_config.figure0.right_min, self.figure_config.figure0.right_max])
                else:
                    ax1.set_ylim([self.figure_config.figure1.left_min, self.figure_config.figure1.left_max])
                    ax2.set_ylim([self.figure_config.figure1.right_min, self.figure_config.figure1.right_max])                    
                # plotLeft = True
                # plotRight = True
                self.graphSetting(ax1, ax2, figure_wgt_whole.figure, str(graphIdx), plotLeft, plotRight)
                if graphIdx == 0:
                    plt.tight_layout(pad=1.5, h_pad=0, w_pad=0, rect=(-0.05, -0.04, 1.04, 1.02))
                elif graphIdx == 1:
                    plt.tight_layout(pad=1.5, h_pad=0, w_pad=0, rect=(-0.07, -0.04, 1.07, 1.02))
                
        else:
            pass

        print('updt Graph time : {}'.format(default_timer() - start))

    def saveData(self, capData):
        global curveNum

        currentDir = os.path.dirname(os.path.realpath('__file__'))
        rptPath = os.path.join(currentDir, 'Reports\\')

        fp = open(rptPath + 'Report_' + self.UI_system.sysActiveTime + '.txt','a')
        
        for curveIdx in range(curveNum):
            fp.write(str(capData[curveIdx]) + '\t')

        fp.write('\n')
        fp.close()

    def TabbedPanel_choosed(self, val):
        global choosed_Tab

        choosed_Tab = val

    ################## For  Reload ########################
    
    def loadFile(self):

        content = LoadFileDialog(chooseFile=self.chooseFile, cancel=self.dismiss_popup)
        self._popup = Popup(title="Choose File", content=content,
                            size_hint=(0.9, 0.9))
        self._popup.open()

    def dismiss_popup(self):
        self._popup.dismiss()

    def chooseFile(self, path, selection):
        global loadFileFullPath, reload_done_flag\
        
        if len(selection) == 0:
            self.dismiss_popup()
            self.popUp_interactive("Please Select a Valid File")

        else:
            loadFileFullPath = selection[0]    
            self.dismiss_popup()

            reload_done_flag = False
            self.reload_flow()

    def reload_flow(self):
        global reload_done_flag

        self.read_data_from_file()
        self.updt_lbl_spinner()
        self.plotGraph([0, 1])

        reload_done_flag = True

    def read_data_from_file(self):
        global curveNum, loadFileFullPath
        global reload_timeInterval, reload_axis, reload_data, reload_data_len

        reload_axis = []
        reload_data = [[]] * curveNum

        with open(loadFileFullPath, 'r') as fin:
            
            temp = [line.rstrip('\n') for line in fin]

            for idx, item in enumerate(temp):
                if idx == 0:
                    reload_timeInterval = int(float(item.split('\t')[1]))
                elif idx == 1:
                    temp = item.split('\t')
                    for idx0, element in enumerate(temp):
                        if idx0 > 0 and idx0 <= curveNum:
                            # if element != None:
                            #     reload_ch_num = reload_ch_num + 1
                            # else:
                            #     pass                        
                            reload_axis.append(element)
                        else:
                            pass
                elif idx > 3:
                    temp = item.split('\t')
                    for curveIdx, element in enumerate(temp):
                        if curveIdx < curveNum:
                            if reload_axis[curveIdx] != 'N/A':
                                lis = reload_data[curveIdx][:]
                                lis.append(float(element))
                                reload_data[curveIdx] = lis
                            else:
                                lis = reload_data[curveIdx][:]
                                lis.append('N/A')
                                reload_data[curveIdx] = lis                                

        reload_data_len = len(reload_data[0])

    def updt_lbl_spinner(self):
        global reload_axis
        global curveNum, colorDictHex, color_0, color_1

        plotIdx_0 = 0
        plotIdx_1 = 0
        for curveIdx, item in enumerate(reload_axis):
            if item == 'N/A':
                self.ids['reload_lbl_curve_name_' + str(curveIdx)].text = '[color=333333]' + self.curve_param.curveName[curveIdx] + '[/color]'
                self.ids['reload_lbl_enable_' + str(curveIdx)].text = '[color=333333]' + 'OFF' + '[/color]'
                # self.ids['reload_spinner_' + str(curveIdx)].text = 'None'
            elif item == 'None':
                self.ids['reload_lbl_curve_name_' + str(curveIdx)].text = '[color=333333]' + self.curve_param.curveName[curveIdx] + '[/color]'
                self.ids['reload_lbl_enable_' + str(curveIdx)].text = '[color=ffffff]' + 'ON' + '[/color]'
                # self.ids['reload_spinner_' + str(curveIdx)].text = 'None'
            elif 'G0' in item:
                self.ids['reload_lbl_curve_name_' + str(curveIdx)].text = '[color=' + colorDictHex[color_0[plotIdx_0]] + ']' + self.curve_param.curveName[curveIdx] + '[/color]'
                plotIdx_0 = plotIdx_0 + 1
                self.ids['reload_lbl_enable_' + str(curveIdx)].text = '[color=ffffff]' + 'ON' + '[/color]'
                # self.ids['reload_spinner_' + str(curveIdx)].text = item
            elif 'G1' in item:
                self.ids['reload_lbl_curve_name_' + str(curveIdx)].text = '[color=' + colorDictHex[color_1[plotIdx_1]] + ']' + self.curve_param.curveName[curveIdx] + '[/color]'
                plotIdx_1 = plotIdx_1 + 1
                self.ids['reload_lbl_enable_' + str(curveIdx)].text = '[color=ffffff]' + 'ON' + '[/color]'
                # self.ids['reload_spinner_' + str(curveIdx)].text = item
            else:
                assert False

        self.curve_param.reload_spinner_text_last = reload_axis

    def plotGraph(self, graph):
        global curveNum
        global reload_timeInterval, reload_axis, reload_data, reload_data_len
        global colorDict, color_0, color_1

        x = [item * reload_timeInterval for item in range(reload_data_len)]
        
        for graphIdx in graph:
            plotIdx = 0
            label_max_left = None
            label_min_left = None
            label_max_right = None
            label_min_right = None

            plt.close('all')

            self.ids['reload_fig_'+str(graphIdx)].clear_widgets()
            fig = plt.figure()
            matplotlib.rc('axes', edgecolor=(1, 1, 1))
            ax1 = plt.subplot()
            ax2 = ax1.twinx()
            ax1.set_title('Graph' + str(graphIdx))
            ax1.set_xlabel('Second', color=(1, 1, 1))

            for curveIdx in range(curveNum):
                if 'G' + str(graphIdx) in reload_axis[curveIdx]:
                    if 'L' in reload_axis[curveIdx]:
                        if graphIdx == 0:
                            ax1.plot(x, reload_data[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx], color=colorDict[color_0[plotIdx]])                            
                        else:
                            ax1.plot(x, reload_data[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx], color=colorDict[color_1[plotIdx]])                            
                        label_max_left = max(label_max_left, max(reload_data[curveIdx][-1 * len(x):])) if label_max_left != None else max(reload_data[curveIdx][-1 * len(x):])
                        label_min_left = min(label_min_left, min(reload_data[curveIdx][-1 * len(x):])) if label_min_left != None else min(reload_data[curveIdx][-1 * len(x):])
                    elif 'R' in reload_axis[curveIdx]:
                        if graphIdx == 0:
                            ax2.plot(x, reload_data[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx], color=colorDict[color_0[plotIdx]])                            
                        else:
                            ax2.plot(x, reload_data[curveIdx][-1 * len(x):], label=self.curve_param.curveName[curveIdx], color=colorDict[color_1[plotIdx]])  
                        label_max_right = max(label_max_right, max(reload_data[curveIdx][-1 * len(x):])) if label_max_right != None else max(reload_data[curveIdx][-1 * len(x):])
                        label_min_right = min(label_min_right, min(reload_data[curveIdx][-1 * len(x):])) if label_min_right != None else min(reload_data[curveIdx][-1 * len(x):])
                    plotIdx = plotIdx + 1
                else:
                    pass

            plt.xlim([x[0], x[-1]])

            if label_max_left != None and label_min_left != None:
                diff = label_max_left - label_min_left
                label_min_left = label_min_left - diff / 20.0
                label_max_left = label_max_left + diff / 20.0
                ax1.set_ylim([round(label_min_left, 2), round(label_max_left, 2)])

                plotLeft = True
            else:
                plotLeft = False

            if label_max_right != None and label_min_right != None:
                diff = label_max_right - label_min_right
                label_min_right = label_min_right - diff / 20.0
                label_max_right = label_max_right + diff / 20.0
                ax2.set_ylim([round(label_min_right, 2), round(label_max_right, 2)])
                
                plotRight = True
            else:
                plotRight = False

            self.graphSetting(ax1, ax2, fig, str(graphIdx), plotLeft, plotRight)
            plt.tight_layout(pad=1.5, h_pad=0, w_pad=0, rect=(-0.03, -0.04, 1.03, 1.02))
            figure_wgt_whole = self.ids['reload_fig_'+str(graphIdx)]  # MatplotFigure
            figure_wgt_whole.figure = fig           

            self.ids['zoom_in_btn_reload_' + str(graphIdx)].state = 'normal'
            self.ids['move_btn_reload_' + str(graphIdx)].state = 'normal'

    def reload_spinner_text_change(self, curveIdx):
        global color
        global reload_axis, reload_done_flag

        if 'OFF' in self.ids['reload_lbl_enable_' + str(curveIdx)].text:
            self.ids['reload_spinner_' + str(curveIdx)].text = 'None'
        elif 'ON' in self.ids['reload_lbl_enable_' + str(curveIdx)].text:
            if 'G0' in self.ids['reload_spinner_' + str(curveIdx)].text:
                text = 'G0'  
            elif 'G1' in self.ids['reload_spinner_' + str(curveIdx)].text:
                text = 'G1'  
            else:
                text = 'None'
            
            if text != 'None':
                count = 0
                for idx, item in enumerate(self.curve_param.reload_spinner_text_last):
                    if idx == curveIdx:
                        pass
                    else:
                        if text in item:
                            count = count + 1
                        else:
                            pass

                if count > len(color):
                    assert False
                elif count == len(color):
                    self.ids['reload_spinner_' + str(curveIdx)].text = self.curve_param.reload_spinner_text_last[curveIdx]
                else:
                    self.curve_param.reload_spinner_text_last[curveIdx] = self.ids['reload_spinner_' + str(curveIdx)].text
                    reload_axis[curveIdx] = self.ids['reload_spinner_' + str(curveIdx)].text
            else:
                self.curve_param.reload_spinner_text_last[curveIdx] = self.ids['reload_spinner_' + str(curveIdx)].text
                reload_axis[curveIdx] = self.ids['reload_spinner_' + str(curveIdx)].text               
        else:
            assert False

        if reload_done_flag == True:

            plotIdx_0 = 0
            plotIdx_1 = 0
            for curveIdx, item in enumerate(reload_axis):
                if item == 'N/A':
                    self.ids['reload_lbl_curve_name_' + str(curveIdx)].text = '[color=333333]' + self.curve_param.curveName[curveIdx] + '[/color]'
                    self.ids['reload_lbl_enable_' + str(curveIdx)].text = '[color=333333]' + 'OFF' + '[/color]'
                elif item == 'None':
                    self.ids['reload_lbl_curve_name_' + str(curveIdx)].text = '[color=333333]' + self.curve_param.curveName[curveIdx] + '[/color]'
                    self.ids['reload_lbl_enable_' + str(curveIdx)].text = '[color=ffffff]' + 'ON' + '[/color]'
                elif 'G0' in item:
                    self.ids['reload_lbl_curve_name_' + str(curveIdx)].text = '[color=' + colorDictHex[color[plotIdx_0]] + ']' + self.curve_param.curveName[curveIdx] + '[/color]'
                    plotIdx_0 = plotIdx_0 + 1
                    self.ids['reload_lbl_enable_' + str(curveIdx)].text = '[color=ffffff]' + 'ON' + '[/color]'
                elif 'G1' in item:
                    self.ids['reload_lbl_curve_name_' + str(curveIdx)].text = '[color=' + colorDictHex[color[plotIdx_1]] + ']' + self.curve_param.curveName[curveIdx] + '[/color]'
                    plotIdx_1 = plotIdx_1 + 1
                    self.ids['reload_lbl_enable_' + str(curveIdx)].text = '[color=ffffff]' + 'ON' + '[/color]'
                else:
                    assert False     
                       
            self.plotGraph([0, 1])
        else:
            pass

    def enviroment_temp_setting(self):

        client= ModbusClient(method = "rtu", port="COM13",stopbits = 1, bytesize = 8, parity = 'E', baudrate= 19200, timeout= 1)

        #Connect to the serial modbus server
        client.connect()   
        # print(connection)     

        client.write_register(address= 0x9C4, value= int(float(self.ids['environment_indoor_dry'].text) * 100), unit= 1 + 2 * (int(self.ids['indoor_system'].text) - 1))
        client.write_register(address= 0x9C4, value= int(float(self.ids['environment_indoor_wet'].text) * 100), unit= 1 + 2 * (int(self.ids['indoor_system'].text) - 1) + 1)

        client.write_register(address= 0x9C4, value= int(float(self.ids['environment_outdoor_dry'].text) * 100), unit= 9 + 2 * (int(self.ids['outdoor_system'].text) - 1))
        client.write_register(address= 0x9C4, value= int(float(self.ids['environment_outdoor_wet'].text) * 100), unit= 9 + 2 * (int(self.ids['outdoor_system'].text) - 1) + 1)

        client.close()

    ################## For read-save Cfg Setting ########################

    def screen_setting_change(self):
        
        if self.ids['full_screen'].text == 'True':
            width = 1920
            height = 1080
            Window.fullscreen = True
            Window.size = width, height
        elif self.ids['full_screen'].text == 'False':
            width = self.ids['resolution'].text.split('*')[0]
            height = self.ids['resolution'].text.split('*')[1]
            Window.fullscreen = False
            Window.left, Window.top = 0, 30
            Window.size = int(width), int(height)

    def graph_enable_change(self):
        global sysActiveFlag, getReportInterval

        if sysActiveFlag == True:
            if self.ids['graph_enable'].text == 'True':
                Clock.schedule_interval(self.updtGraph, getReportInterval)
            elif self.ids['graph_enable'].text == 'False':
                Clock.unschedule(self.updtGraph)
            else:
                assert False
        else:
            pass

    def load_default_setting(self):
        
        try:
            fp = open('.//Config//UI_default_setting.txt','r')
        except:
            fp = open('C://Users//Eddie//verificationPlatform//EER//Config//UI_default_setting.txt','r')
        for idx, line in enumerate(fp.readlines()):
            element = line.split()
            
            if 'spray_head' in element[0]:
                if element[1] == 'True':
                    self.setting_id.default_setting.append(True)
                elif element[1] == 'False':
                    self.setting_id.default_setting.append(False)
                else:
                    assert False
            else:
                self.setting_id.default_setting.append(element[1])

    def loadExpCfg(self):

        content = LoadExpCfgDialog(chooseExpCfg=self.chooseExpCfg, cancel=self.dismiss_popup)
        self._popup = Popup(title="Choose Cfg", content=content,
                            size_hint=(0.9, 0.9))
        self._popup.open()

    def loadTempCfg(self):

        content = LoadTempCfgDialog(chooseTempCfg=self.chooseTempCfg, cancel=self.dismiss_popup)
        self._popup = Popup(title="Choose Cfg", content=content,
                            size_hint=(0.9, 0.9))
        self._popup.open()

    def loadScriptCfg(self):

        content = LoadScriptCfgDialog(chooseScriptCfg=self.chooseScriptCfg, cancel=self.dismiss_popup)
        self._popup = Popup(title="Choose Cfg", content=content,
                            size_hint=(0.9, 0.9))
        self._popup.open()

    def loadEnvCfg(self):

        content = LoadEnvCfgDialog(chooseEnvCfg=self.chooseEnvCfg, cancel=self.dismiss_popup)
        self._popup = Popup(title="Choose Cfg", content=content,
                            size_hint=(0.9, 0.9))
        self._popup.open()

    def loadtos5200Cfg(self):

        content = Loadtos5200CfgDialog(choosetos5200Cfg=self.choosetos5200Cfg, cancel=self.dismiss_popup)
        self._popup = Popup(title="Choose Cfg", content=content,
                            size_hint=(0.9, 0.9))
        self._popup.open()

    def chooseExpCfg(self, path, selection):

        if len(selection) == 0:
            self.dismiss_popup()
            self.popUp_interactive("Please Select a Valid File")     
        else:       
            self.dismiss_popup()

            fp = open(selection[0],'r')
            
            for line in fp.readlines():
                element = line.split()
                
                self.ids[element[0]].text = element[1]

    def chooseTempCfg(self, path, selection):

        if len(selection) == 0:
            self.dismiss_popup()
            self.popUp_interactive("Please Select a Valid File")     
        else:
            self.dismiss_popup()

            fp = open(selection[0],'r')
            
            for line in fp.readlines():
                element = line.split()
                
                self.ids[element[0]].text = element[1]

    def chooseScriptCfg(self, path, selection):

        if len(selection) == 0:
            self.dismiss_popup()
            self.popUp_interactive("Please Select a Valid File")       
        else:
            self.dismiss_popup()

            fp = open(selection[0],'r')
            
            self.log_content.script_content_raw = fp.read()
            self.ids['lbl_script'].text = self.log_content.script_content_raw.replace('\t', '    ')

    def chooseEnvCfg(self, path, selection):

        if len(selection) == 0:
            self.dismiss_popup()
            self.popUp_interactive("Please Select a Valid File")
        else:     
            self.dismiss_popup()

            fp = open(selection[0],'r')
            
            for line in fp.readlines():
                element = line.split()
                
                self.ids[element[0]].text = element[1]

    def choosetos5200Cfg(self, path, selection):

        if len(selection) == 0:
            self.dismiss_popup()
            self.popUp_interactive("Please Select a Valid File")
        else:
            self.dismiss_popup()

            fp = open(selection[0],'r')
            
            for line in fp.readlines():
                element = line.split()

                if hasattr(self.ids[element[0]], 'active'): 
                    if element[1] == 'True':
                        self.ids[element[0]].active = True
                    elif element[1] == 'False':
                        self.ids[element[0]].active = False
                    else:
                        print(element)
                        assert False
                else:
                    self.ids[element[0]].text = element[1]               

    def experiment_setting_cfg_name(self):
        self.ids['experiment_setting_save_cfg'].text = self.ids['test_name'].text

    def save_experiment_setting_cfg(self):

        currentDir = os.path.dirname(os.path.realpath('__file__'))
        cfgPath = os.path.join(currentDir, 'Config\\Experiment\\')

        if not os.path.exists(cfgPath):
            os.makedirs(cfgPath)

        fp = open(cfgPath + self.ids['experiment_setting_save_cfg'].text + '.txt','w')

        for item in self.setting_id.experiment_setting_id:
            fp.write(item + '\t' + self.ids[item].text + '\n')
        
        self.popUp_interactive('\'' + self.ids['experiment_setting_save_cfg'].text + '.txt\' Saved Successfully')


    def save_temperature_line_setting_cfg(self):

        currentDir = os.path.dirname(os.path.realpath('__file__'))
        cfgPath = os.path.join(currentDir, 'Config\\Temp_line\\')

        if not os.path.exists(cfgPath):
            os.makedirs(cfgPath)

        fp = open(cfgPath + self.ids['temperature_line_setting_save_cfg'].text + '.txt','w')

        for item in self.setting_id.temperature_line_setting_id:
            fp.write(item + '\t' + self.ids[item].text + '\n')     

        self.popUp_interactive('\'' + self.ids['temperature_line_setting_save_cfg'].text + '.txt\' Saved Successfully')

    def save_environment_setting_cfg(self):

        currentDir = os.path.dirname(os.path.realpath('__file__'))
        cfgPath = os.path.join(currentDir, 'Config\\Environment\\')

        if not os.path.exists(cfgPath):
            os.makedirs(cfgPath)

        fp = open(cfgPath + self.ids['environment_setting_name'].text + '.txt','w')

        for item in self.setting_id.environment_setting_id:
            fp.write(item + '\t' + self.ids[item].text + '\n')

        fp.close()        

        self.popUp_interactive('\'' + self.ids['environment_setting_name'].text + '.txt\' Saved Successfully')

    def save_tos5200_setting_cfg(self):

        currentDir = os.path.dirname(os.path.realpath('__file__'))
        cfgPath = os.path.join(currentDir, 'Config\\TOS5200\\')

        if not os.path.exists(cfgPath):
            os.makedirs(cfgPath)

        fp = open(cfgPath + self.ids['tos5200_setting_save_cfg'].text + '.txt','w')

        for item in self.setting_id.tos5200_setting_id:
            if hasattr(self.ids[item], 'active'): 
                fp.write(item + '\t' + str(self.ids[item].active) + '\n')   
            else:
                fp.write(item + '\t' + self.ids[item].text + '\n')                  

        self.popUp_interactive('\'' + self.ids['tos5200_setting_save_cfg'].text + '.txt\' Saved Successfully')

    def save_NF_setting_cfg(self):

        currentDir = os.path.dirname(os.path.realpath('__file__'))
        cfgPath = os.path.join(currentDir, 'Config\\NF\\')

        if not os.path.exists(cfgPath):
            os.makedirs(cfgPath)

        fp = open(cfgPath + self.ids['NF_setting_save_cfg'].text + '.txt','w')

        for item in self.setting_id.NF_setting_id:
            if hasattr(self.ids[item], 'active'): 
                fp.write(item + '\t' + str(self.ids[item].active) + '\n')   
            else:
                fp.write(item + '\t' + self.ids[item].text + '\n')      

        self.popUp_interactive('\'' + self.ids['NF_setting_save_cfg'].text + '.txt\' Saved Successfully')

    def save_UI_setting_cfg(self):

        currentDir = os.path.dirname(os.path.realpath('__file__'))
        cfgPath = os.path.join(currentDir, 'Config\\')

        if not os.path.exists(cfgPath):
            os.makedirs(cfgPath)

        fp = open(cfgPath + 'UI_default_setting.txt','w')

        for item in self.setting_id.UI_setting_id:
            if 'spray_head' in item:
                fp.write(item + '\t' + str(self.ids[item].active) + '\n')
            else:
                fp.write(item + '\t' + self.ids[item].text + '\n')

        fp.close()        

        self.popUp_interactive('\'' + 'UI_default_setting.txt\' Saved Successfully')

    def btn_modify_textinput_temp(self, identity, step):
        self.ids[identity].text = str("{0:.2f}".format(round(float(self.ids[identity].text) + step, 2)))

    def btn_modify_textinput_temp_bias(self, identity, step):
        self.ids[identity].text = str("{0:.2f}".format(round(float(self.ids[identity].text) + step, 2)))

################ for power supply config ######################

    def tos5200_start_thread(self):

        test_round = 0

        while test_round < int(self.ids['tos5200_test_round'].text):
            if self.UI_system.remoteMode == False:
                self.instrument_config.tos5200.DEV.write('TEST:EXEC')

                if self.ids['tos5200_panel_test_time'].text == 'None':
                    break
                
                time.sleep(float(self.ids['tos5200_panel_test_time'].text) + float(self.ids['tos5200_panel_voltage_rise_time'].text) + 1)

                response = self.instrument_config.tos5200.DEV.query('RES?')[:-1]

                test_round = test_round + 1
                self.ids['tos5200_rpt_test_round'].text = str(test_round)

                voltage = response.split(',')[9]
                self.ids['tos5200_rpt_voltage'].text = str("{0:.2f}".format(float(voltage.split('E')[0]) * 10**int(voltage.split('E')[1])))

                current = response.split(',')[10]
                self.ids['tos5200_rpt_current'].text = str("{0:.2f}".format(float(current.split('E')[0]) * 10**int(current.split('E')[1]) * 1000))

                elasped_time = response.split(',')[12]
                self.ids['tos5200_rpt_test_time'].text = str("{0:.1f}".format(float(elasped_time.split('E')[0]) * 10**int(elasped_time.split('E')[1])))

                self.ids['tos5200_rpt_test_result'].text = response.split(',')[13]

                if self.ids['tos5200_rpt_test_result'].text not in ['PASS', 'ABORT']:
                    self.tos5200_stop()

                time.sleep(float(self.ids['tos5200_stop_duration'].text))

            else: # self.UI_system.remoteMode = True

                self.remote_mode_create_socket(None)

                try:
                    self.sever_PC.mySocket.send('TOS5200 Start'.encode('utf-8'))  
                except ConnectionResetError:
                    self.sever_PC.mySocket.close()
                    self.remote_mode_create_socket('TOS5200 Start')                            

                resp, response = self.recv_data_from_sever()     
            
                if resp == 'done':
                    pass
                else:
                    print(resp)
                    assert False                

                if self.ids['tos5200_panel_test_time'].text == 'None':
                    break

                time.sleep(float(self.ids['tos5200_panel_test_time'].text) + float(self.ids['tos5200_panel_voltage_rise_time'].text) + 1)

                try:
                    self.sever_PC.mySocket.send('TOS5200 Get'.encode('utf-8'))  
                except ConnectionResetError:
                    self.sever_PC.mySocket.close()
                    self.remote_mode_create_socket('TOS5200 Get')                              

                resp, response = self.recv_data_from_sever()  
                   
                test_round = test_round + 1
                self.ids['tos5200_rpt_test_round'].text = str(test_round)
                self.ids['tos5200_rpt_voltage'].text = response[0]
                self.ids['tos5200_rpt_current'].text = response[1]
                self.ids['tos5200_rpt_test_time'].text = response[2]
                self.ids['tos5200_rpt_test_result'].text = response[3]

                if self.ids['tos5200_rpt_test_result'].text not in ['PASS', 'ABORT']:
                    self.tos5200_stop()

                time.sleep(float(self.ids['tos5200_stop_duration'].text))             

            if self.instrument_config.tos5200.abort_flag == True:
                self.instrument_config.tos5200.abort_flag = False
                break

    def tos5200_start(self):

        self.tos5200_config_refresh()

        tos5200_thread = threading.Thread(target=self.tos5200_start_thread, daemon= True)
        tos5200_thread.start()
        
    def tos5200_stop(self):

        if self.UI_system.remoteMode == False:
            if self.instrument_config.tos5200.DEV == None:
                self.instrument_config.tos5200.DEV = self.instrument_config.rm.open_resource(self.instrument_config.tos5200_name, read_termination ='\n')
                self.instrument_config.tos5200.baudrate = self.instrument_config.tos5200.baudrate
            else:
                pass

            self.instrument_config.tos5200.abort_flag = True
            self.instrument_config.tos5200.DEV.write('TEST:ABOR')
        else: # self.UI_system.remoteMode == True
            
            self.instrument_config.tos5200.abort_flag = True
            self.remote_mode_create_socket(None)

            try:
                self.sever_PC.mySocket.send('TOS5200 Stop'.encode('utf-8'))  
            except ConnectionResetError:
                self.sever_PC.mySocket.close()
                self.remote_mode_create_socket('TOS5200 Stop')                          

            resp, response = self.recv_data_from_sever()      
        
            if resp == 'done':
                pass
            else:
                print(resp)
                assert False
            
    def tos5200_config_refresh(self):

        if self.UI_system.remoteMode == False:
            if self.instrument_config.tos5200.DEV == None:
                self.instrument_config.tos5200.DEV = self.instrument_config.rm.open_resource(self.instrument_config.tos5200.port, read_termination ='\n')
                self.instrument_config.tos5200.baudrate = self.instrument_config.tos5200.baudrate
            else:
                pass

            self.ids['tos5200_panel_frequency'].text = self.instrument_config.tos5200.DEV.query('SOUR:VOLT:FREQ?')[:-1]

            response = self.instrument_config.tos5200.DEV.query('SOUR:VOLT?')[:-1]
            self.ids['tos5200_panel_voltage_test'].text = str("{0:.0f}".format(float(response.split('E')[0]) * 10**int(response.split('E')[1])))

            response = self.instrument_config.tos5200.DEV.query('SOUR:VOLT:PROT?')[:-1]
            self.ids['tos5200_panel_voltage_limit'].text = str("{0:.0f}".format(float(response.split('E')[0]) * 10**int(response.split('E')[1])))

            response = self.instrument_config.tos5200.DEV.query('SENS:JUDG?')[:-1]
            self.ids['tos5200_panel_current_limit_upper'].text = str("{0:.2f}".format(float(response.split('E')[0]) * 10**int(response.split('E')[1]) * 1000))

            response = self.instrument_config.tos5200.DEV.query('SENS:JUDG:LOW:STAT?')[:-1]
            if response == '0':
                self.ids['tos5200_panel_current_limit_lower'].text = 'None'
            else:
                response = self.instrument_config.tos5200.DEV.query('SENS:JUDG:LOW?')[:-1]
                self.ids['tos5200_panel_current_limit_lower'].text = str("{0:.2f}".format(float(response.split('E')[0]) * 10**int(response.split('E')[1]) * 1000))

            response = self.instrument_config.tos5200.DEV.query('SOUR:VOLT:TIM:STAT?')[:-1]
            if response == '0':
                self.ids['tos5200_panel_test_time'].text = 'None'
            else:
                response = self.instrument_config.tos5200.DEV.query('SOUR:VOLT:TIM?')[:-1]
                self.ids['tos5200_panel_test_time'].text = str("{0:.1f}".format(float(response.split('E')[0]) * 10**int(response.split('E')[1])))

            response = self.instrument_config.tos5200.DEV.query('SOUR:VOLT:SWE:TIM?')[:-1]
            self.ids['tos5200_panel_voltage_rise_time'].text = str("{0:.1f}".format(float(response.split('E')[0]) * 10**int(response.split('E')[1])))
            
            response = self.instrument_config.tos5200.DEV.query('SOUR:VOLT:SWE:FALL:TIM:STAT?')[:-1]
            if response == '0':
                self.ids['tos5200_panel_voltage_fall_time'].text = 'Disabled'
            else:
                self.ids['tos5200_panel_voltage_fall_time'].text = 'Enabled'

            response = self.instrument_config.tos5200.DEV.query('SOUR:VOLT:STAR:STAT?')[:-1]
            if response == '0':
                self.ids['tos5200_panel_start_voltage'].text = 'Disabled'
            else:
                self.ids['tos5200_panel_start_voltage'].text = 'Enabled'

            self.ids['tos5200_panel_meas_mode'].text = self.instrument_config.tos5200.DEV.query('SENS:MODE?')[:-1]
        else: # self.UI_system.remoteMode = True

            self.remote_mode_create_socket(None)

            try:
                self.sever_PC.mySocket.send('TOS5200 Refresh'.encode('utf-8'))  
            except ConnectionResetError:
                self.sever_PC.mySocket.close()
                self.remote_mode_create_socket('TOS5200 Refresh')                            

            resp, response = self.recv_data_from_sever()    

            self.ids['tos5200_panel_frequency'].text = response[0]
            self.ids['tos5200_panel_voltage_test'].text = response[1]
            self.ids['tos5200_panel_voltage_limit'].text = response[2]
            self.ids['tos5200_panel_current_limit_upper'].text = response[3]
            self.ids['tos5200_panel_current_limit_lower'].text = response[4]
            self.ids['tos5200_panel_test_time'].text = response[5]
            self.ids['tos5200_panel_voltage_rise_time'].text = response[6]
            self.ids['tos5200_panel_voltage_fall_time'].text = response[7]
            self.ids['tos5200_panel_start_voltage'].text = response[8]
            self.ids['tos5200_panel_meas_mode'].text = response[9]

    def tos5200_config_set(self):

        if self.UI_system.remoteMode == False:
            if self.instrument_config.tos5200.DEV == None:
                self.instrument_config.tos5200.DEV = self.instrument_config.rm.open_resource(self.instrument_config.tos5200.port, read_termination ='\n')
                self.instrument_config.tos5200.baudrate = self.instrument_config.tos5200.baudrate
            else:
                pass

            if self.ids['tos5200_config_frequency'].text == '50':
                self.instrument_config.tos5200.DEV.write('SOUR:VOLT:FREQ 50')
            elif self.ids['tos5200_config_frequency'].text == '60':
                self.instrument_config.tos5200.DEV.write('SOUR:VOLT:FREQ 60')
            else:
                assert False

            if float(self.ids['tos5200_config_voltage_test'].text) < 0:
                self.ids['tos5200_config_voltage_test'].text = '0'
            elif float(self.ids['tos5200_config_voltage_test'].text) > 5500:
                self.ids['tos5200_config_voltage_test'].text = '5500'
            else:
                pass

            if float(self.ids['tos5200_config_voltage_limit'].text) < float(self.ids['tos5200_config_voltage_test'].text):
                self.ids['tos5200_config_voltage_limit'].text = self.ids['tos5200_config_voltage_test'].text
            elif float(self.ids['tos5200_config_voltage_limit'].text) > 5500:
                self.ids['tos5200_config_voltage_limit'].text = '5500'
            else:
                pass
            self.instrument_config.tos5200.DEV.write('SOUR:VOLT:PROT ' + self.ids['tos5200_config_voltage_limit'].text)
            self.instrument_config.tos5200.DEV.write('SOUR:VOLT ' + self.ids['tos5200_config_voltage_test'].text)

            if float(self.ids['tos5200_config_current_limit_upper'].text) < 0.01:
                self.ids['tos5200_config_current_limit_upper'].text = '0.01'
            elif float(self.ids['tos5200_config_current_limit_upper'].text) > 110:
                self.ids['tos5200_config_current_limit_upper'].text = '110'
            else:
                pass
            self.instrument_config.tos5200.DEV.write('SENS:JUDG ' + str(float(self.ids['tos5200_config_current_limit_upper'].text) / 1000))

            if self.ids['tos5200_config_current_limit_lower_active'].active == True:
                self.instrument_config.tos5200.DEV.write('SENS:JUDG:LOW:STAT ON')
                if float(self.ids['tos5200_config_current_limit_lower'].text) < 0.01:
                    self.ids['tos5200_config_current_limit_lower'].text = '0.01'
                elif float(self.ids['tos5200_config_current_limit_lower'].text) > float(self.ids['tos5200_config_current_limit_upper'].text):
                    self.ids['tos5200_config_current_limit_lower'].text = str(float(self.ids['tos5200_config_current_limit_upper'].text) - 1)
                else:
                    pass            
                self.instrument_config.tos5200.DEV.write('SENS:JUDG:LOW ' + str(float(self.ids['tos5200_config_current_limit_lower'].text) / 1000))
            elif self.ids['tos5200_config_current_limit_lower_active'].active == False:
                self.instrument_config.tos5200.DEV.write('SENS:JUDG:LOW:STAT OFF')
            else:
                assert False

            if self.ids['tos5200_config_test_time_active'].active == True:
                self.instrument_config.tos5200.DEV.write('SOUR:VOLT:TIM:STAT ON')
                if float(self.ids['tos5200_config_test_time'].text) < 0.1:
                    self.ids['tos5200_config_test_time'].text = '0.1'
                elif float(self.ids['tos5200_config_test_time'].text) > 999:
                    self.ids['tos5200_config_test_time'].text = '999'
                else:
                    pass            
                self.instrument_config.tos5200.DEV.write('SOUR:VOLT:TIM ' + self.ids['tos5200_config_test_time'].text)
            elif self.ids['tos5200_config_test_time_active'].active == False:
                self.instrument_config.tos5200.DEV.write('SOUR:VOLT:TIM:STAT OFF')
            else:
                assert False

            if float(self.ids['tos5200_config_voltage_rise_time'].text) < 0.1:
                self.ids['tos5200_config_voltage_rise_time'].text = '0.1'
            elif float(self.ids['tos5200_config_voltage_rise_time'].text) > 10:
                self.ids['tos5200_config_voltage_rise_time'].text = '10'
            else:
                pass   
            self.instrument_config.tos5200.DEV.write('SOUR:VOLT:SWE:TIM ' + self.ids['tos5200_config_voltage_rise_time'].text)
            
            if self.ids['tos5200_config_voltage_fall_time'].text == 'Enabled':
                self.instrument_config.tos5200.DEV.write('SOUR:VOLT:SWE:FALL:TIM:STAT ON')
            elif self.ids['tos5200_config_voltage_fall_time'].text == 'Disabled':
                self.instrument_config.tos5200.DEV.write('SOUR:VOLT:SWE:FALL:TIM:STAT OFF')
            else:
                assert False

            if self.ids['tos5200_config_start_voltage'].text == 'Enabled':
                self.instrument_config.tos5200.DEV.write('SOUR:VOLT:STAR:STAT ON')
            elif self.ids['tos5200_config_start_voltage'].text == 'Disabled':
                self.instrument_config.tos5200.DEV.write('SOUR:VOLT:STAR:STAT OFF')
            else:
                assert False

            self.instrument_config.tos5200.DEV.write('SENS:MODE ' + self.ids['tos5200_config_meas_mode'].text)

        else: # self.UI_system.remoteMode == True

            if self.ids['tos5200_config_frequency'].text == '50':
                pass
            elif self.ids['tos5200_config_frequency'].text == '60':
                pass
            else:
                assert False

            if float(self.ids['tos5200_config_voltage_test'].text) < 0:
                self.ids['tos5200_config_voltage_test'].text = '0'
            elif float(self.ids['tos5200_config_voltage_test'].text) > 5500:
                self.ids['tos5200_config_voltage_test'].text = '5500'
            else:
                pass

            if float(self.ids['tos5200_config_voltage_limit'].text) < float(self.ids['tos5200_config_voltage_test'].text):
                self.ids['tos5200_config_voltage_limit'].text = self.ids['tos5200_config_voltage_test'].text
            elif float(self.ids['tos5200_config_voltage_limit'].text) > 5500:
                self.ids['tos5200_config_voltage_limit'].text = '5500'
            else:
                pass

            if float(self.ids['tos5200_config_current_limit_upper'].text) < 0.01:
                self.ids['tos5200_config_current_limit_upper'].text = '0.01'
            elif float(self.ids['tos5200_config_current_limit_upper'].text) > 110:
                self.ids['tos5200_config_current_limit_upper'].text = '110'
            else:
                pass

            if self.ids['tos5200_config_current_limit_lower_active'].active == True:
                if float(self.ids['tos5200_config_current_limit_lower'].text) < 0.01:
                    self.ids['tos5200_config_current_limit_lower'].text = '0.01'
                elif float(self.ids['tos5200_config_current_limit_lower'].text) > float(self.ids['tos5200_config_current_limit_upper'].text):
                    self.ids['tos5200_config_current_limit_lower'].text = str(float(self.ids['tos5200_config_current_limit_upper'].text) - 1)
                else:
                    pass            
            elif self.ids['tos5200_config_current_limit_lower_active'].active == False:
                pass
            else:
                assert False

            if self.ids['tos5200_config_test_time_active'].active == True:
                if float(self.ids['tos5200_config_test_time'].text) < 0.1:
                    self.ids['tos5200_config_test_time'].text = '0.1'
                elif float(self.ids['tos5200_config_test_time'].text) > 999:
                    self.ids['tos5200_config_test_time'].text = '999'
                else:
                    pass            
            elif self.ids['tos5200_config_test_time_active'].active == False:
                pass
            else:
                assert False

            if float(self.ids['tos5200_config_voltage_rise_time'].text) < 0.1:
                self.ids['tos5200_config_voltage_rise_time'].text = '0.1'
            elif float(self.ids['tos5200_config_voltage_rise_time'].text) > 10:
                self.ids['tos5200_config_voltage_rise_time'].text = '10'
            else:
                pass               
            
            if self.ids['tos5200_config_voltage_fall_time'].text == 'Enabled':
                pass
            elif self.ids['tos5200_config_voltage_fall_time'].text == 'Disabled':
                pass
            else:
                assert False

            if self.ids['tos5200_config_start_voltage'].text == 'Enabled':
                pass
            elif self.ids['tos5200_config_start_voltage'].text == 'Disabled':
                pass
            else:
                assert False

            self.remote_mode_create_socket(None)

            send_data = self.ids['tos5200_config_frequency'].text + ' ' + self.ids['tos5200_config_voltage_test'].text + ' ' + self.ids['tos5200_config_voltage_limit'].text + ' ' + self.ids['tos5200_config_current_limit_upper'].text + ' ' + \
                        str(self.ids['tos5200_config_current_limit_lower_active'].active) + ' ' + self.ids['tos5200_config_current_limit_lower'].text + ' ' + str(self.ids['tos5200_config_test_time_active'].active) + ' ' + self.ids['tos5200_config_test_time'].text + ' ' + \
                        self.ids['tos5200_config_voltage_rise_time'].text + ' ' + self.ids['tos5200_config_voltage_fall_time'].text + ' ' + self.ids['tos5200_config_start_voltage'].text + ' ' + self.ids['tos5200_config_meas_mode'].text

            try:
                self.sever_PC.mySocket.send(('TOS5200 Set ' + send_data).encode('utf-8'))  
            except ConnectionResetError:
                self.sever_PC.mySocket.close()
                self.remote_mode_create_socket('TOS5200 Set' + send_data)                             

            resp, response = self.recv_data_from_sever()    

            if resp == 'done':
                pass
            else:
                print(resp)
                assert False

        self.tos5200_config_refresh()

    def NF_task(self, timeDiff):

        start = default_timer()

        thread_NF_get_report = threading.Thread(target=self.NF_getReport, args=(timeDiff,))
        thread_NF_get_report.start()    

        print('NF get report time : {}'.format(default_timer() - start))

    def NF_wait(self):
        
        while self.instrument_config.NF.DEV.query('*OPC?') != '1':
            print('waiting for system done')

    def NF_sequence_resume(self):
        self.instrument_config.NF.DEV.write('TRIG:SEQ:SEL:EXEC STAR')
        self.NF_wait()

    def NF_start(self):

        Clock.unschedule(self.NF_task)

        if self.UI_system.remoteMode == False:
            if self.instrument_config.NF.DEV == None:
                self.instrument_config.NF.DEV = self.instrument_config.rm.open_resource(self.instrument_config.NF.port, read_termination ='\n')
            else:
                pass

            self.instrument_config.NF.DEV.write('OUTP 0')
            self.NF_wait()

            state = self.instrument_config.NF.DEV.query('SEQ:CONT?')
            self.NF_wait()
            if state == 'CONTROL':
                self.instrument_config.NF.DEV.write('SEQ:EDIT')
            elif state == 'EDIT':
                pass
            else:
                assert False

            state = self.instrument_config.NF.DEV.query('SIM:CONT?')
            self.NF_wait()
            if state == 'CONTROL':
                self.instrument_config.NF.DEV.write('SIM:EDIT')
            elif state == 'EDIT':
                pass
            else:
                assert False

            self.instrument_config.NF.DEV.write('*RST')
            self.NF_wait()

            self.instrument_config.NF.mode = self.ids['NF'].current_tab.text

            if self.instrument_config.NF.mode == 'Continuous':

                self.instrument_config.NF.DEV.write('SYST:CONF CONT')
                self.NF_wait()

                if self.ids['NF_Continuous_Mode'].text == 'AC':
                    self.instrument_config.NF.DEV.write('MODE AC_INT')
                elif self.ids['NF_Continuous_Mode'].text == 'ACDC':
                    self.instrument_config.NF.DEV.write('MODE ACDC_INT')
                else:
                    assert False

                self.NF_wait()

                if float(self.ids['NF_Continuous_AC_Voltage'].text) < 0:
                    self.ids['NF_Continuous_AC_Voltage'].text = '0'
                elif float(self.ids['NF_Continuous_AC_Voltage'].text) > 310:
                    self.ids['NF_Continuous_AC_Voltage'].text = '310'

                if float(self.ids['NF_Continuous_AC_Voltage'].text) > 155:
                    self.instrument_config.NF.DEV.write('VOLT:RANG R200V')
                    self.NF_wait()
                    self.instrument_config.NF.DEV.write('VOLT ' + self.ids['NF_Continuous_AC_Voltage'].text)
                    self.NF_wait()

                    if float(self.ids['NF_Continuous_Vrms_Limiter'].text) < float(self.ids['NF_Continuous_AC_Voltage'].text):
                        self.ids['NF_Continuous_Vrms_Limiter'].text = self.ids['NF_Continuous_AC_Voltage'].text
                    elif float(self.ids['NF_Continuous_Vrms_Limiter'].text) > 310:
                        self.ids['NF_Continuous_Vrms_Limiter'].text = '310'             

                    self.instrument_config.NF.DEV.write('VOLT:LIM:RMS ' + self.ids['NF_Continuous_Vrms_Limiter'].text)     
                else:
                    self.instrument_config.NF.DEV.write('VOLT:RANG R100V')
                    self.NF_wait()
                    self.instrument_config.NF.DEV.write('VOLT ' + self.ids['NF_Continuous_AC_Voltage'].text)
                    self.NF_wait()

                    if float(self.ids['NF_Continuous_Vrms_Limiter'].text) < float(self.ids['NF_Continuous_AC_Voltage'].text):
                        self.ids['NF_Continuous_Vrms_Limiter'].text = self.ids['NF_Continuous_AC_Voltage'].text
                    elif float(self.ids['NF_Continuous_Vrms_Limiter'].text) > 155:
                        self.ids['NF_Continuous_Vrms_Limiter'].text = '155'  

                    self.instrument_config.NF.DEV.write('VOLT:LIM:RMS ' + self.ids['NF_Continuous_Vrms_Limiter'].text)
                self.NF_wait()

                if self.ids['NF_Continuous_Mode'].text == 'AC':
                    pass
                elif self.ids['NF_Continuous_Mode'].text == 'ACDC':
                    self.instrument_config.NF.DEV.write('VOLT:OFFS ' + self.ids['NF_Continuous_DC_Voltage'].text)
                else:
                    assert False
                self.NF_wait()

                if float(self.ids['NF_Continuous_Frequency'].text) < 40:
                    self.ids['NF_Continuous_Frequency'].text = '40'
                elif float(self.ids['NF_Continuous_Frequency'].text) > 550:
                    self.ids['NF_Continuous_Frequency'].text = '550'

                self.instrument_config.NF.DEV.write('FREQ ' + self.ids['NF_Continuous_Frequency'].text)
                self.NF_wait()
                if float(self.ids['NF_Continuous_Freq_Limiter_Low'].text) > float(self.ids['NF_Continuous_Frequency'].text):
                    self.ids['NF_Continuous_Freq_Limiter_Low'].text = self.ids['NF_Continuous_Frequency'].text
                self.instrument_config.NF.DEV.write('FREQ:LIM:LOW ' + self.ids['NF_Continuous_Freq_Limiter_Low'].text)
                self.NF_wait()

                if float(self.ids['NF_Continuous_Freq_Limiter_High'].text) < float(self.ids['NF_Continuous_Frequency'].text):
                    self.ids['NF_Continuous_Freq_Limiter_High'].text = self.ids['NF_Continuous_Frequency'].text
                self.instrument_config.NF.DEV.write('FREQ:LIM:HIGH ' + self.ids['NF_Continuous_Freq_Limiter_High'].text)
                self.NF_wait()

                if self.ids['NF_Continuous_Current_Peak_Limiter_Checkbox'].active == True:
                    self.instrument_config.NF.DEV.write('CURR:LIM:PEAK:MODE OFF')
                elif self.ids['NF_Continuous_Current_Peak_Limiter_Checkbox'].active == False:
                    self.instrument_config.NF.DEV.write('CURR:LIM:PEAK:MODE CONT')
                self.NF_wait()

                if self.ids['NF_Continuous_Current_rms_Limiter_Checkbox'].active == True:
                    self.instrument_config.NF.DEV.write('CURR:LIM:RMS:MODE OFF')
                elif self.ids['NF_Continuous_Current_rms_Limiter_Checkbox'].active == False:
                    self.instrument_config.NF.DEV.write('CURR:LIM:RMS:MODE CONT')
                self.NF_wait()

                if float(self.ids['NF_Continuous_AC_Voltage'].text) > 155:
                    self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text = '63' if float(self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text) > 63 else self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text
                    self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text = '-63' if float(self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text) < -63 else self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text
                    self.ids['NF_Continuous_Current_rms_Limiter'].text = '15.8' if float(self.ids['NF_Continuous_Current_rms_Limiter'].text) > 15.8 else self.ids['NF_Continuous_Current_rms_Limiter'].text
                else:
                    self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text = '126' if float(self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text) > 126 else self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text
                    self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text = '-126' if float(self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text) < -126 else self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text                
                    self.ids['NF_Continuous_Current_rms_Limiter'].text = '31.5' if float(self.ids['NF_Continuous_Current_rms_Limiter'].text) > 31.5 else self.ids['NF_Continuous_Current_rms_Limiter'].text

                self.instrument_config.NF.DEV.write('CURR:LIM:RMS ' + self.ids['NF_Continuous_Current_rms_Limiter'].text)
                self.NF_wait()

                self.instrument_config.NF.DEV.write('CURR:LIM:PEAK:HIGH ' + self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text)
                self.NF_wait()

                self.instrument_config.NF.DEV.write('CURR:LIM:PEAK:LOW ' + self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text)
                self.NF_wait()

                if self.ids['NF_Continuous_Start_Phase'].text == '':
                    self.ids['NF_Continuous_Start_Phase'].text = '0'
                elif float(self.ids['NF_Continuous_Start_Phase'].text) > 359.9:
                    self.ids['NF_Continuous_Start_Phase'].text = '359.9'
                elif float(self.ids['NF_Continuous_Start_Phase'].text) < 0:
                    self.ids['NF_Continuous_Start_Phase'].text = '0'
                else:
                    pass

                self.instrument_config.NF.DEV.write('PHAS:STAR ' + self.ids['NF_Continuous_Start_Phase'].text)
                self.NF_wait()

                if self.ids['NF_Continuous_Off_Phase'].text == '':
                    self.ids['NF_Continuous_Off_Phase'].text = '0'
                elif float(self.ids['NF_Continuous_Off_Phase'].text) > 359.9:
                    self.ids['NF_Continuous_Off_Phase'].text = '359.9'
                elif float(self.ids['NF_Continuous_Off_Phase'].text) < 0:
                    self.ids['NF_Continuous_Off_Phase'].text = '0'
                else:
                    pass

                self.instrument_config.NF.DEV.write('PHAS:STOP:ENAB 1')
                self.NF_wait()

                self.instrument_config.NF.DEV.write('PHAS:STOP ' + self.ids['NF_Continuous_Off_Phase'].text)
                self.NF_wait()

                self.instrument_config.NF.DEV.write('OUTP 1')
                self.NF_wait()

            elif self.instrument_config.NF.mode == 'Sequence':
                self.instrument_config.NF.DEV.write('SYST:CONF SEQ')
                self.NF_wait()

                if self.ids['NF_Sequence_time_unit'].text == 's':
                    self.instrument_config.NF.DEV.write('DISP:TIME:UNIT S')
                elif self.ids['NF_Sequence_time_unit'].text == 'ms':
                    self.instrument_config.NF.DEV.write('DISP:TIME:UNIT MS')
                else:
                    assert False
                self.NF_wait()

                voltage_list = ['NF_Sequence_Step' + str(idx) + '_AC_Voltage' for idx in range(self.instrument_config.NF.simulation_step_number)]

                for id in voltage_list:
                    if float(self.ids[id].text) < 0:
                        self.ids[id].text = '0'
                    elif float(self.ids[id].text) > 310:
                        self.ids[id].text = '310'                

                max_voltage = max([float(self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage'].text) for idx in range(self.instrument_config.NF.simulation_step_number)])
                if max_voltage > 155:
                    self.instrument_config.NF.DEV.write('VOLT:RANG R200V')
                else:
                    self.instrument_config.NF.DEV.write('VOLT:RANG R100V')
                self.NF_wait()

                time.sleep(.5)

                for idx in range(self.instrument_config.NF.simulation_step_number):
                    self.instrument_config.NF.DEV.write('SEQ:STEP ' + str(idx))

                    if idx != 0:
                        param_str = ''

                        if self.ids['NF_Sequence_time_unit'].text == 's':
                            if self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text == '':
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '0.001'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) > 999.999:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '999.999'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) < 0.001:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '0.001'

                            param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text
                            param_str = param_str + ','

                        elif self.ids['NF_Sequence_time_unit'].text == 'ms':
                            if self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text == '':
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '1'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) > 999999.9:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = ' > 999999.9'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) < 1:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '1'

                            param_str = param_str + str(float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) / 1000)
                            param_str = param_str + ','

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text) > 359.9:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '359.9'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '0'
                        else:
                            pass

                        param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text
                        param_str = param_str + ','
                        if self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase_Enable'].active == True:
                            param_str = param_str + '1'
                            param_str = param_str + ','
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase_Enable'].active == False:
                            param_str = param_str + '0'
                            param_str = param_str + ','
                        else:
                            assert False

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text) > 359.9:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '359.9'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '0'
                        else:
                            pass

                        param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text
                        param_str = param_str + ','
                        if self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase_Enable'].active == True:
                            param_str = param_str + '1'
                            param_str = param_str + ','           
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase_Enable'].active == False:
                            param_str = param_str + '0'
                            param_str = param_str + ','           
                        else:
                            assert False

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Step_Termination'].text == 'Continue':
                            param_str = param_str + 'CONT'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Step_Termination'].text == 'Hold':
                            param_str = param_str + 'HOLD'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Step_Termination'].text == 'End':
                            param_str = param_str + 'END'
                        else:
                            assert False
                        param_str = param_str + ','
        
                        if self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text) > 9999:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text = '9999'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text = '0'
                        else:
                            pass

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text) > 8:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text = '8'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text = ''
                        else:
                            pass

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To_Enable'].active == True:
                            param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text
                            param_str = param_str + ','
                            param_str = param_str + '1'
                            param_str = param_str + ','     
                            param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text
                            param_str = param_str + ','                              
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To_Enable'].active == False:
                            param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text
                            param_str = param_str + ','
                            param_str = param_str + '0'
                            param_str = param_str + ','     
                            param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text
                            param_str = param_str + ','                   
                        else:
                            assert False                    

                        param_str = param_str + '0,0,0,0,0,0'  

                        self.instrument_config.NF.DEV.write('SEQ:CPAR ' +  param_str)

                        param_str = ''
                        param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage'].text
                        param_str = param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Const':
                            param_str = param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Sweep':
                            param_str = param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Keep':
                            param_str = param_str + 'KEEP'
                        else:
                            assert False
                        param_str = param_str + ',' 

                        param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage'].text
                        param_str = param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Const':
                            param_str = param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Sweep':
                            param_str = param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Keep':
                            param_str = param_str + 'KEEP'
                        else:
                            assert False                
                        param_str = param_str + ',' 

                        if float(self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text) < 40:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text = '40'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text) > 550:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text = '550'                        

                        param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text
                        param_str = param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Const':
                            param_str = param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Sweep':
                            param_str = param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Keep':
                            param_str = param_str + 'KEEP'
                        else:
                            assert False
                            
                        param_str = param_str + ',' 

                        param_str = param_str + 'SIN,0.0' 

                        self.instrument_config.NF.DEV.write('SEQ:SPAR ' +  param_str)
                    else:
                        param_str = ''

                        if self.ids['NF_Sequence_time_unit'].text == 's':
                            if self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text == '':
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '0.001'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) > 999.999:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '999.999'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) < 0.001:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '0.001'

                            param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text
                            param_str = param_str + ','                                
                        elif self.ids['NF_Sequence_time_unit'].text == 'ms':
                            if self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text == '':
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '1'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) > 999999.9:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = ' > 999999.9'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) < 1:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '1'

                            param_str = param_str + str(float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) / 1000)
                            param_str = param_str + ','               

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text) > 359.9:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '359.9'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '0'
                        else:
                            pass

                        param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text
                        param_str = param_str + ','
                        if self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase_Enable'].active == True:
                            param_str = param_str + '1'
                            param_str = param_str + ','
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase_Enable'].active == False:
                            param_str = param_str + '0'
                            param_str = param_str + ','
                        else:
                            assert False

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text) > 359.9:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '359.9'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '0'
                        else:
                            pass

                        param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text
                        param_str = param_str + ','
                        if self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase_Enable'].active == True:
                            param_str = param_str + '1'
                            param_str = param_str + ','           
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase_Enable'].active == False:
                            param_str = param_str + '0'
                            param_str = param_str + ','           
                        else:
                            assert False

                        param_str = param_str + 'CONT'
                        param_str = param_str + ','

                        param_str = param_str + '0'
                        param_str = param_str + ','
                        param_str = param_str + '0'
                        param_str = param_str + ','     
                        param_str = param_str + '0'
                        param_str = param_str + ','            

                        param_str = param_str + '0,0,0,0,0,0'  

                        self.instrument_config.NF.DEV.write('SEQ:CPAR ' +  param_str)

                        param_str = ''
                        param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage'].text
                        param_str = param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Const':
                            param_str = param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Sweep':
                            param_str = param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Keep':
                            param_str = param_str + 'KEEP'
                        else:
                            assert False
                        param_str = param_str + ',' 

                        param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage'].text
                        param_str = param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Const':
                            param_str = param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Sweep':
                            param_str = param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Keep':
                            param_str = param_str + 'KEEP'
                        else:
                            assert False                
                        param_str = param_str + ',' 

                        if float(self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text) < 40:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text = '40'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text) > 550:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text = '550'                        

                        param_str = param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text
                        param_str = param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Const':
                            param_str = param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Sweep':
                            param_str = param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Keep':
                            param_str = param_str + 'KEEP'
                        else:
                            assert False
                            
                        param_str = param_str + ',' 

                        param_str = param_str + 'SIN,0.0' 

                        self.instrument_config.NF.DEV.write('SEQ:SPAR ' +  param_str)

                self.instrument_config.NF.DEV.write('TRIG:SEQ:COMP')
                self.NF_wait()

                time.sleep(2)

                self.instrument_config.NF.DEV.write('OUTP 1')
                self.NF_wait()

                self.instrument_config.NF.DEV.write('TRIG:SEQ:SEL:EXEC START')
                self.NF_wait()

            elif self.instrument_config.NF.mode == 'Simulation':

                self.instrument_config.NF.DEV.write('SYST:CONF SIM')
                self.NF_wait()

                if self.ids['NF_Simulation_repeat'].text == '' or int(self.ids['NF_Simulation_repeat'].text) < 1:
                    self.ids['NF_Simulation_repeat'].text = '1'
                elif int(self.ids['NF_Simulation_repeat'].text) > 9999:
                    self.ids['NF_Simulation_repeat'].text = '9999'
                else:
                    pass

                if self.ids['NF_Simulation_repeat'].text == '1':
                    self.instrument_config.NF.DEV.write('SIM:REP:ENAB 0')
                else:
                    self.instrument_config.NF.DEV.write('SIM:REP:ENAB 1')
                    self.NF_wait()
                    self.instrument_config.NF.DEV.write('SIM:REP:COUNT ' + self.ids['NF_Simulation_repeat'].text)
                self.NF_wait()

                if self.ids['NF_Simulation_time_unit'].text == 's':
                    self.instrument_config.NF.DEV.write('DISP:TIME:UNIT S')
                elif self.ids['NF_Simulation_time_unit'].text == 'ms':
                    self.instrument_config.NF.DEV.write('DISP:TIME:UNIT MS')
                else:
                    assert False
                self.NF_wait()

                for id in ['NF_Simulation_Initial_AC_Voltage', 'NF_Simulation_Normal1_AC_Voltage', 'NF_Simulation_Abnormal_AC_Voltage']:
                    if float(self.ids[id].text) < 0:
                        self.ids[id].text = '0'
                    elif float(self.ids[id].text) > 310:
                        self.ids[id].text = '310'

                max_voltage = max(float(self.ids['NF_Simulation_Initial_AC_Voltage'].text), float(self.ids['NF_Simulation_Normal1_AC_Voltage'].text), float(self.ids['NF_Simulation_Abnormal_AC_Voltage'].text))
                if max_voltage > 155:
                    self.instrument_config.NF.DEV.write('VOLT:RANG R200V')
                else:
                    self.instrument_config.NF.DEV.write('VOLT:RANG R100V')
                self.NF_wait()

                time.sleep(.5)
    ####################################################################################
                self.instrument_config.NF.DEV.write('SIM:INIT:VOLT ' + self.ids['NF_Simulation_Initial_AC_Voltage'].text)
                self.NF_wait()

                if float(self.ids['NF_Simulation_Initial_Frequency'].text) < 40:
                    self.ids['NF_Simulation_Initial_Frequency'].text = '40'
                elif float(self.ids['NF_Simulation_Initial_Frequency'].text) > 550:
                    self.ids['NF_Simulation_Initial_Frequency'].text = '550'

                self.instrument_config.NF.DEV.write('SIM:INIT:FREQ ' + self.ids['NF_Simulation_Initial_Frequency'].text)
                self.NF_wait()

                if self.ids['NF_Simulation_Initial_Start_Phase'].text == '':
                    self.ids['NF_Simulation_Initial_Start_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Initial_Start_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Initial_Start_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Initial_Start_Phase'].text) < 0:
                    self.ids['NF_Simulation_Initial_Start_Phase'].text = '0'

                if self.ids['NF_Simulation_Initial_Off_Phase'].text == '':
                    self.ids['NF_Simulation_Initial_Off_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Initial_Off_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Initial_Off_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Initial_Off_Phase'].text) < 0:
                    self.ids['NF_Simulation_Initial_Off_Phase'].text = '0'

                if self.ids['NF_Simulation_Initial_Start_Phase_Enable'].active == True:
                    self.instrument_config.NF.DEV.write('SIM:INIT:PHAS:STAR:ENAB 1')
                    self.NF_wait()
                    self.instrument_config.NF.DEV.write('SIM:INIT:PHAS:STAR ' + self.ids['NF_Simulation_Initial_Start_Phase'].text)
                elif self.ids['NF_Simulation_Initial_Start_Phase_Enable'].active == False:
                    self.instrument_config.NF.DEV.write('SIM:INIT:PHAS:STAR:ENAB 0')
                else:
                    assert False
                self.NF_wait()

                if self.ids['NF_Simulation_Initial_Off_Phase_Enable'].active == True:
                    self.instrument_config.NF.DEV.write('SIM:INIT:PHAS:STOP:ENAB 1')
                    self.NF_wait()
                    self.instrument_config.NF.DEV.write('SIM:INIT:PHAS:STOP ' + self.ids['NF_Simulation_Initial_Off_Phase'].text)
                elif self.ids['NF_Simulation_Initial_Off_Phase_Enable'].active == False:
                    self.instrument_config.NF.DEV.write('SIM:INIT:PHAS:STOP:ENAB 0')
                else:
                    assert False
                self.NF_wait()
    ####################################################################################
                self.instrument_config.NF.DEV.write('SIM:NORM1:VOLT ' + self.ids['NF_Simulation_Normal1_AC_Voltage'].text)
                self.NF_wait()

                if float(self.ids['NF_Simulation_Normal1_Frequency'].text) < 40:
                    self.ids['NF_Simulation_Normal1_Frequency'].text = '40'
                elif float(self.ids['NF_Simulation_Normal1_Frequency'].text) > 550:
                    self.ids['NF_Simulation_Normal1_Frequency'].text = '550'

                self.instrument_config.NF.DEV.write('SIM:NORM1:FREQ ' + self.ids['NF_Simulation_Normal1_Frequency'].text)
                self.NF_wait()

                if self.ids['NF_Simulation_time_unit'].text == 's':
                    if self.ids['NF_Simulation_Normal1_Time'].text == '':
                        self.ids['NF_Simulation_Normal1_Time'].text = '0.001'
                    elif float(self.ids['NF_Simulation_Normal1_Time'].text) > 999.999:
                        self.ids['NF_Simulation_Normal1_Time'].text = '999.999'
                    elif float(self.ids['NF_Simulation_Normal1_Time'].text) < 0.001:
                        self.ids['NF_Simulation_Normal1_Time'].text = '0.001'

                    self.instrument_config.NF.DEV.write('SIM:NORM1:TIME ' + self.ids['NF_Simulation_Normal1_Time'].text)
                    self.NF_wait()
                    
                elif self.ids['NF_Simulation_time_unit'].text == 'ms':
                    if self.ids['NF_Simulation_Normal1_Time'].text == '':
                        self.ids['NF_Simulation_Normal1_Time'].text = '1'
                    elif float(self.ids['NF_Simulation_Normal1_Time'].text) > 999999.9:
                        self.ids['NF_Simulation_Normal1_Time'].text = ' > 999999.9'
                    elif float(self.ids['NF_Simulation_Normal1_Time'].text) < 1:
                        self.ids['NF_Simulation_Normal1_Time'].text = '1'

                    self.instrument_config.NF.DEV.write('SIM:NORM1:TIME ' + str(float(self.ids['NF_Simulation_Normal1_Time'].text) / 1000))
                    self.NF_wait()

                if self.ids['NF_Simulation_Normal1_Start_Phase'].text == '':
                    self.ids['NF_Simulation_Normal1_Start_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Normal1_Start_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Normal1_Start_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Normal1_Start_Phase'].text) < 0:
                    self.ids['NF_Simulation_Normal1_Start_Phase'].text = '0'

                if self.ids['NF_Simulation_Normal1_Off_Phase'].text == '':
                    self.ids['NF_Simulation_Normal1_Off_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Normal1_Off_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Normal1_Off_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Normal1_Off_Phase'].text) < 0:
                    self.ids['NF_Simulation_Normal1_Off_Phase'].text = '0'

                if self.ids['NF_Simulation_Normal1_Start_Phase_Enable'].active == True:
                    self.instrument_config.NF.DEV.write('SIM:NORM1:PHAS:STAR:ENAB 1')
                    self.NF_wait()
                    self.instrument_config.NF.DEV.write('SIM:NORM1:PHAS:STAR ' + self.ids['NF_Simulation_Normal1_Start_Phase'].text)
                elif self.ids['NF_Simulation_Normal1_Start_Phase_Enable'].active == False:
                    self.instrument_config.NF.DEV.write('SIM:NORM1:PHAS:STAR:ENAB 0')
                else:
                    assert False
                self.NF_wait()

                if self.ids['NF_Simulation_Normal1_Off_Phase_Enable'].active == True:
                    self.instrument_config.NF.DEV.write('SIM:NORM1:PHAS:STOP:ENAB 1')
                    self.NF_wait()
                    self.instrument_config.NF.DEV.write('SIM:NORM1:PHAS:STOP ' + self.ids['NF_Simulation_Normal1_Off_Phase'].text)
                elif self.ids['NF_Simulation_Normal1_Off_Phase_Enable'].active == False:
                    self.instrument_config.NF.DEV.write('SIM:NORM1:PHAS:STOP:ENAB 0')
                else:
                    assert False
                self.NF_wait()
    ####################################################################################
                if self.ids['NF_Simulation_time_unit'].text == 's':
                    if self.ids['NF_Simulation_Trans1_Time'].text == '':
                        self.ids['NF_Simulation_Trans1_Time'].text = '0.001'
                    elif float(self.ids['NF_Simulation_Trans1_Time'].text) > 999.999:
                        self.ids['NF_Simulation_Trans1_Time'].text = '999.999'
                    elif float(self.ids['NF_Simulation_Trans1_Time'].text) < 0.001:
                        self.ids['NF_Simulation_Trans1_Time'].text = '0.001'

                    self.instrument_config.NF.DEV.write('SIM:TRAN1:TIME ' + self.ids['NF_Simulation_Trans1_Time'].text)
                    self.NF_wait()

                elif self.ids['NF_Simulation_time_unit'].text == 'ms':
                    if self.ids['NF_Simulation_Trans1_Time'].text == '':
                        self.ids['NF_Simulation_Trans1_Time'].text = '1'
                    elif float(self.ids['NF_Simulation_Trans1_Time'].text) > 999999.9:
                        self.ids['NF_Simulation_Trans1_Time'].text = ' > 999999.9'
                    elif float(self.ids['NF_Simulation_Trans1_Time'].text) < 1:
                        self.ids['NF_Simulation_Trans1_Time'].text = '1'

                    self.instrument_config.NF.DEV.write('SIM:TRAN1:TIME ' + str(float(self.ids['NF_Simulation_Trans1_Time'].text) / 1000))
                    self.NF_wait()

    ####################################################################################
                self.instrument_config.NF.DEV.write('SIM:ABN:VOLT ' + self.ids['NF_Simulation_Abnormal_AC_Voltage'].text)
                self.NF_wait()

                if float(self.ids['NF_Simulation_Abnormal_Frequency'].text) < 40:
                    self.ids['NF_Simulation_Abnormal_Frequency'].text = '40'
                elif float(self.ids['NF_Simulation_Abnormal_Frequency'].text) > 550:
                    self.ids['NF_Simulation_Abnormal_Frequency'].text = '550'

                self.instrument_config.NF.DEV.write('SIM:ABN:FREQ ' + self.ids['NF_Simulation_Abnormal_Frequency'].text)
                self.NF_wait()

                if self.ids['NF_Simulation_time_unit'].text == 's':
                    if self.ids['NF_Simulation_Abnormal_Time'].text == '':
                        self.ids['NF_Simulation_Abnormal_Time'].text = '0.001'
                    elif float(self.ids['NF_Simulation_Abnormal_Time'].text) > 999.999:
                        self.ids['NF_Simulation_Abnormal_Time'].text = '999.999'
                    elif float(self.ids['NF_Simulation_Abnormal_Time'].text) < 0.001:
                        self.ids['NF_Simulation_Abnormal_Time'].text = '0.001'
                
                    self.instrument_config.NF.DEV.write('SIM:ABN:TIME ' + self.ids['NF_Simulation_Abnormal_Time'].text)
                    self.NF_wait()                        
                elif self.ids['NF_Simulation_time_unit'].text == 'ms':
                    if self.ids['NF_Simulation_Abnormal_Time'].text == '':
                        self.ids['NF_Simulation_Abnormal_Time'].text = '1'
                    elif float(self.ids['NF_Simulation_Abnormal_Time'].text) > 999999.9:
                        self.ids['NF_Simulation_Abnormal_Time'].text = ' > 999999.9'
                    elif float(self.ids['NF_Simulation_Abnormal_Time'].text) < 1:
                        self.ids['NF_Simulation_Abnormal_Time'].text = '1'

                    self.instrument_config.NF.DEV.write('SIM:ABN:TIME ' + str(float(self.ids['NF_Simulation_Abnormal_Time'].text) / 1000))
                    self.NF_wait()

                if self.ids['NF_Simulation_Abnormal_Start_Phase'].text == '':
                    self.ids['NF_Simulation_Abnormal_Start_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Abnormal_Start_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Abnormal_Start_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Abnormal_Start_Phase'].text) < 0:
                    self.ids['NF_Simulation_Abnormal_Start_Phase'].text = '0'

                if self.ids['NF_Simulation_Abnormal_Off_Phase'].text == '':
                    self.ids['NF_Simulation_Abnormal_Off_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Abnormal_Off_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Abnormal_Off_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Abnormal_Off_Phase'].text) < 0:
                    self.ids['NF_Simulation_Abnormal_Off_Phase'].text = '0'

                if self.ids['NF_Simulation_Abnormal_Start_Phase_Enable'].active == True:
                    self.instrument_config.NF.DEV.write('SIM:ABN:PHAS:STAR:ENAB 1')
                    self.NF_wait()
                    self.instrument_config.NF.DEV.write('SIM:ABN:PHAS:STAR ' + self.ids['NF_Simulation_Abnormal_Start_Phase'].text)
                elif self.ids['NF_Simulation_Abnormal_Start_Phase_Enable'].active == False:
                    self.instrument_config.NF.DEV.write('SIM:ABN:PHAS:STAR:ENAB 0')
                else:
                    assert False
                self.NF_wait()

                if self.ids['NF_Simulation_Abnormal_Off_Phase_Enable'].active == True:
                    self.instrument_config.NF.DEV.write('SIM:ABN:PHAS:STOP:ENAB 1')
                    self.NF_wait()
                    self.instrument_config.NF.DEV.write('SIM:ABN:PHAS:STOP ' + self.ids['NF_Simulation_Abnormal_Off_Phase'].text)
                elif self.ids['NF_Simulation_Abnormal_Off_Phase_Enable'].active == False:
                    self.instrument_config.NF.DEV.write('SIM:ABN:PHAS:STOP:ENAB 0')
                else:
                    assert False
                self.NF_wait()
    ####################################################################################
                if self.ids['NF_Simulation_time_unit'].text == 's':
                    if self.ids['NF_Simulation_Trans2_Time'].text == '':
                        self.ids['NF_Simulation_Trans2_Time'].text = '0.001'
                    elif float(self.ids['NF_Simulation_Trans2_Time'].text) > 999.999:
                        self.ids['NF_Simulation_Trans2_Time'].text = '999.999'
                    elif float(self.ids['NF_Simulation_Trans2_Time'].text) < 0.001:
                        self.ids['NF_Simulation_Trans2_Time'].text = '0.001'

                    self.instrument_config.NF.DEV.write('SIM:TRAN2:TIME ' + self.ids['NF_Simulation_Trans2_Time'].text)
                    self.NF_wait()

                elif self.ids['NF_Simulation_time_unit'].text == 'ms':
                    if self.ids['NF_Simulation_Trans2_Time'].text == '':
                        self.ids['NF_Simulation_Trans2_Time'].text = '1'
                    elif float(self.ids['NF_Simulation_Trans2_Time'].text) > 999999.9:
                        self.ids['NF_Simulation_Trans2_Time'].text = ' > 999999.9'
                    elif float(self.ids['NF_Simulation_Trans2_Time'].text) < 1:
                        self.ids['NF_Simulation_Trans2_Time'].text = '1'

                    self.instrument_config.NF.DEV.write('SIM:TRAN2:TIME ' + str(float(self.ids['NF_Simulation_Trans2_Time'].text) / 1000))
                    self.NF_wait()
    ####################################################################################
                if self.ids['NF_Simulation_time_unit'].text == 's':
                    if self.ids['NF_Simulation_Normal2_Time'].text == '':
                        self.ids['NF_Simulation_Normal2_Time'].text = '0.001'
                    elif float(self.ids['NF_Simulation_Normal2_Time'].text) > 999.999:
                        self.ids['NF_Simulation_Normal2_Time'].text = '999.999'
                    elif float(self.ids['NF_Simulation_Normal2_Time'].text) < 0.001:
                        self.ids['NF_Simulation_Normal2_Time'].text = '0.001'

                    self.instrument_config.NF.DEV.write('SIM:NORM2:TIME ' + self.ids['NF_Simulation_Normal2_Time'].text)
                    self.NF_wait()                        
                elif self.ids['NF_Simulation_time_unit'].text == 'ms':
                    if self.ids['NF_Simulation_Normal2_Time'].text == '':
                        self.ids['NF_Simulation_Normal2_Time'].text = '1'
                    elif float(self.ids['NF_Simulation_Normal2_Time'].text) > 999999.9:
                        self.ids['NF_Simulation_Normal2_Time'].text = ' > 999999.9'
                    elif float(self.ids['NF_Simulation_Normal2_Time'].text) < 1:
                        self.ids['NF_Simulation_Normal2_Time'].text = '1'

                    self.instrument_config.NF.DEV.write('SIM:NORM2:TIME ' + str(float(self.ids['NF_Simulation_Normal2_Time'].text) / 1000))
                    self.NF_wait()    

                if self.ids['NF_Simulation_Normal2_Start_Phase'].text == '':
                    self.ids['NF_Simulation_Normal2_Start_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Normal2_Start_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Normal2_Start_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Normal2_Start_Phase'].text) < 0:
                    self.ids['NF_Simulation_Normal2_Start_Phase'].text = '0'

                if self.ids['NF_Simulation_Normal2_Off_Phase'].text == '':
                    self.ids['NF_Simulation_Normal2_Off_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Normal2_Off_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Normal2_Off_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Normal2_Off_Phase'].text) < 0:
                    self.ids['NF_Simulation_Normal2_Off_Phase'].text = '0'

                if self.ids['NF_Simulation_Normal2_Start_Phase_Enable'].active == True:
                    self.instrument_config.NF.DEV.write('SIM:NORM2:PHAS:STAR:ENAB 1')
                    self.NF_wait()
                    self.instrument_config.NF.DEV.write('SIM:NORM2:PHAS:STAR ' + self.ids['NF_Simulation_Normal2_Start_Phase'].text)
                elif self.ids['NF_Simulation_Normal2_Start_Phase_Enable'].active == False:
                    self.instrument_config.NF.DEV.write('SIM:NORM2:PHAS:STAR:ENAB 0')
                else:
                    assert False
                self.NF_wait()

                if self.ids['NF_Simulation_Normal2_Off_Phase_Enable'].active == True:
                    self.instrument_config.NF.DEV.write('SIM:NORM2:PHAS:STOP:ENAB 1')
                    self.NF_wait()
                    self.instrument_config.NF.DEV.write('SIM:NORM2:PHAS:STOP ' + self.ids['NF_Simulation_Normal2_Off_Phase'].text)
                elif self.ids['NF_Simulation_Normal2_Off_Phase_Enable'].active == False:
                    self.instrument_config.NF.DEV.write('SIM:NORM2:PHAS:STOP:ENAB 0')
                else:
                    assert False
                self.NF_wait()
    ####################################################################################
                self.instrument_config.NF.DEV.write('TRIG:SIM:COMP')
                self.NF_wait()

                self.instrument_config.NF.DEV.write('OUTP 1')
                self.NF_wait()

                self.instrument_config.NF.DEV.write('TRIG:SIM:SEL:EXEC START')
                self.NF_wait()

            else:
                assert False

            Clock.schedule_interval(self.NF_task, 1)

        else: # self.UI_system.remoteMode == True

            self.instrument_config.NF.mode = self.ids['NF'].current_tab.text

            if self.instrument_config.NF.mode == 'Continuous':

                if float(self.ids['NF_Continuous_AC_Voltage'].text) < 0:
                    self.ids['NF_Continuous_AC_Voltage'].text = '0'
                elif float(self.ids['NF_Continuous_AC_Voltage'].text) > 310:
                    self.ids['NF_Continuous_AC_Voltage'].text = '310'

                if float(self.ids['NF_Continuous_AC_Voltage'].text) > 155:

                    if float(self.ids['NF_Continuous_Vrms_Limiter'].text) < float(self.ids['NF_Continuous_AC_Voltage'].text):
                        self.ids['NF_Continuous_Vrms_Limiter'].text = self.ids['NF_Continuous_AC_Voltage'].text
                    elif float(self.ids['NF_Continuous_Vrms_Limiter'].text) > 310:
                        self.ids['NF_Continuous_Vrms_Limiter'].text = '310'             
 
                else:

                    if float(self.ids['NF_Continuous_Vrms_Limiter'].text) < float(self.ids['NF_Continuous_AC_Voltage'].text):
                        self.ids['NF_Continuous_Vrms_Limiter'].text = self.ids['NF_Continuous_AC_Voltage'].text
                    elif float(self.ids['NF_Continuous_Vrms_Limiter'].text) > 155:
                        self.ids['NF_Continuous_Vrms_Limiter'].text = '155'  

                if float(self.ids['NF_Continuous_Frequency'].text) < 40:
                    self.ids['NF_Continuous_Frequency'].text = '40'
                elif float(self.ids['NF_Continuous_Frequency'].text) > 550:
                    self.ids['NF_Continuous_Frequency'].text = '550'

                if float(self.ids['NF_Continuous_Freq_Limiter_Low'].text) > float(self.ids['NF_Continuous_Frequency'].text):
                    self.ids['NF_Continuous_Freq_Limiter_Low'].text = self.ids['NF_Continuous_Frequency'].text

                if float(self.ids['NF_Continuous_Freq_Limiter_High'].text) < float(self.ids['NF_Continuous_Frequency'].text):
                    self.ids['NF_Continuous_Freq_Limiter_High'].text = self.ids['NF_Continuous_Frequency'].text

                if float(self.ids['NF_Continuous_AC_Voltage'].text) > 155:
                    self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text = '63' if float(self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text) > 63 else self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text
                    self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text = '-63' if float(self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text) < -63 else self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text
                    self.ids['NF_Continuous_Current_rms_Limiter'].text = '15.8' if float(self.ids['NF_Continuous_Current_rms_Limiter'].text) > 15.8 else self.ids['NF_Continuous_Current_rms_Limiter'].text
                else:
                    self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text = '126' if float(self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text) > 126 else self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text
                    self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text = '-126' if float(self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text) < -126 else self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text                
                    self.ids['NF_Continuous_Current_rms_Limiter'].text = '31.5' if float(self.ids['NF_Continuous_Current_rms_Limiter'].text) > 31.5 else self.ids['NF_Continuous_Current_rms_Limiter'].text

                if self.ids['NF_Continuous_Start_Phase'].text == '':
                    self.ids['NF_Continuous_Start_Phase'].text = '0'
                elif float(self.ids['NF_Continuous_Start_Phase'].text) > 359.9:
                    self.ids['NF_Continuous_Start_Phase'].text = '359.9'
                elif float(self.ids['NF_Continuous_Start_Phase'].text) < 0:
                    self.ids['NF_Continuous_Start_Phase'].text = '0'
                else:
                    pass

                if self.ids['NF_Continuous_Off_Phase'].text == '':
                    self.ids['NF_Continuous_Off_Phase'].text = '0'
                elif float(self.ids['NF_Continuous_Off_Phase'].text) > 359.9:
                    self.ids['NF_Continuous_Off_Phase'].text = '359.9'
                elif float(self.ids['NF_Continuous_Off_Phase'].text) < 0:
                    self.ids['NF_Continuous_Off_Phase'].text = '0'
                else:
                    pass

            elif self.instrument_config.NF.mode == 'Sequence':

                voltage_list = ['NF_Sequence_Step' + str(idx) + '_AC_Voltage' for idx in range(self.instrument_config.NF.simulation_step_number)]

                for id in voltage_list:
                    if float(self.ids[id].text) < 0:
                        self.ids[id].text = '0'
                    elif float(self.ids[id].text) > 310:
                        self.ids[id].text = '310'                

                max_voltage = max([float(self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage'].text) for idx in range(self.instrument_config.NF.simulation_step_number)])

                common_param_str = ''
                step_param_str = ''

                for idx in range(self.instrument_config.NF.simulation_step_number):
                    
                    if idx != 0:

                        if self.ids['NF_Sequence_time_unit'].text == 's':
                            if self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text == '':
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '0.001'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) > 999.999:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '999.999'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) < 0.001:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '0.001'
                        elif self.ids['NF_Sequence_time_unit'].text == 'ms':
                            if self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text == '':
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '1'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) > 999999.9:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = ' > 999999.9'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) < 1:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '1'

                        if self.ids['NF_Sequence_time_unit'].text == 's':
                            common_param_str = common_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text
                        elif self.ids['NF_Sequence_time_unit'].text == 'ms':
                            common_param_str = common_param_str + str(float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) / 1000)
                        common_param_str = common_param_str + ','

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text) > 359.9:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '359.9'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '0'
                        else:
                            pass

                        common_param_str = common_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text
                        common_param_str = common_param_str + ','
                        if self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase_Enable'].active == True:
                            common_param_str = common_param_str + '1'
                            common_param_str = common_param_str + ','
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase_Enable'].active == False:
                            common_param_str = common_param_str + '0'
                            common_param_str = common_param_str + ','
                        else:
                            assert False

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text) > 359.9:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '359.9'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '0'
                        else:
                            pass

                        common_param_str = common_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text
                        common_param_str = common_param_str + ','
                        if self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase_Enable'].active == True:
                            common_param_str = common_param_str + '1'
                            common_param_str = common_param_str + ','           
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase_Enable'].active == False:
                            common_param_str = common_param_str + '0'
                            common_param_str = common_param_str + ','           
                        else:
                            assert False

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Step_Termination'].text == 'Continue':
                            common_param_str = common_param_str + 'CONT'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Step_Termination'].text == 'Hold':
                            common_param_str = common_param_str + 'HOLD'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Step_Termination'].text == 'End':
                            common_param_str = common_param_str + 'END'
                        else:
                            assert False
                        common_param_str = common_param_str + ','
        
                        if self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text) > 9999:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text = '9999'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text = '0'
                        else:
                            pass

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text) > 8:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text = '8'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text = ''
                        else:
                            pass

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To_Enable'].active == True:
                            common_param_str = common_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text
                            common_param_str = common_param_str + ','
                            common_param_str = common_param_str + '1'
                            common_param_str = common_param_str + ','     
                            common_param_str = common_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text
                            common_param_str = common_param_str + ','                              
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To_Enable'].active == False:
                            common_param_str = common_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Jump_To'].text
                            common_param_str = common_param_str + ','
                            common_param_str = common_param_str + '0'
                            common_param_str = common_param_str + ','     
                            common_param_str = common_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Jump_Count'].text
                            common_param_str = common_param_str + ','                   
                        else:
                            assert False                    

                        common_param_str = common_param_str + '0,0,0,0,0,0 '  

                        step_param_str = step_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage'].text
                        step_param_str = step_param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Const':
                            step_param_str = step_param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Sweep':
                            step_param_str = step_param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Keep':
                            step_param_str = step_param_str + 'KEEP'
                        else:
                            assert False
                        step_param_str = step_param_str + ',' 

                        step_param_str = step_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage'].text
                        step_param_str = step_param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Const':
                            step_param_str = step_param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Sweep':
                            step_param_str = step_param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Keep':
                            step_param_str = step_param_str + 'KEEP'
                        else:
                            assert False                
                        step_param_str = step_param_str + ',' 

                        if float(self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text) < 40:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text = '40'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text) > 550:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text = '550'                        

                        step_param_str = step_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text
                        step_param_str = step_param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Const':
                            step_param_str = step_param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Sweep':
                            step_param_str = step_param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Keep':
                            step_param_str = step_param_str + 'KEEP'
                        else:
                            assert False
                            
                        step_param_str = step_param_str + ',' 

                        step_param_str = step_param_str + 'SIN,0.0 ' 

                    else:

                        if self.ids['NF_Sequence_time_unit'].text == 's':
                            if self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text == '':
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '0.001'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) > 999.999:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '999.999'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) < 0.001:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '0.001'
                        elif self.ids['NF_Sequence_time_unit'].text == 'ms':
                            if self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text == '':
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '1'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) > 999999.9:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = ' > 999999.9'
                            elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) < 1:
                                self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text = '1'

                        if self.ids['NF_Sequence_time_unit'].text == 's':
                            common_param_str = common_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text
                        elif self.ids['NF_Sequence_time_unit'].text == 'ms':
                            common_param_str = common_param_str + str(float(self.ids['NF_Sequence_Step' + str(idx) + '_Time'].text) / 1000)
                        common_param_str = common_param_str + ','

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text) > 359.9:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '359.9'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text = '0'
                        else:
                            pass

                        common_param_str = common_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase'].text
                        common_param_str = common_param_str + ','
                        if self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase_Enable'].active == True:
                            common_param_str = common_param_str + '1'
                            common_param_str = common_param_str + ','
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Start_Phase_Enable'].active == False:
                            common_param_str = common_param_str + '0'
                            common_param_str = common_param_str + ','
                        else:
                            assert False

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text == '':
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '0'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text) > 359.9:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '359.9'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text) < 0:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text = '0'
                        else:
                            pass

                        common_param_str = common_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase'].text
                        common_param_str = common_param_str + ','
                        if self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase_Enable'].active == True:
                            common_param_str = common_param_str + '1'
                            common_param_str = common_param_str + ','           
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Off_Phase_Enable'].active == False:
                            common_param_str = common_param_str + '0'
                            common_param_str = common_param_str + ','           
                        else:
                            assert False

                        common_param_str = common_param_str + 'CONT'
                        common_param_str = common_param_str + ','

                        common_param_str = common_param_str + '0'
                        common_param_str = common_param_str + ','
                        common_param_str = common_param_str + '0'
                        common_param_str = common_param_str + ','     
                        common_param_str = common_param_str + '0'
                        common_param_str = common_param_str + ','            

                        common_param_str = common_param_str + '0,0,0,0,0,0 '  

                        step_param_str = step_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage'].text
                        step_param_str = step_param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Const':
                            step_param_str = step_param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Sweep':
                            step_param_str = step_param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_AC_Voltage_Mode'].text == 'Keep':
                            step_param_str = step_param_str + 'KEEP'
                        else:
                            assert False
                        step_param_str = step_param_str + ',' 

                        step_param_str = step_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage'].text
                        step_param_str = step_param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Const':
                            step_param_str = step_param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Sweep':
                            step_param_str = step_param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_Mode'].text == 'Keep':
                            step_param_str = step_param_str + 'KEEP'
                        else:
                            assert False                
                        step_param_str = step_param_str + ',' 

                        if float(self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text) < 40:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text = '40'
                        elif float(self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text) > 550:
                            self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text = '550'                        

                        step_param_str = step_param_str + self.ids['NF_Sequence_Step' + str(idx) + '_Frequency'].text
                        step_param_str = step_param_str + ','                    

                        if self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Const':
                            step_param_str = step_param_str + 'CONST'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Sweep':
                            step_param_str = step_param_str + 'SWEEP'
                        elif self.ids['NF_Sequence_Step' + str(idx) + '_Frequency_Mode'].text == 'Keep':
                            step_param_str = step_param_str + 'KEEP'
                        else:
                            assert False
                            
                        step_param_str = step_param_str + ',' 

                        step_param_str = step_param_str + 'SIN,0.0 ' 

            elif self.instrument_config.NF.mode == 'Simulation':

                if self.ids['NF_Simulation_repeat'].text == '' or int(self.ids['NF_Simulation_repeat'].text) < 1:
                    self.ids['NF_Simulation_repeat'].text = '1'
                elif int(self.ids['NF_Simulation_repeat'].text) > 9999:
                    self.ids['NF_Simulation_repeat'].text = '9999'
                else:
                    pass

                for id in ['NF_Simulation_Initial_AC_Voltage', 'NF_Simulation_Normal1_AC_Voltage', 'NF_Simulation_Abnormal_AC_Voltage']:
                    if float(self.ids[id].text) < 0:
                        self.ids[id].text = '0'
                    elif float(self.ids[id].text) > 310:
                        self.ids[id].text = '310'

                max_voltage = max(float(self.ids['NF_Simulation_Initial_AC_Voltage'].text), float(self.ids['NF_Simulation_Normal1_AC_Voltage'].text), float(self.ids['NF_Simulation_Abnormal_AC_Voltage'].text))

    ####################################################################################

                if float(self.ids['NF_Simulation_Initial_Frequency'].text) < 40:
                    self.ids['NF_Simulation_Initial_Frequency'].text = '40'
                elif float(self.ids['NF_Simulation_Initial_Frequency'].text) > 550:
                    self.ids['NF_Simulation_Initial_Frequency'].text = '550'

                if self.ids['NF_Simulation_Initial_Start_Phase'].text == '':
                    self.ids['NF_Simulation_Initial_Start_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Initial_Start_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Initial_Start_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Initial_Start_Phase'].text) < 0:
                    self.ids['NF_Simulation_Initial_Start_Phase'].text = '0'

                if self.ids['NF_Simulation_Initial_Off_Phase'].text == '':
                    self.ids['NF_Simulation_Initial_Off_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Initial_Off_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Initial_Off_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Initial_Off_Phase'].text) < 0:
                    self.ids['NF_Simulation_Initial_Off_Phase'].text = '0'

    ####################################################################################

                if float(self.ids['NF_Simulation_Normal1_Frequency'].text) < 40:
                    self.ids['NF_Simulation_Normal1_Frequency'].text = '40'
                elif float(self.ids['NF_Simulation_Normal1_Frequency'].text) > 550:
                    self.ids['NF_Simulation_Normal1_Frequency'].text = '550'

                if self.ids['NF_Simulation_time_unit'].text == 's':
                    if self.ids['NF_Simulation_Normal1_Time'].text == '':
                        self.ids['NF_Simulation_Normal1_Time'].text = '0.001'
                    elif float(self.ids['NF_Simulation_Normal1_Time'].text) > 999.999:
                        self.ids['NF_Simulation_Normal1_Time'].text = '999.999'
                    elif float(self.ids['NF_Simulation_Normal1_Time'].text) < 0.001:
                        self.ids['NF_Simulation_Normal1_Time'].text = '0.001'
                elif self.ids['NF_Simulation_time_unit'].text == 'ms':
                    if self.ids['NF_Simulation_Normal1_Time'].text == '':
                        self.ids['NF_Simulation_Normal1_Time'].text = '1'
                    elif float(self.ids['NF_Simulation_Normal1_Time'].text) > 999999.9:
                        self.ids['NF_Simulation_Normal1_Time'].text = ' > 999999.9'
                    elif float(self.ids['NF_Simulation_Normal1_Time'].text) < 1:
                        self.ids['NF_Simulation_Normal1_Time'].text = '1'

                if self.ids['NF_Simulation_Normal1_Start_Phase'].text == '':
                    self.ids['NF_Simulation_Normal1_Start_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Normal1_Start_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Normal1_Start_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Normal1_Start_Phase'].text) < 0:
                    self.ids['NF_Simulation_Normal1_Start_Phase'].text = '0'

                if self.ids['NF_Simulation_Normal1_Off_Phase'].text == '':
                    self.ids['NF_Simulation_Normal1_Off_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Normal1_Off_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Normal1_Off_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Normal1_Off_Phase'].text) < 0:
                    self.ids['NF_Simulation_Normal1_Off_Phase'].text = '0'

    ####################################################################################
                if self.ids['NF_Simulation_time_unit'].text == 's':
                    if self.ids['NF_Simulation_Trans1_Time'].text == '':
                        self.ids['NF_Simulation_Trans1_Time'].text = '0.001'
                    elif float(self.ids['NF_Simulation_Trans1_Time'].text) > 999.999:
                        self.ids['NF_Simulation_Trans1_Time'].text = '999.999'
                    elif float(self.ids['NF_Simulation_Trans1_Time'].text) < 0.001:
                        self.ids['NF_Simulation_Trans1_Time'].text = '0.001'
                elif self.ids['NF_Simulation_time_unit'].text == 'ms':
                    if self.ids['NF_Simulation_Trans1_Time'].text == '':
                        self.ids['NF_Simulation_Trans1_Time'].text = '1'
                    elif float(self.ids['NF_Simulation_Trans1_Time'].text) > 999999.9:
                        self.ids['NF_Simulation_Trans1_Time'].text = ' > 999999.9'
                    elif float(self.ids['NF_Simulation_Trans1_Time'].text) < 1:
                        self.ids['NF_Simulation_Trans1_Time'].text = '1'

    ####################################################################################

                if float(self.ids['NF_Simulation_Abnormal_Frequency'].text) < 40:
                    self.ids['NF_Simulation_Abnormal_Frequency'].text = '40'
                elif float(self.ids['NF_Simulation_Abnormal_Frequency'].text) > 550:
                    self.ids['NF_Simulation_Abnormal_Frequency'].text = '550'

                if self.ids['NF_Simulation_time_unit'].text == 's':
                    if self.ids['NF_Simulation_Abnormal_Time'].text == '':
                        self.ids['NF_Simulation_Abnormal_Time'].text = '0.001'
                    elif float(self.ids['NF_Simulation_Abnormal_Time'].text) > 999.999:
                        self.ids['NF_Simulation_Abnormal_Time'].text = '999.999'
                    elif float(self.ids['NF_Simulation_Abnormal_Time'].text) < 0.001:
                        self.ids['NF_Simulation_Abnormal_Time'].text = '0.001'
                elif self.ids['NF_Simulation_time_unit'].text == 'ms':
                    if self.ids['NF_Simulation_Abnormal_Time'].text == '':
                        self.ids['NF_Simulation_Abnormal_Time'].text = '1'
                    elif float(self.ids['NF_Simulation_Abnormal_Time'].text) > 999999.9:
                        self.ids['NF_Simulation_Abnormal_Time'].text = ' > 999999.9'
                    elif float(self.ids['NF_Simulation_Abnormal_Time'].text) < 1:
                        self.ids['NF_Simulation_Abnormal_Time'].text = '1'

                if self.ids['NF_Simulation_Abnormal_Start_Phase'].text == '':
                    self.ids['NF_Simulation_Abnormal_Start_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Abnormal_Start_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Abnormal_Start_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Abnormal_Start_Phase'].text) < 0:
                    self.ids['NF_Simulation_Abnormal_Start_Phase'].text = '0'

                if self.ids['NF_Simulation_Abnormal_Off_Phase'].text == '':
                    self.ids['NF_Simulation_Abnormal_Off_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Abnormal_Off_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Abnormal_Off_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Abnormal_Off_Phase'].text) < 0:
                    self.ids['NF_Simulation_Abnormal_Off_Phase'].text = '0'

    ####################################################################################
                if self.ids['NF_Simulation_time_unit'].text == 's':
                    if self.ids['NF_Simulation_Trans2_Time'].text == '':
                        self.ids['NF_Simulation_Trans2_Time'].text = '0.001'
                    elif float(self.ids['NF_Simulation_Trans2_Time'].text) > 999.999:
                        self.ids['NF_Simulation_Trans2_Time'].text = '999.999'
                    elif float(self.ids['NF_Simulation_Trans2_Time'].text) < 0.001:
                        self.ids['NF_Simulation_Trans2_Time'].text = '0.001'
                elif self.ids['NF_Simulation_time_unit'].text == 'ms':
                    if self.ids['NF_Simulation_Trans2_Time'].text == '':
                        self.ids['NF_Simulation_Trans2_Time'].text = '1'
                    elif float(self.ids['NF_Simulation_Trans2_Time'].text) > 999999.9:
                        self.ids['NF_Simulation_Trans2_Time'].text = ' > 999999.9'
                    elif float(self.ids['NF_Simulation_Trans2_Time'].text) < 1:
                        self.ids['NF_Simulation_Trans2_Time'].text = '1'

    ####################################################################################
                if self.ids['NF_Simulation_time_unit'].text == 's':
                    if self.ids['NF_Simulation_Normal2_Time'].text == '':
                        self.ids['NF_Simulation_Normal2_Time'].text = '0.001'
                    elif float(self.ids['NF_Simulation_Normal2_Time'].text) > 999.999:
                        self.ids['NF_Simulation_Normal2_Time'].text = '999.999'
                    elif float(self.ids['NF_Simulation_Normal2_Time'].text) < 0.001:
                        self.ids['NF_Simulation_Normal2_Time'].text = '0.001'
                elif self.ids['NF_Simulation_time_unit'].text == 'ms':
                    if self.ids['NF_Simulation_Normal2_Time'].text == '':
                        self.ids['NF_Simulation_Normal2_Time'].text = '1'
                    elif float(self.ids['NF_Simulation_Normal2_Time'].text) > 999999.9:
                        self.ids['NF_Simulation_Normal2_Time'].text = ' > 999999.9'
                    elif float(self.ids['NF_Simulation_Normal2_Time'].text) < 1:
                        self.ids['NF_Simulation_Normal2_Time'].text = '1'

                if self.ids['NF_Simulation_Normal2_Start_Phase'].text == '':
                    self.ids['NF_Simulation_Normal2_Start_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Normal2_Start_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Normal2_Start_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Normal2_Start_Phase'].text) < 0:
                    self.ids['NF_Simulation_Normal2_Start_Phase'].text = '0'

                if self.ids['NF_Simulation_Normal2_Off_Phase'].text == '':
                    self.ids['NF_Simulation_Normal2_Off_Phase'].text = '0'
                elif float(self.ids['NF_Simulation_Normal2_Off_Phase'].text) > 359.9:
                    self.ids['NF_Simulation_Normal2_Off_Phase'].text = '359.9'
                elif float(self.ids['NF_Simulation_Normal2_Off_Phase'].text) < 0:
                    self.ids['NF_Simulation_Normal2_Off_Phase'].text = '0'

    ####################################################################################

            else:
                assert False

            if self.instrument_config.NF.mode == 'Continuous':                
                send_data = self.instrument_config.NF.mode + ' ' + self.ids['NF_Continuous_Mode'].text + ' ' + self.ids['NF_Continuous_AC_Voltage'].text + ' ' + self.ids['NF_Continuous_Vrms_Limiter'].text + ' ' + self.ids['NF_Continuous_DC_Voltage'].text + ' ' + \
                            self.ids['NF_Continuous_Frequency'].text + ' ' + self.ids['NF_Continuous_Freq_Limiter_Low'].text + ' ' + self.ids['NF_Continuous_Freq_Limiter_High'].text + ' ' + str(self.ids['NF_Continuous_Current_Peak_Limiter_Checkbox'].active) + ' ' + \
                            str(self.ids['NF_Continuous_Current_rms_Limiter_Checkbox'].active) + ' ' + self.ids['NF_Continuous_Current_rms_Limiter'].text + ' ' + self.ids['NF_Continuous_Current_Peak_Limiter_Positive'].text + ' ' + self.ids['NF_Continuous_Current_Peak_Limiter_Negative'].text + ' ' + \
                            self.ids['NF_Continuous_Start_Phase'].text + ' ' + self.ids['NF_Continuous_Off_Phase'].text
            elif self.instrument_config.NF.mode == 'Sequence':
                send_data = self.instrument_config.NF.mode + ' ' + self.ids['NF_Sequence_time_unit'].text + ' ' + str(max_voltage) + ' ' + common_param_str + ' ' + step_param_str
            elif self.instrument_config.NF.mode == 'Simulation':
                send_data = self.instrument_config.NF.mode + ' ' + self.ids['NF_Simulation_repeat'].text + ' ' + self.ids['NF_Simulation_time_unit'].text + ' ' + str(max_voltage) + ' ' + self.ids['NF_Simulation_Initial_AC_Voltage'].text + ' ' + \
                            self.ids['NF_Simulation_Initial_Frequency'].text + ' ' + str(self.ids['NF_Simulation_Initial_Start_Phase_Enable'].active) + ' ' + self.ids['NF_Simulation_Initial_Start_Phase'].text + ' ' + str(self.ids['NF_Simulation_Initial_Off_Phase_Enable'].active) + ' ' + \
                            self.ids['NF_Simulation_Initial_Off_Phase'].text + ' ' + self.ids['NF_Simulation_Normal1_AC_Voltage'].text + ' ' + self.ids['NF_Simulation_Normal1_Frequency'].text + ' ' + self.ids['NF_Simulation_Normal1_Time'].text + ' ' + str(self.ids['NF_Simulation_Normal1_Start_Phase_Enable'].active) + ' ' + \
                            self.ids['NF_Simulation_Normal1_Start_Phase'].text + ' ' + str(self.ids['NF_Simulation_Normal1_Off_Phase_Enable'].active) + ' ' + self.ids['NF_Simulation_Normal1_Off_Phase'].text + ' ' + self.ids['NF_Simulation_Trans1_Time'].text + ' ' + \
                            self.ids['NF_Simulation_Abnormal_AC_Voltage'].text + ' ' + self.ids['NF_Simulation_Abnormal_Frequency'].text + ' ' + self.ids['NF_Simulation_Abnormal_Time'].text + ' ' + str(self.ids['NF_Simulation_Abnormal_Start_Phase_Enable'].active) + ' ' + \
                            self.ids['NF_Simulation_Abnormal_Start_Phase'].text + ' ' + str(self.ids['NF_Simulation_Abnormal_Off_Phase_Enable'].active) + ' ' + self.ids['NF_Simulation_Abnormal_Off_Phase'].text + ' ' + self.ids['NF_Simulation_Trans2_Time'].text + ' ' + \
                            self.ids['NF_Simulation_Normal2_Time'].text + ' ' + str(self.ids['NF_Simulation_Normal2_Start_Phase_Enable'].active) + ' ' + self.ids['NF_Simulation_Normal2_Start_Phase'].text + ' ' + str(self.ids['NF_Simulation_Normal2_Off_Phase_Enable'].active) + ' ' + \
                            self.ids['NF_Simulation_Normal2_Off_Phase'].text
            else:
                assert False
            
            self.remote_mode_create_socket(None)

            try:
                self.sever_PC.mySocket.send(('NF Start ' + send_data).encode('utf-8'))  
            except ConnectionResetError:
                self.sever_PC.mySocket.close()
                self.remote_mode_create_socket('NF Start' + send_data)                            

            resp, response = self.recv_data_from_sever()   

            if resp == 'done':
                pass
                Clock.schedule_interval(self.NF_task, 1)
            else:
                print(resp)
                assert False

    def NF_stop(self):

        if self.UI_system.remoteMode == False:
            if self.instrument_config.NF.DEV == None:
                self.instrument_config.NF.DEV = self.instrument_config.rm.open_resource(self.instrument_config.NF.port, read_termination ='\n')
            else:
                pass

            Clock.unschedule(self.NF_task)
            if self.instrument_config.NF.mode == 'Continuous': 
                pass
            elif self.instrument_config.NF.mode == 'Sequence':
                self.instrument_config.NF.DEV.write('TRIG:SEQ:SEL:EXEC STOP')
                self.NF_wait()
            elif self.instrument_config.NF.mode == 'Simulation':
                self.instrument_config.NF.DEV.write('TRIG:SEQ:SIM:EXEC STOP')
                self.NF_wait()
            else:
                assert False

            self.instrument_config.NF.DEV.write('OUTP 0')
        else: # self.UI_system.remoteMode == True
            Clock.unschedule(self.NF_task)
            self.remote_mode_create_socket(None)

            try:
                self.sever_PC.mySocket.send(('NF Stop ' + self.instrument_config.NF.mode).encode('utf-8'))
            except ConnectionResetError:
                self.sever_PC.mySocket.close()
                self.remote_mode_create_socket('NF Stop ' + self.instrument_config.NF.mode)         

            resp, response = self.recv_data_from_sever()  

            if resp == 'done':
                pass
            else:
                print(resp)
                assert False

    def NF_getReport(self, timeDiff):

        if self.UI_system.remoteMode == False:
            if self.instrument_config.NF.mode == 'Continuous':
                self.ids['NF_continuous_rpt_voltage_rms'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT?'))))

                self.ids['NF_continuous_rpt_voltage_avg'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT:AVE?'))))

                self.ids['NF_continuous_rpt_voltage_peak_max'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT:HIGH?'))))

                self.ids['NF_continuous_rpt_voltage_peak_min'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT:LOW?'))))

                self.ids['NF_continuous_rpt_current_rms'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR?'))))

                self.ids['NF_continuous_rpt_current_avg'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:AVE?'))))

                self.ids['NF_continuous_rpt_current_peak_max'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:HIGH?'))))

                self.ids['NF_continuous_rpt_current_peak_min'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:LOW?'))))

                self.ids['NF_continuous_rpt_appearant_power'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW:APP?'))))

                self.ids['NF_continuous_rpt_active_power'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW?'))))

                self.ids['NF_continuous_rpt_inactive_power'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW:REAC?'))))

                self.ids['NF_continuous_rpt_power_factor'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW:PFAC?'))))

                self.ids['NF_continuous_rpt_crest_factor'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:CFAC?'))))

                freq = self.instrument_config.NF.DEV.query('FREQ?')
                mode = self.instrument_config.NF.DEV.query('MODE?')
                if (float(freq) == 50 or float(freq) == 60) and mode == 'AC_INT':

                    self.instrument_config.NF.DEV.write('MEAS:CURR:HARM:ENAB 1')
                    self.NF_wait()

                    harmonic_current = self.instrument_config.NF.DEV.query('MEAS:CURR:HARM? 1').split(',')
                    harmonic_ratio = self.instrument_config.NF.DEV.query('MEAS:CURR:HARM:RAT? 1').split(',')
                    for idx in range(1, 11):
                        self.ids['NF_continuous_rpt_harmonic_current_' + str(idx)].text = str("{0:.2f}".format(float(harmonic_current[idx - 1])))
                        self.ids['NF_continuous_rpt_harmonic_ratio_' + str(idx)].text = str("{0:.2f}".format(float(harmonic_ratio[idx - 1])))

                    harmonic_current = self.instrument_config.NF.DEV.query('MEAS:CURR:HARM? 2').split(',')
                    harmonic_ratio = self.instrument_config.NF.DEV.query('MEAS:CURR:HARM:RAT? 2').split(',')
                    for idx in range(11, 21):
                        self.ids['NF_continuous_rpt_harmonic_current_' + str(idx)].text = str("{0:.2f}".format(float(harmonic_current[idx - 11])))
                        self.ids['NF_continuous_rpt_harmonic_ratio_' + str(idx)].text = str("{0:.2f}".format(float(harmonic_ratio[idx - 11])))      

                    harmonic_current = self.instrument_config.NF.DEV.query('MEAS:CURR:HARM? 3').split(',')
                    harmonic_ratio = self.instrument_config.NF.DEV.query('MEAS:CURR:HARM:RAT? 3').split(',')
                    for idx in range(21, 31):
                        self.ids['NF_continuous_rpt_harmonic_current_' + str(idx)].text = str("{0:.2f}".format(float(harmonic_current[idx - 21])))
                        self.ids['NF_continuous_rpt_harmonic_ratio_' + str(idx)].text = str("{0:.2f}".format(float(harmonic_ratio[idx - 21])))                     

                    harmonic_current = self.instrument_config.NF.DEV.query('MEAS:CURR:HARM? 4').split(',')
                    harmonic_ratio = self.instrument_config.NF.DEV.query('MEAS:CURR:HARM:RAT? 4').split(',')
                    for idx in range(31, 41):
                        self.ids['NF_continuous_rpt_harmonic_current_' + str(idx)].text = str("{0:.2f}".format(float(harmonic_current[idx - 31])))
                        self.ids['NF_continuous_rpt_harmonic_ratio_' + str(idx)].text = str("{0:.2f}".format(float(harmonic_ratio[idx - 31])))                     
                else:
                    for idx in range(1, 41):
                        self.ids['NF_continuous_rpt_harmonic_current_' + str(idx)].text = '--'
                        self.ids['NF_continuous_rpt_harmonic_ratio_' + str(idx)].text = '--'
            elif self.instrument_config.NF.mode == 'Sequence':

                self.ids['NF_sequence_rpt_state'].text = self.instrument_config.NF.DEV.query('SEQ:STEP?')

                self.ids['NF_sequence_rpt_voltage_rms'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT?'))))

                self.ids['NF_sequence_rpt_voltage_avg'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT:AVE?'))))

                self.ids['NF_sequence_rpt_voltage_peak_max'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT:HIGH?'))))

                self.ids['NF_sequence_rpt_voltage_peak_min'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT:LOW?'))))

                self.ids['NF_sequence_rpt_current_rms'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR?'))))

                self.ids['NF_sequence_rpt_current_avg'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:AVE?'))))

                self.ids['NF_sequence_rpt_current_peak_max'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:HIGH?'))))

                self.ids['NF_sequence_rpt_current_peak_min'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:LOW?'))))

                self.ids['NF_sequence_rpt_appearant_power'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW:APP?'))))

                self.ids['NF_sequence_rpt_active_power'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW?'))))

                self.ids['NF_sequence_rpt_inactive_power'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW:REAC?'))))

                self.ids['NF_sequence_rpt_power_factor'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW:PFAC?'))))

                self.ids['NF_sequence_rpt_crest_factor'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:CFAC?'))))

            elif self.instrument_config.NF.mode == 'Simulation':
                state = self.instrument_config.NF.DEV.query('SIM:CSTEP?')

                if state == '0':
                    self.ids['NF_simulation_rpt_state'].text = 'Initial'
                elif state == '1':
                    self.ids['NF_simulation_rpt_state'].text = 'Normal1'
                elif state == '2':
                    self.ids['NF_simulation_rpt_state'].text = 'Trans1'
                elif state == '3':
                    self.ids['NF_simulation_rpt_state'].text = 'Abnormal'
                elif state == '4':
                    self.ids['NF_simulation_rpt_state'].text = 'Trans2'
                elif state == '5':
                    self.ids['NF_simulation_rpt_state'].text = 'Normal2'
                else:
                    assert False

                self.ids['NF_simulation_rpt_voltage_rms'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT?'))))

                self.ids['NF_simulation_rpt_voltage_avg'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT:AVE?'))))

                self.ids['NF_simulation_rpt_voltage_peak_max'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT:HIGH?'))))

                self.ids['NF_simulation_rpt_voltage_peak_min'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:VOLT:LOW?'))))

                self.ids['NF_simulation_rpt_current_rms'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR?'))))

                self.ids['NF_simulation_rpt_current_avg'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:AVE?'))))

                self.ids['NF_simulation_rpt_current_peak_max'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:HIGH?'))))

                self.ids['NF_simulation_rpt_current_peak_min'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:LOW?'))))

                self.ids['NF_simulation_rpt_appearant_power'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW:APP?'))))

                self.ids['NF_simulation_rpt_active_power'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW?'))))

                self.ids['NF_simulation_rpt_inactive_power'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW:REAC?'))))

                self.ids['NF_simulation_rpt_power_factor'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:POW:PFAC?'))))

                self.ids['NF_simulation_rpt_crest_factor'].text = str("{0:.2f}".format(float(self.instrument_config.NF.DEV.query('MEAS:CURR:CFAC?'))))

            else:
                assert False
        else: # self.UI_system.remoteMode == True
            self.remote_mode_create_socket(None)

            try:
                self.sever_PC.mySocket.send(('NF Get ' + self.instrument_config.NF.mode).encode('utf-8'))
            except ConnectionResetError:
                self.sever_PC.mySocket.close()
                self.remote_mode_create_socket('NF Get ' + self.instrument_config.NF.mode)          

            resp, response = self.recv_data_from_sever()   

            if self.instrument_config.NF.mode == 'Continuous':
                self.ids['NF_continuous_rpt_voltage_rms'].text = response[0]

                self.ids['NF_continuous_rpt_voltage_avg'].text = response[1]

                self.ids['NF_continuous_rpt_voltage_peak_max'].text = response[2]

                self.ids['NF_continuous_rpt_voltage_peak_min'].text = response[3]

                self.ids['NF_continuous_rpt_current_rms'].text = response[4]

                self.ids['NF_continuous_rpt_current_avg'].text = response[5]

                self.ids['NF_continuous_rpt_current_peak_max'].text = response[6]

                self.ids['NF_continuous_rpt_current_peak_min'].text = response[7]

                self.ids['NF_continuous_rpt_appearant_power'].text = response[8]

                self.ids['NF_continuous_rpt_active_power'].text = response[9]

                self.ids['NF_continuous_rpt_inactive_power'].text = response[10]

                self.ids['NF_continuous_rpt_power_factor'].text = response[11]

                self.ids['NF_continuous_rpt_crest_factor'].text = response[12]

                for idx in range(1, 41):
                    self.ids['NF_continuous_rpt_harmonic_current_' + str(idx)].text = response[12 + (2 * idx - 1)]
                    self.ids['NF_continuous_rpt_harmonic_ratio_' + str(idx)].text = response[12 + (2 * idx - 1) + 1]

            elif self.instrument_config.NF.mode == 'Sequence':

                self.ids['NF_sequence_rpt_state'].text = response[0]

                self.ids['NF_sequence_rpt_voltage_rms'].text = response[1]

                self.ids['NF_sequence_rpt_voltage_avg'].text = response[2]

                self.ids['NF_sequence_rpt_voltage_peak_max'].text = response[3]

                self.ids['NF_sequence_rpt_voltage_peak_min'].text = response[4]

                self.ids['NF_sequence_rpt_current_rms'].text = response[5]

                self.ids['NF_sequence_rpt_current_avg'].text = response[6]

                self.ids['NF_sequence_rpt_current_peak_max'].text = response[7]

                self.ids['NF_sequence_rpt_current_peak_min'].text = response[8]

                self.ids['NF_sequence_rpt_appearant_power'].text = response[9]

                self.ids['NF_sequence_rpt_active_power'].text = response[10]

                self.ids['NF_sequence_rpt_inactive_power'].text = response[11]

                self.ids['NF_sequence_rpt_power_factor'].text = response[12]

                self.ids['NF_sequence_rpt_crest_factor'].text = response[13]

            elif self.instrument_config.NF.mode == 'Simulation':

                self.ids['NF_simulation_rpt_state'].text = response[0]

                self.ids['NF_simulation_rpt_voltage_rms'].text = response[1]

                self.ids['NF_simulation_rpt_voltage_avg'].text = response[2]

                self.ids['NF_simulation_rpt_voltage_peak_max'].text = response[3]

                self.ids['NF_simulation_rpt_voltage_peak_min'].text = response[4]

                self.ids['NF_simulation_rpt_current_rms'].text = response[5]

                self.ids['NF_simulation_rpt_current_avg'].text = response[6]

                self.ids['NF_simulation_rpt_current_peak_max'].text = response[7]

                self.ids['NF_simulation_rpt_current_peak_min'].text = response[8]

                self.ids['NF_simulation_rpt_appearant_power'].text = response[9]

                self.ids['NF_simulation_rpt_active_power'].text = response[10]

                self.ids['NF_simulation_rpt_inactive_power'].text = response[11]

                self.ids['NF_simulation_rpt_power_factor'].text = response[12]

                self.ids['NF_simulation_rpt_crest_factor'].text = response[13]

            else:
                assert False

    def NF_continuous_mode_change(self, mode):
        
        if mode == 'AC':
            self.ids['NF_Continuous_DC_Voltage_lbl'].text = '[color=404040]DC Voltage (V)[/color]'
        elif mode == 'ACDC':
            self.ids['NF_Continuous_DC_Voltage_lbl'].text = '[color=ffffff]DC Voltage (V)[/color]'
        else:
            assert False

    def NF_simulation_checkbox(self, active, ids):

        for id in ids:
            text = re.search('\](.*)\[', self.ids[id].text).group(0)

            if active == True:
                self.ids[id].text = '[color=ffffff' + text + '/color]'
            elif active == False:
                self.ids[id].text = '[color=404040' + text + '/color]'
            else:
                assert False

    def NF_Simulation_Time_Unit(self, text):
        if text == 's':
            self.ids['NF_Simulation_Initial_Time_lbl'].text = self.ids['NF_Simulation_Initial_Time_lbl'].text.replace('(ms)', '(s)')
            self.ids['NF_Simulation_Normal1_Time_lbl'].text = self.ids['NF_Simulation_Normal1_Time_lbl'].text.replace('(ms)', '(s)')
            self.ids['NF_Simulation_Trans1_Time_lbl'].text = self.ids['NF_Simulation_Trans1_Time_lbl'].text.replace('(ms)', '(s)')
            self.ids['NF_Simulation_Abnormal_Time_lbl'].text = self.ids['NF_Simulation_Abnormal_Time_lbl'].text.replace('(ms)', '(s)')
            self.ids['NF_Simulation_Trans2_Time_lbl'].text = self.ids['NF_Simulation_Trans2_Time_lbl'].text.replace('(ms)', '(s)')
            self.ids['NF_Simulation_Normal2_Time_lbl'].text = self.ids['NF_Simulation_Normal2_Time_lbl'].text.replace('(ms)', '(s)')
        elif text == 'ms':
            self.ids['NF_Simulation_Initial_Time_lbl'].text = self.ids['NF_Simulation_Initial_Time_lbl'].text.replace('(s)', '(ms)')
            self.ids['NF_Simulation_Normal1_Time_lbl'].text = self.ids['NF_Simulation_Normal1_Time_lbl'].text.replace('(s)', '(ms)')
            self.ids['NF_Simulation_Trans1_Time_lbl'].text = self.ids['NF_Simulation_Trans1_Time_lbl'].text.replace('(s)', '(ms)')
            self.ids['NF_Simulation_Abnormal_Time_lbl'].text = self.ids['NF_Simulation_Abnormal_Time_lbl'].text.replace('(s)', '(ms)')
            self.ids['NF_Simulation_Trans2_Time_lbl'].text = self.ids['NF_Simulation_Trans2_Time_lbl'].text.replace('(s)', '(ms)')
            self.ids['NF_Simulation_Normal2_Time_lbl'].text = self.ids['NF_Simulation_Normal2_Time_lbl'].text.replace('(s)', '(ms)')
        else:
            assert False

    def NF_simulation_normal2_text_sync(self):
        self.ids['NF_Simulation_Normal2_AC_Voltage'].text = self.ids['NF_Simulation_Normal1_AC_Voltage'].text
        self.ids['NF_Simulation_Normal2_Frequency'].text = self.ids['NF_Simulation_Normal1_Frequency'].text

    def NF_sequence_mode_change(self, mode):

        for idx in range(self.instrument_config.NF.simulation_step_number):
            if mode == 'AC':
                self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_lbl'].text = '[color=404040]DC Voltage (V)[/color]'
            elif mode == 'ACDC':
                self.ids['NF_Sequence_Step' + str(idx) + '_DC_Voltage_lbl'].text = '[color=ffffff]DC Voltage (V)[/color]'
            else:
                assert False

    def NF_Sequence_Time_Unit(self, text):

        if text == 's':
            for idx in range(self.instrument_config.NF.simulation_step_number):
                self.ids['NF_Sequence_Step' + str(idx) + '_Time_lbl'].text = self.ids['NF_Sequence_Step' + str(idx) + '_Time_lbl'].text.replace('(ms)', '(s)')
        elif text == 'ms':
            for idx in range(self.instrument_config.NF.simulation_step_number):
                self.ids['NF_Sequence_Step' + str(idx) + '_Time_lbl'].text = self.ids['NF_Sequence_Step' + str(idx) + '_Time_lbl'].text.replace('(s)', '(ms)')
        else:
            assert False

    def MDO4034C_wait(self):
        
        while self.instrument_config.MDO4034C.DEV.query('*OPC?') != '1':
            print('waiting for system done')

    def MDO4034C_task(self, timeDiff):

        start = default_timer()

        thread_MDO4034C_get_report = threading.Thread(target=self.MDO4034C_getReport, args=(timeDiff,))
        thread_MDO4034C_get_report.start()    

        print('MDO4034C get report time : {}'.format(default_timer() - start))

    def MDO4034C_run(self):

        Clock.unschedule(self.MDO4034C_task)

        if self.UI_system.remoteMode == False:
            if self.instrument_config.MDO4034C.DEV == None:
                self.instrument_config.MDO4034C.DEV = self.instrument_config.rm.open_resource(self.instrument_config.MDO4034C.port, read_termination ='\n')
            else:
                pass

            if self.ids['MDO4034C_Length'].text == '1000':
                self.instrument_config.MDO4034C.DEV.write('HOR:RECO 1000')
            elif self.ids['MDO4034C_Length'].text == '10000':
                self.instrument_config.MDO4034C.DEV.write('HOR:RECO 10000')
            elif self.ids['MDO4034C_Length'].text == '100000':
                self.instrument_config.MDO4034C.DEV.write('HOR:RECO 100000')                        
            elif self.ids['MDO4034C_Length'].text == '1M':
                self.instrument_config.MDO4034C.DEV.write('HOR:RECO 1000000')
            elif self.ids['MDO4034C_Length'].text == '5M':
                self.instrument_config.MDO4034C.DEV.write('HOR:RECO 5000000')               
            elif self.ids['MDO4034C_Length'].text == '10M':
                self.instrument_config.MDO4034C.DEV.write('HOR:RECO 10000000')
            elif self.ids['MDO4034C_Length'].text == '20M':
                self.instrument_config.MDO4034C.DEV.write('HOR:RECO 20000000')                                        
            else:
                assert False
            self.MDO4034C_wait()  

            if self.ids['MDO4034C_Scale_Unit'].text == 's':
                self.instrument_config.MDO4034C.DEV.write('HOR:SCA ' + self.ids['MDO4034C_Scale'].text)
            elif self.ids['MDO4034C_Scale_Unit'].text == 'ms':
                self.instrument_config.MDO4034C.DEV.write('HOR:SCA ' + self.ids['MDO4034C_Scale'].text + 'E-3')
            elif self.ids['MDO4034C_Scale_Unit'].text == 'us':
                self.instrument_config.MDO4034C.DEV.write('HOR:SCA ' + self.ids['MDO4034C_Scale'].text + 'E-6')
            elif self.ids['MDO4034C_Scale_Unit'].text == 'ns':
                self.instrument_config.MDO4034C.DEV.write('HOR:SCA ' + self.ids['MDO4034C_Scale'].text + 'E-9')
            else:
                assert False
            self.MDO4034C_wait() 

            for idx in range(1, 5):

                self.instrument_config.MDO4034C.DEV.write('SEL:CH' + str(idx) + ' 1')

                if self.ids['MDO4034C_Ch' + str(idx) + '_Enable'].active == True:
                    self.ids['MDO4034C_Ch' + str(idx) + '_Label'].text = '[color=ffffff]CH' + str(idx) + '[/color]'
                    
                    if self.ids['MDO4034C_Ch' + str(idx) + '_Coupling'].text == 'DC':
                        self.instrument_config.MDO4034C.DEV.write('CH' + str(idx) + ':COUP DC')
                    elif self.ids['MDO4034C_Ch' + str(idx) + '_Coupling'].text == 'AC':
                        self.instrument_config.MDO4034C.DEV.write('CH' + str(idx) + ':COUP AC')
                    else:
                        assert False
                    self.MDO4034C_wait()
                    
                    if self.ids['MDO4034C_Ch' + str(idx) + '_Termination'].text == '1M':
                        self.instrument_config.MDO4034C.DEV.write('CH' + str(idx) + ':TER MEG')
                    elif self.ids['MDO4034C_Ch' + str(idx) + '_Termination'].text == '50':
                        self.instrument_config.MDO4034C.DEV.write('CH' + str(idx) + ':TER FIF')
                    else:
                        assert False
                    self.MDO4034C_wait()                    

                    if self.ids['MDO4034C_Ch' + str(idx) + '_Invert'].text == 'ON':
                        self.instrument_config.MDO4034C.DEV.write('CH' + str(idx) + ':INV ON')
                    elif self.ids['MDO4034C_Ch' + str(idx) + '_Invert'].text == 'OFF':
                        self.instrument_config.MDO4034C.DEV.write('CH' + str(idx) + ':INV OFF')
                    else:
                        assert False
                    self.MDO4034C_wait()    

                    if self.ids['MDO4034C_Ch' + str(idx) + '_Bandwidth'].text == '350':
                        self.instrument_config.MDO4034C.DEV.write('CH' + str(idx) + ':BAN FUL')
                    elif self.ids['MDO4034C_Ch' + str(idx) + '_Bandwidth'].text == '250':
                        self.instrument_config.MDO4034C.DEV.write('CH' + str(idx) + ':BAN 250000000')
                    elif self.ids['MDO4034C_Ch' + str(idx) + '_Bandwidth'].text == '20':
                        self.instrument_config.MDO4034C.DEV.write('CH' + str(idx) + ':BAN 20000000')                        
                    else:
                        assert False
                    self.MDO4034C_wait()  

                else:
                    pass

            self.instrument_config.MDO4034C.DEV.write('ACQ:STATE 1')

            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS1:STATE ON')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS2:STATE ON')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS3:STATE ON')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS4:STATE ON')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS5:STATE ON')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS6:STATE ON')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS7:STATE ON')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS8:STATE ON')
            self.MDO4034C_wait()

            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS1:TYPE FREQ')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS2:TYPE RMS')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS3:TYPE MAX')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS4:TYPE MINI')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS5:TYPE FREQ')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS6:TYPE RMS')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS7:TYPE MAX')
            self.MDO4034C_wait()
            self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS8:TYPE MINI')
            self.MDO4034C_wait()

        else: # self.UI_system.remoteMode == True
            pass

        Clock.schedule_interval(self.MDO4034C_task, 1)

    def MDO4034C_stop(self):

        Clock.unschedule(self.MDO4034C_task)

        if self.UI_system.remoteMode == False:
            if self.instrument_config.MDO4034C.DEV == None:
                self.instrument_config.MDO4034C.DEV = self.instrument_config.rm.open_resource(self.instrument_config.MDO4034C.port, read_termination ='\n')
            else:
                pass

            self.instrument_config.MDO4034C.DEV.write('ACQ:STATE 0')
            self.MDO4034C_wait()   

            self.MDO4034C_getReport(None)

        else: # self.UI_system.remoteMode == True
            pass

    def MDO4034C_getReport(self, timeDiff):

        if self.UI_system.remoteMode == False:

            meas_idx = 0
            for idx in range(1, 5):
                
                if self.ids['MDO4034C_Ch' + str(idx) + '_Measure'].active == True:

                    if meas_idx == 0:
                        self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS1:SOU CH' + str(idx))
                        self.MDO4034C_wait()
                        self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS2:SOU CH' + str(idx))
                        self.MDO4034C_wait()
                        self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS3:SOU CH' + str(idx))
                        self.MDO4034C_wait()
                        self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS4:SOU CH' + str(idx))
                        self.MDO4034C_wait()           

                        freq = self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS1:VAL?').split()[1]
                        if 'E' in freq:
                            val = freq.split('E')
                            freq = float(val[0]) * (10**float(val[1]))
                        else:
                            pass
                        self.ids['MDO4034C_Frequency_Ch' + str(idx)].text = str("{0:.2f}".format(float(freq)))
                        # print(self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS1:COUN?'))

                        rms = self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS2:VAL?').split()[1]
                        if 'E' in rms:
                            val = rms.split('E')
                            rms = float(val[0]) * (10**float(val[1]))
                        else:
                            pass
                        self.ids['MDO4034C_Rms_Ch' + str(idx)].text = str("{0:.2f}".format(float(rms)))
                        # print(self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS2:COUN?'))

                        maximum = self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS3:VAL?').split()[1]
                        if 'E' in maximum:
                            val = maximum.split('E')
                            maximum = float(val[0]) * (10**float(val[1]))
                        else:
                            pass
                        self.ids['MDO4034C_Max_Ch' + str(idx)].text = str("{0:.2f}".format(float(maximum)))
                        # print(self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS3:COUN?'))

                        minimum = self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS4:VAL?').split()[1]
                        if 'E' in minimum:
                            val = minimum.split('E')
                            minimum = float(val[0]) * (10**float(val[1]))
                        else:
                            pass
                        self.ids['MDO4034C_Min_Ch' + str(idx)].text = str("{0:.2f}".format(float(minimum)))
                        # print(self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS4:COUN?'))
                    elif meas_idx == 1:
                        self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS5:SOU CH' + str(idx))
                        self.MDO4034C_wait()
                        self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS6:SOU CH' + str(idx))
                        self.MDO4034C_wait() 
                        self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS7:SOU CH' + str(idx))
                        self.MDO4034C_wait()
                        self.instrument_config.MDO4034C.DEV.write('MEASU:MEAS8:SOU CH' + str(idx))
                        self.MDO4034C_wait()           

                        freq = self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS5:VAL?').split()[1]
                        
                        if 'E' in freq:
                            val = freq.split('E')
                            freq = float(val[0]) * (10**float(val[1]))
                        else:
                            pass
                        self.ids['MDO4034C_Frequency_Ch' + str(idx)].text = str("{0:.2f}".format(float(freq)))
                        # print(self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS1:COUN?'))

                        rms = self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS6:VAL?').split()[1]
                        if 'E' in rms:
                            val = rms.split('E')
                            rms = float(val[0]) * (10**float(val[1]))
                        else:
                            pass
                        self.ids['MDO4034C_Rms_Ch' + str(idx)].text = str("{0:.2f}".format(float(rms)))
                        # print(self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS2:COUN?'))

                        maximum = self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS7:VAL?').split()[1]
                        if 'E' in maximum:
                            val = maximum.split('E')
                            maximum = float(val[0]) * (10**float(val[1]))
                        else:
                            pass
                        self.ids['MDO4034C_Max_Ch' + str(idx)].text = str("{0:.2f}".format(float(maximum)))
                        # print(self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS3:COUN?'))

                        minimum = self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS8:VAL?').split()[1]
                        if 'E' in minimum:
                            val = minimum.split('E')
                            minimum = float(val[0]) * (10**float(val[1]))
                        else:
                            pass
                        self.ids['MDO4034C_Min_Ch' + str(idx)].text = str("{0:.2f}".format(float(minimum)))
                        # print(self.instrument_config.MDO4034C.DEV.query('MEASU:MEAS4:COUN?'))
                        
                    else:
                        assert False

                    meas_idx = meas_idx + 1
                else:
                    self.instrument_config.MDO4034C.DEV.write('SEL:CH' + str(idx) + ' 0')
                    self.ids['MDO4034C_Ch' + str(idx) + '_Label'].text = '[color=404040]CH' + str(idx) + '[/color]'
                    self.ids['MDO4034C_Frequency_Ch' + str(idx)].text = '--'
                    self.ids['MDO4034C_Rms_Ch' + str(idx)].text = '--'
                    self.ids['MDO4034C_Max_Ch' + str(idx)].text = '--'
                    self.ids['MDO4034C_Min_Ch' + str(idx)].text = '--'

            length = self.instrument_config.MDO4034C.DEV.query('HOR:RECO?').split()[1]
            if 'E' in length:
                val = length.split('E')
                length = float(val[0]) * (10**float(val[1]))
            else:
                pass
            self.ids['MDO4034C_Length_rpt'].text = str("{0:.0f}".format(float(length)))
            scale = self.instrument_config.MDO4034C.DEV.query('HOR:SCA?').split()[1]
            if 'E' in scale:
                val = scale.split('E')
                scale = float(val[0]) * (10**float(val[1]))
            else:
                pass            
            self.ids['MDO4034C_Scale_rpt'].text = str("{0:.2f}".format(float(scale)))
            fs = self.instrument_config.MDO4034C.DEV.query('HOR:SAMPLER?').split()[1]
            if 'E' in fs:
                val = fs.split('E')
                fs = float(val[0]) * (10**float(val[1]))
            else:
                pass                
            self.ids['MDO4034C_Sample_Rate'].text = str("{0:.2f}".format(float(fs)))

        else: # self.UI_system.remoteMode == True
            pass

    def MDO4034C_enable_active(self, id, ch):
        
        if self.ids[id].active == False:
            self.ids['MDO4034C_Ch' + str(ch) + '_Measure'].active = False
        else:
            pass

    def MDO4034C_meas_enable_active(self, id, ch):
        
        if self.ids['MDO4034C_Ch' + str(ch) + '_Enable'].active == False:
            self.ids[id].active = False
        elif self.ids[id].active == True:
            count = 0
            for idx in range(1,5):
                if self.ids['MDO4034C_Ch' + str(idx) + '_Measure'].active == True:
                    count = count + 1
                else:
                    pass
            
            if count >= 3:
                self.ids[id].active = False
        else:
            pass

    def T_Machine_task(self, timeDiff):

        start = default_timer()

        thread_T_Machine_get_report = threading.Thread(target=self.T_Machine_getReport, args=(timeDiff,))
        thread_T_Machine_get_report.start()    

        print('T_Machine get report time : {}'.format(default_timer() - start))

    def T_Machine_start(self):

        Clock.unschedule(self.T_Machine_task)

        if self.UI_system.remoteMode == False:

            while self.instrument_config.T_Machine.under_process_flag == True:
                pass

            self.instrument_config.T_Machine.under_process_flag = True

            if self.instrument_config.T_Machine.DEV == None:
                self.instrument_config.T_Machine.DEV = ModbusClient(method = "rtu", port=self.instrument_config.T_Machine.port,stopbits = 1, bytesize = 8, parity = 'N', baudrate= 9600, timeout= 1)
                connection = self.instrument_config.T_Machine.DEV.connect()
            else:
                pass

            if float(self.ids['T_Machine_Temperature'].text) < -45:
                self.ids['T_Machine_Temperature'].text = -45
            elif float(self.ids['T_Machine_Temperature'].text) > 105:
                self.ids['T_Machine_Temperature'].text = 105
            else:
                pass

            if float(self.ids['T_Machine_Humidity'].text) < 0:
                self.ids['T_Machine_Humidity'].text = 0
            elif float(self.ids['T_Machine_Humidity'].text) > 100:
                self.ids['T_Machine_Humidity'].text = 100
            else:
                pass

            self.ids['T_Machine_Temperature'].text = str("{0:.2f}".format(float(self.ids['T_Machine_Temperature'].text)))
            self.ids['T_Machine_Humidity'].text = str("{0:.1f}".format(float(self.ids['T_Machine_Humidity'].text)))

            temperature = int(float(self.ids['T_Machine_Temperature'].text) * 100)
            self.instrument_config.T_Machine.DEV.write_register(address= 0x65, value= temperature, unit=1)

            humidity = int(float(self.ids['T_Machine_Humidity'].text) * 10)
            self.instrument_config.T_Machine.DEV.write_register(address= 0x66, value= humidity, unit=1)

            # set fix mode
            self.instrument_config.T_Machine.DEV.write_register(address= 0x67, value= 1, unit=1)
            # set power mode to stop
            self.instrument_config.T_Machine.DEV.write_register(address= 0x68, value= 0, unit=1)
            # set OP time off
            self.instrument_config.T_Machine.DEV.write_register(address= 0x6D, value= 0, unit=1)
            # set reservation off
            self.instrument_config.T_Machine.DEV.write_register(address= 0xC7, value= 0, unit=1)

            # set temperature slope
            self.instrument_config.T_Machine.DEV.write_register(address= 0x69, value= 10, unit=1)
            # set humidity slope
            self.instrument_config.T_Machine.DEV.write_register(address= 0x6A, value= 10, unit=1)

            # start OP
            self.instrument_config.T_Machine.DEV.write_register(address= 0x64, value= 1, unit=1)

            self.instrument_config.T_Machine.under_process_flag = False

        else: # self.UI_system.remoteMode == True:
            pass

        Clock.schedule_interval(self.T_Machine_task, 5)

    def T_Machine_stop(self):

        Clock.unschedule(self.T_Machine_task)

        if self.UI_system.remoteMode == False:

            while self.instrument_config.T_Machine.under_process_flag == True:
                pass

            self.instrument_config.T_Machine.under_process_flag = True

            if self.instrument_config.T_Machine.DEV == None:
                self.instrument_config.T_Machine.DEV = ModbusClient(method = "rtu", port=self.instrument_config.T_Machine.port,stopbits = 1, bytesize = 8, parity = 'N', baudrate= 9600, timeout= 1)
                connection = self.instrument_config.T_Machine.DEV.connect()
            else:
                pass

            # stop OP
            self.instrument_config.T_Machine.DEV.write_register(address= 0x64, value= 4, unit=1)

            self.instrument_config.T_Machine.under_process_flag = False
        else:
            pass

    def T_Machine_getReport(self, timeDiff):

        if self.UI_system.remoteMode == False:

            while self.instrument_config.T_Machine.under_process_flag == True:
                pass

            self.instrument_config.T_Machine.under_process_flag = True

            resp = self.instrument_config.T_Machine.DEV.read_holding_registers(address= 0x0, count= 1, unit=1)
            temperature_current = resp.registers[0]
            self.ids['T_Machine_Temperature_Current'].text = str("{0:.2f}".format(float(temperature_current) / 100))

            resp = self.instrument_config.T_Machine.DEV.read_holding_registers(address= 0x1, count= 1, unit=1)
            temperature_sp = resp.registers[0]
            self.ids['T_Machine_Temperature_Set_Point'].text = str("{0:.2f}".format(float(temperature_sp) / 100))

            resp = self.instrument_config.T_Machine.DEV.read_holding_registers(address= 0x23, count= 1, unit=1)
            temperature_tsp = resp.registers[0]
            self.ids['T_Machine_Temperature_Target_Set_Point'].text = str("{0:.2f}".format(float(temperature_tsp) / 100))

            resp = self.instrument_config.T_Machine.DEV.read_holding_registers(address= 0x6, count= 1, unit=1)
            temperature_output = resp.registers[0]
            self.ids['T_Machine_Temperature_Output'].text = str("{0:.1f}".format(float(temperature_output) / 10))

            resp = self.instrument_config.T_Machine.DEV.read_holding_registers(address= 0x4, count= 1, unit=1)
            humidity_current = resp.registers[0]
            self.ids['T_Machine_Humidity_Current'].text = str("{0:.1f}".format(float(humidity_current) / 10))

            resp = self.instrument_config.T_Machine.DEV.read_holding_registers(address= 0x5, count= 1, unit=1)
            humidity_sp = resp.registers[0]
            self.ids['T_Machine_Humidity_Set_Point'].text = str("{0:.1f}".format(float(humidity_sp) / 10))

            resp = self.instrument_config.T_Machine.DEV.read_holding_registers(address= 0x25, count= 1, unit=1)
            humidity_tsp = resp.registers[0]
            self.ids['T_Machine_Humidity_Target_Set_Point'].text = str("{0:.1f}".format(float(humidity_tsp) / 10))

            resp = self.instrument_config.T_Machine.DEV.read_holding_registers(address= 0x7, count= 1, unit=1)
            humidity_output = resp.registers[0]
            self.ids['T_Machine_Humidity_Output'].text = str("{0:.1f}".format(float(humidity_output) / 10))

            self.instrument_config.T_Machine.under_process_flag = False

        else: # self.UI_system.remoteMode == True
            pass

presentation = Builder.load_string(r'''
#:kivy 1.0

Main:

    TabbedPanel:
        size_hint: 1, 1
        do_default_tab: False
        
        tab_height: 20 

        TabbedPanelItem:
            
            text: '設定'
            font_name: './arialuni.ttf'
            background_down: r'.\tabDown.PNG'
            background_normal: r'.\tabNormal.png'   
            on_release: root.TabbedPanel_choosed('設定')

            canvas.before:
                Color: 
                    group: 'Color'
                    rgba: (.2, .2, .2, 1)
                Rectangle: 
                    pos: self.x, self.y
                    size: self.width, self.height  

            TabbedPanel:
                size_hint: 1, 1
                do_default_tab: False
                
                tab_height: 20 

                TabbedPanelItem:
                    
                    text: '實驗設定'
                    font_name: './arialuni.ttf'
                    background_down: r'.\tabNormal.png'
                    background_normal: r'.\tabDown.PNG'

                    canvas.before:
                        Color: 
                            group: 'Color'
                            rgba: (.2, .2, .2, 1)
                        Rectangle: 
                            pos: self.x, self.y
                            size: self.width, self.height  

                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint: 1, 1         

                        BoxLayout:
                            orientation: 'vertical'
                            size_hint: 1, 1         

                            AnchorLayout:
                                size_hint: 1, .9
                                anchor_x: 'center'
                                anchor_y: 'top'   

                                GridLayout:
                                    cols: 4
                                    size_hint: .99, 1
                                    canvas.before:
                                        Color: 
                                            group: 'Color'
                                            rgba: (0, 0, 0, 1)
                                        Rectangle: 
                                            pos: self.x, self.y
                                            size: self.width, self.height                  

                                    Label:
                                        id: lbl_test_name
                                        text: '實驗名稱'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: test_name
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2   
                                            font_size: root.font_size.experiment_setting_font_size   
                                            on_text: root.experiment_setting_cfg_name()
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1

                                    Label:
                                        id: lbl_machine_type_number
                                        text: '機型編號'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: machine_type_number
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2   
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1

                                    Label:
                                        id: lbl_outdoor_machine_name
                                        text: '室外機'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: outdoor_machine_name
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2      
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_compressor_type_number
                                        text: '壓縮機型號規格'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: compressor_type_number
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2   
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_outdoor_machine_power
                                        text: '室外機電源'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        Spinner:
                                            id: outdoor_machine_power
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            values: ['1', '2', '3', '4']
                                            font_size: root.font_size.experiment_setting_font_size

                                    Label:
                                        id: lbl_compressor_capacitor
                                        text: '壓縮機電容器'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: compressor_capacitor
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2   
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_outdoor_motor_type_number
                                        text: '室外馬達型號規格'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: outdoor_motor_type_number
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2   
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_condenser_type_number
                                        text: '冷凝器型號規格'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12     
                                        anchor_x: 'left' 

                                        TextInput:
                                            id: condenser_type_number
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2   
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_outdoor_motor_speed
                                        text: '室外馬達轉速'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left' 

                                        TextInput:
                                            id: outdoor_motor_speed
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2   
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_evaporator_type_number
                                        text: '蒸發器型號規格'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left' 

                                        TextInput:
                                            id: evaporator_type_number
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2   
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_indoor_machine_name
                                        text: '室內機'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: indoor_machine_name
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2      
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_capillary_type_number
                                        text: '毛細管規格'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: capillary_type_number
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_indoor_motor_type_number
                                        text: '室內馬達型號規格'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: indoor_motor_type_number
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2   
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_power_spec
                                        text: '電源規格'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: power_spec
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2 
                                            font_size: root.font_size.experiment_setting_font_size 
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_indoor_motor_speed
                                        text: '室內馬達轉速'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left' 

                                        TextInput:
                                            id: indoor_motor_speed
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2   
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_refrigerant
                                        text: '冷煤量'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left' 

                                        TextInput:
                                            id: refrigerant
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_wind_hole_choose
                                        text: '風洞選擇'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left' 

                                        Spinner:
                                            id: wind_hole_choose
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            values: ['1', '2', '3', '4']
                                            font_size: root.font_size.experiment_setting_font_size

                                    Label:
                                        id: lbl_wind_hole_power
                                        text: '風洞電源'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        Spinner:
                                            id: wind_hole_power
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            values: ['1', '2', '3', '4']
                                            font_size: root.font_size.experiment_setting_font_size

                                    Label:
                                        id: lbl_rated_cooling_capacity
                                        text: '標示冷房能力'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left' 

                                        TextInput:
                                            id: rated_cooling_capacity
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_rated_warming_capacity
                                        text: '標示暖房能力'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: rated_warming_capacity
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_rated_cooling_eer
                                        text: '標示冷房EER'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: rated_cooling_eer
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_rated_warming_eer
                                        text: '標示暖房EER'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left' 

                                        TextInput:
                                            id: rated_warming_eer
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_rated_cooling_power
                                        text: '標示冷房電力'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left' 

                                        TextInput:
                                            id: rated_cooling_power
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                                    Label:
                                        id: lbl_rated_warming_power
                                        text: '標示暖房電力'
                                        font_name: './arialuni.ttf'
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12
                                        font_size: root.font_size.experiment_setting_font_size

                                    AnchorLayout:
                                        size_hint: .5, None  
                                        height: self.parent.parent.height / 12      
                                        anchor_x: 'left'

                                        TextInput:
                                            id: rated_warming_power
                                            text: 'None'
                                            size_hint: .9, .8
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.experiment_setting_font_size
                                            background_color: (.1, .1, .1, 1)
                                            foreground_color: (1, 1, 1, 1)

                                            canvas.after:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x,self.y,self.width-2,self.height-2
                                                    width: 1.1
                                                    
                            BoxLayout:
                                orientation: 'horizontal'
                                size_hint: 1, .1

                                AnchorLayout:
                                    size_hint: .33, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center'    

                                    Button:
                                        id: btn_experiment_setting_load
                                        size_hint: .5, .5
                                        text: 'Load'
                                        font_size: root.font_size.experiment_setting_font_size
                                        on_release: root.loadExpCfg()

                                AnchorLayout:
                                    size_hint: .33, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center'    

                                    Button:
                                        id: btn_experiment_setting_save
                                        size_hint: .5, .5
                                        text: 'Save'
                                        font_size: root.font_size.experiment_setting_font_size
                                        on_release: root.save_experiment_setting_cfg()

                                BoxLayout:
                                    orientation: 'vertical'
                                    size_hint: .33, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center'    

                                    Label:
                                        size_hint: 1, .3
                                        text: 'Saved Config Name:'

                                    AnchorLayout:
                                        size_hint: 1, .7
                                        anchor_x: 'center'
                                        anchor_y: 'top' 

                                        TextInput:
                                            size_hint: .6, .8
                                            id: experiment_setting_save_cfg
                                            text: 'Default'
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.experiment_setting_font_size

                TabbedPanelItem:
                    
                    text: '環境設定'
                    font_name: './arialuni.ttf'
                    background_down: r'.\tabNormal.png'
                    background_normal: r'.\tabDown.PNG'

                    canvas.before:
                        Color: 
                            group: 'Color'
                            rgba: (.2, .2, .2, 1)
                        Rectangle: 
                            pos: self.x, self.y
                            size: self.width, self.height  

                    BoxLayout:
                        orientation: 'horizontal'
                        size_hint: 1, 1         

                        BoxLayout:
                            orientation: 'vertical'
                            size_hint: 1, 1         

                            Label:
                                text: '    工況設定'
                                size_hint: None, None
                                size: self.texture_size
                                font_name: './arialuni.ttf'

                            AnchorLayout:
                                size_hint: 1, .3
                                anchor_x: 'center'
                                anchor_y: 'top'   

                                StackLayout:
                                    size_hint: .99, 1
                                    canvas.before:
                                        Color: 
                                            group: 'Color'
                                            rgba: (0, 0, 0, 1)
                                        Rectangle: 
                                            pos: self.x, self.y
                                            size: self.width, self.height         

                                    BoxLayout:
                                        orientation: 'horizontal'
                                        size_hint: .5, .25   

                                        Label:
                                            text: ''
                                            size_hint: .4, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.environment_setting_font_size

                                        BoxLayout:
                                            orientation: 'horizontal'
                                            size_hint: .3, 1                                               

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'right'
                                                anchor_y: 'center' 

                                            AnchorLayout:
                                                size_hint: .6, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center' 

                                                Label:
                                                    text: '設定溫度'
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.environment_setting_font_size - 10

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'left'
                                                anchor_y: 'center' 

                                    BoxLayout:
                                        orientation: 'horizontal'
                                        size_hint: .5, .25   

                                        Label:
                                            text: ''
                                            size_hint: .4, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.environment_setting_font_size

                                        BoxLayout:
                                            orientation: 'horizontal'
                                            size_hint: .3, 1                                               

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'right'
                                                anchor_y: 'center' 

                                            AnchorLayout:
                                                size_hint: .6, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center' 

                                                Label:
                                                    text: '設定溫度'
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.environment_setting_font_size - 10

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'left'
                                                anchor_y: 'center' 

                                    BoxLayout:
                                        orientation: 'horizontal'
                                        size_hint: .5, .25                                                 

                                        Label:
                                            id: lbl_environment_indoor_dry
                                            text: root.setting_id.environment_setting_lbl[2]
                                            size_hint: .4, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.environment_setting_font_size

                                        BoxLayout:
                                            orientation: 'horizontal'
                                            size_hint: .3, 1                                               

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'right'
                                                anchor_y: 'center' 

                                                Button:
                                                    id: btn_environment_indoor_dry_dec
                                                    size_hint: .6, .6
                                                    text: '-'
                                                    font_size: root.font_size.environment_setting_font_size
                                                    on_release: root.btn_modify_textinput_temp('environment_indoor_dry', -1 * root.setting_id.environment_temp_step)

                                            AnchorLayout:
                                                size_hint: .6, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center' 

                                                TextInput:
                                                    size_hint: .9, .8
                                                    id: environment_indoor_dry
                                                    input_filter: 'float'
                                                    text: '27.00'
                                                    font_name: './arialuni.ttf'
                                                    text_validate_unfocus: True
                                                    multiline: False                                    
                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                    font_size: root.font_size.environment_setting_font_size
                                                    background_color: (.1, .1, .1, 1)
                                                    foreground_color: (1, 1, 1, 1)

                                                    canvas.after:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x,self.y,self.width-2,self.height-2
                                                            width: 1.1

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'left'
                                                anchor_y: 'center' 

                                                Button:
                                                    id: btn_environment_indoor_dry_inc
                                                    size_hint: .6, .6
                                                    text: '+'
                                                    font_size: root.font_size.environment_setting_font_size
                                                    on_release: root.btn_modify_textinput_temp('environment_indoor_dry', root.setting_id.environment_temp_step)

                                    BoxLayout:
                                        orientation: 'horizontal'
                                        size_hint: .5, .25   

                                        Label:
                                            id: lbl_environment_indoor_wet
                                            text: root.setting_id.environment_setting_lbl[3]
                                            size_hint: .4, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.environment_setting_font_size

                                        BoxLayout:
                                            orientation: 'horizontal'
                                            size_hint: .3, 1                                               

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'right'
                                                anchor_y: 'center' 

                                                Button:
                                                    id: btn_environment_indoor_wet_dec
                                                    size_hint: .6, .6
                                                    text: '-'
                                                    font_size: root.font_size.environment_setting_font_size
                                                    on_release: root.btn_modify_textinput_temp('environment_indoor_wet', -1 * root.setting_id.environment_temp_step)

                                            AnchorLayout:
                                                size_hint: .6, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center' 

                                                TextInput:
                                                    size_hint: .9, .8
                                                    id: environment_indoor_wet
                                                    input_filter: 'float'
                                                    text: '19.00'
                                                    font_name: './arialuni.ttf'
                                                    text_validate_unfocus: True
                                                    multiline: False                                    
                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                    font_size: root.font_size.environment_setting_font_size
                                                    background_color: (.1, .1, .1, 1)
                                                    foreground_color: (1, 1, 1, 1)

                                                    canvas.after:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x,self.y,self.width-2,self.height-2
                                                            width: 1.1

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'left'
                                                anchor_y: 'center' 

                                                Button:
                                                    id: btn_environment_indoor_wet_inc
                                                    size_hint: .6, .6
                                                    text: '+'
                                                    font_size: root.font_size.environment_setting_font_size
                                                    on_release: root.btn_modify_textinput_temp('environment_indoor_wet', root.setting_id.environment_temp_step)

                                    BoxLayout:
                                        orientation: 'horizontal'
                                        size_hint: .5, .25   

                                        Label:
                                            id: lbl_environment_outdoor_dry
                                            text: root.setting_id.environment_setting_lbl[4]
                                            size_hint: .4, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.environment_setting_font_size

                                        BoxLayout:
                                            orientation: 'horizontal'
                                            size_hint: .3, 1                                               

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'right'
                                                anchor_y: 'center' 

                                                Button:
                                                    id: btn_environment_outdoor_dry_dec
                                                    size_hint: .6, .6
                                                    text: '-'
                                                    font_size: root.font_size.environment_setting_font_size
                                                    on_release: root.btn_modify_textinput_temp('environment_outdoor_dry', -1 * root.setting_id.environment_temp_step)

                                            AnchorLayout:
                                                size_hint: .6, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center' 

                                                TextInput:
                                                    size_hint: .9, .8
                                                    id: environment_outdoor_dry
                                                    input_filter: 'float'
                                                    text: '35.00'
                                                    font_name: './arialuni.ttf'
                                                    text_validate_unfocus: True
                                                    multiline: False                                    
                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                    font_size: root.font_size.environment_setting_font_size
                                                    background_color: (.1, .1, .1, 1)
                                                    foreground_color: (1, 1, 1, 1)

                                                    canvas.after:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x,self.y,self.width-2,self.height-2
                                                            width: 1.1

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'left'
                                                anchor_y: 'center' 

                                                Button:
                                                    id: btn_environment_outdoor_dry_inc
                                                    size_hint: .6, .6
                                                    text: '+'
                                                    font_size: root.font_size.environment_setting_font_size
                                                    on_release: root.btn_modify_textinput_temp('environment_outdoor_dry', root.setting_id.environment_temp_step)

                                    BoxLayout:
                                        orientation: 'horizontal'
                                        size_hint: .5, .25    

                                        Label:
                                            id: lbl_environment_outdoor_wet
                                            text: root.setting_id.environment_setting_lbl[5]
                                            size_hint: .4, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.environment_setting_font_size

                                        BoxLayout:
                                            orientation: 'horizontal'
                                            size_hint: .3, 1                                               

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'right'
                                                anchor_y: 'center' 

                                                Button:
                                                    id: btn_environment_outdoor_wet_dec
                                                    size_hint: .6, .6
                                                    text: '-'
                                                    font_size: root.font_size.environment_setting_font_size
                                                    on_release: root.btn_modify_textinput_temp('environment_outdoor_wet', -1 * root.setting_id.environment_temp_step)

                                            AnchorLayout:
                                                size_hint: .6, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center' 

                                                TextInput:
                                                    size_hint: .9, .8
                                                    id: environment_outdoor_wet
                                                    input_filter: 'float'
                                                    text: '24.00'
                                                    font_name: './arialuni.ttf'
                                                    text_validate_unfocus: True
                                                    multiline: False                                    
                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                    font_size: root.font_size.environment_setting_font_size
                                                    background_color: (.1, .1, .1, 1)
                                                    foreground_color: (1, 1, 1, 1)

                                                    canvas.after:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x,self.y,self.width-2,self.height-2
                                                            width: 1.1

                                            AnchorLayout:
                                                size_hint: .2, 1
                                                anchor_x: 'left'
                                                anchor_y: 'center' 

                                                Button:
                                                    id: btn_environment_outdoor_wet_inc
                                                    size_hint: .6, .6
                                                    text: '+'
                                                    font_size: root.font_size.environment_setting_font_size
                                                    on_release: root.btn_modify_textinput_temp('environment_outdoor_wet', root.setting_id.environment_temp_step)

                                    BoxLayout:
                                        orientation: 'horizontal'
                                        size_hint: 1, .25       

                                        AnchorLayout:
                                            size_hint: 1, 1
                                            anchor_x: 'center'
                                            anchor_y: 'center'      

                                            Button:
                                                size_hint: .1, .8
                                                text: 'Set'                 
                                                font_size: root.font_size.environment_setting_font_size        
                                                on_release: root.enviroment_temp_setting()

                            BoxLayout:
                                orientation: 'horizontal'
                                size_hint: 1, .1

                                AnchorLayout:
                                    size_hint: .25, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center'    

                                    Button:
                                        id: btn_environment_setting_load
                                        size_hint: .5, .5
                                        text: 'Load'
                                        font_size: root.font_size.experiment_setting_font_size
                                        on_release: root.loadEnvCfg()

                                AnchorLayout:
                                    size_hint: .25, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center'    

                                    Button:
                                        id: btn_environment_setting_save
                                        size_hint: .5, .5
                                        text: 'Save'
                                        font_size: root.font_size.environment_setting_font_size
                                        on_release: root.save_environment_setting_cfg()

                                BoxLayout:
                                    orientation: 'vertical'
                                    size_hint: .25, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center'    

                                    Label:
                                        size_hint: 1, .3
                                        text: root.setting_id.environment_setting_lbl[0]
                                        font_name: './arialuni.ttf'

                                    AnchorLayout:
                                        size_hint: 1, .7
                                        anchor_x: 'center'
                                        anchor_y: 'top' 

                                        TextInput:
                                            size_hint: .6, .8
                                            id: environment_setting_name
                                            text: 'Default'
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.environment_setting_font_size

                                BoxLayout:
                                    orientation: 'vertical'
                                    size_hint: .25, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center'    

                                    Label:
                                        size_hint: 1, .3
                                        text: root.setting_id.environment_setting_lbl[1]
                                        font_name: './arialuni.ttf'

                                    AnchorLayout:
                                        size_hint: 1, .7
                                        anchor_x: 'center'
                                        anchor_y: 'top' 

                                        Spinner:
                                            size_hint: .6, .8
                                            id: environment_calculation
                                            text: 'Cooling'
                                            font_name: './arialuni.ttf'
                                            values: ['Cooling', 'Warming']
                                            font_size: root.font_size.environment_setting_font_size

                            Label:
                                text: '    熱偶線設定'
                                size_hint: None, None
                                size: self.texture_size
                                font_name: './arialuni.ttf'

                            AnchorLayout:
                                size_hint: 1, .4
                                anchor_x: 'center'
                                anchor_y: 'top'   

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .99, 1

                                    canvas.before:
                                        Color: 
                                            group: 'Color'
                                            rgba: (0, 0, 0, 1)
                                        Rectangle: 
                                            pos: self.x, self.y
                                            size: self.width, self.height     

                                    BoxLayout:
                                        orientation: 'horizontal'
                                        size_hint: 1, 1 

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .5, 1 

                                            Label:
                                                text: '室內'
                                                size_hint: 1, .2
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.temperature_line_font_size

                                            StackLayout:
                                                orientation: 'tb-lr'
                                                id: indoor_temp_line
                                                size_hine: 1, .8

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_indoor_temp_line_0
                                                        text: '溫度1'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_indoor_temp_line_0
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.indoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size              

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_indoor_temp_line_1
                                                        text: '溫度2'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_indoor_temp_line_1
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.indoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_indoor_temp_line_2
                                                        text: '溫度3'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_indoor_temp_line_2
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.indoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_indoor_temp_line_3
                                                        text: '溫度4'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_indoor_temp_line_3
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.indoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_indoor_temp_line_4
                                                        text: '溫度5'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_indoor_temp_line_4
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.indoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_indoor_temp_line_5
                                                        text: '溫度6'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_indoor_temp_line_5
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.indoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_indoor_temp_line_6
                                                        text: '溫度7'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_indoor_temp_line_6
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.indoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_indoor_temp_line_7
                                                        text: '溫度8'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_indoor_temp_line_7
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.indoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .5, 1 

                                            Label:
                                                text: '室外'
                                                size_hint: 1, .2
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.temperature_line_font_size

                                            StackLayout:
                                                orientation: 'tb-lr'
                                                id: outdoor_temp_line
                                                size_hine: 1, .8

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_outdoor_temp_line_0
                                                        text: '吐出溫度'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_outdoor_temp_line_0
                                                            size_hint: .6, .8
                                                            text: '1'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.outdoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size              

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_outdoor_temp_line_1
                                                        text: '吸入溫度'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_outdoor_temp_line_1
                                                            size_hint: .6, .8
                                                            text: '2'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.outdoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_outdoor_temp_line_2
                                                        text: '毛前溫度'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_outdoor_temp_line_2
                                                            size_hint: .6, .8
                                                            text: '3'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.outdoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_outdoor_temp_line_3
                                                        text: '溫度4'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_outdoor_temp_line_3
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.outdoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_outdoor_temp_line_4
                                                        text: '溫度5'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_outdoor_temp_line_4
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.outdoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_outdoor_temp_line_5
                                                        text: '溫度6'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_outdoor_temp_line_5
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.outdoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_outdoor_temp_line_6
                                                        text: '溫度7'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_outdoor_temp_line_6
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.outdoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  

                                                BoxLayout:
                                                    size_hint: .5, .25

                                                    Label:
                                                        id: lbl_outdoor_temp_line_7
                                                        text: '溫度8'
                                                        size_hine: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.temperature_line_font_size

                                                    AnchorLayout:
                                                        size_hine: .5, 1
                                                        anchor_x: 'left'

                                                        Spinner:
                                                            id: spinner_outdoor_temp_line_7
                                                            size_hint: .6, .8
                                                            text: 'Disable'
                                                            font_name: './arialuni.ttf'
                                                            values: ['Disable'] + root.setting_id.outdoor_temperature_line_num
                                                            font_size: root.font_size.temperature_line_font_size  
                            BoxLayout:
                                orientation: 'horizontal'
                                size_hint: 1, .1

                                AnchorLayout:
                                    size_hint: .33, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center'    

                                    Button:
                                        id: btn_temperature_line_setting_load
                                        size_hint: .5, .5
                                        text: 'Load'
                                        font_size: root.font_size.temperature_line_font_size
                                        on_release: root.loadTempCfg()

                                AnchorLayout:
                                    size_hint: .33, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center'    

                                    Button:
                                        id: btn_temperature_line_setting_save
                                        size_hint: .5, .5
                                        text: 'Save'
                                        font_size: root.font_size.temperature_line_font_size
                                        on_release: root.save_temperature_line_setting_cfg()

                                BoxLayout:
                                    orientation: 'vertical'
                                    size_hint: .33, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center'    

                                    Label:
                                        size_hint: 1, .3
                                        text: 'Saved Config Name:'

                                    AnchorLayout:
                                        size_hint: 1, .7
                                        anchor_x: 'center'
                                        anchor_y: 'top' 

                                        TextInput:
                                            size_hint: .6, .8
                                            id: temperature_line_setting_save_cfg
                                            text: 'Default'
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.temperature_line_font_size

                TabbedPanelItem:
                    
                    text: 'UI設定'
                    font_name: './arialuni.ttf'
                    background_down: r'.\tabNormal.png'
                    background_normal: r'.\tabDown.PNG'

                    canvas.before:
                        Color: 
                            group: 'Color'
                            rgba: (.2, .2, .2, 1)
                        Rectangle: 
                            pos: self.x, self.y
                            size: self.width, self.height  

                    BoxLayout:
                        orientation: 'vertical'
                        size_hint: 1, 1

                        AnchorLayout:
                            size_hint: 1, .9
                            anchor_x: 'center'
                            anchor_y: 'top'   

                            StackLayout:
                                size_hint: .99, 1

                                canvas.before:
                                    Color: 
                                        group: 'Color'
                                        rgba: (0, 0, 0, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height         

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: 'UI COM PORT'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        TextInput:
                                            id: UI_com_port
                                            text: root.setting_id.default_setting[0]
                                            size_hint: .2, .5 
                                            input_filter: 'int'
                                            text_validate_unfocus: True                                          
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: 'DEBUG COM PORT'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        TextInput:
                                            id: debug_com_port
                                            text: root.setting_id.default_setting[1]
                                            size_hint: .2, .5 
                                            input_filter: 'int'
                                            text_validate_unfocus: True                                          
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '全螢幕'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        Spinner:
                                            id: full_screen
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[2]
                                            values: ['True', 'False']
                                            on_text: root.screen_setting_change()
                                            font_size: 24

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '解析度'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        Spinner:
                                            id: resolution
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[3]
                                            values: ['800*600', '1920*1080']
                                            on_text: root.screen_setting_change()
                                            font_size: 16

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: 'Monitor Mode'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        Spinner:
                                            id: monitor_mode_enable
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[4]
                                            values: ['True', 'False']
                                            on_text: root.monitor_mode_enable_change()
                                            font_size: 24

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '畫圖'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        Spinner:
                                            id: graph_enable
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[5]
                                            values: ['True', 'False']
                                            on_text: root.graph_enable_change()
                                            font_size: 24

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '畫圖間隔(s)'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        TextInput:
                                            id: graph_interval
                                            text: root.setting_id.default_setting[6]
                                            size_hint: .2, .5 
                                            input_filter: 'float'
                                            text_validate_unfocus: True                                          
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '畫圖點數'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        TextInput:
                                            id: graph_sample_cnt
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[7]
                                            input_filter: 'int'
                                            text_validate_unfocus: True                                          
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '壓縮機電流保護'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        TextInput:
                                            id: compCurr_protect
                                            text: root.setting_id.default_setting[8]
                                            size_hint: .2, .5 
                                            input_filter: 'float'
                                            text_validate_unfocus: True                                          
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '風扇電流保護'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        TextInput:
                                            id: fanCurr_protect
                                            text: root.setting_id.default_setting[9]
                                            size_hint: .2, .5 
                                            input_filter: 'float'
                                            text_validate_unfocus: True                                          
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: 'IPM溫度保護'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        TextInput:
                                            id: ipmTemp_protect
                                            text: root.setting_id.default_setting[10]
                                            size_hint: .2, .5 
                                            input_filter: 'float'
                                            text_validate_unfocus: True                                          
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '壓縮機電流 alpha'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        TextInput:
                                            id: alpha_comp
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[11]
                                            input_filter: 'float'
                                            text_validate_unfocus: True                                          
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '風扇轉速 alpha'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        TextInput:
                                            id: alpha_fan
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[12]
                                            input_filter: 'float'
                                            text_validate_unfocus: True                                          
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '風扇電流 alpha'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        TextInput:
                                            id: alpha_fanCurr
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[13]
                                            input_filter: 'float'
                                            text_validate_unfocus: True                                          
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: 'IPM溫度 alpha'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        TextInput:
                                            id: alpha_ipm
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[14]
                                            input_filter: 'float'
                                            text_validate_unfocus: True                                          
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '室內側環控'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        Spinner:
                                            id: indoor_system
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[15]
                                            values: ['1', '2', '3', '4']
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '室外側環控'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        Spinner:
                                            id: outdoor_system
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[16]
                                            values: ['1', '2', '3', '4']
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '試驗電源'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        Spinner:
                                            id: power_supply
                                            size_hint: .2, .5 
                                            text: root.setting_id.default_setting[17]
                                            values: ['1', '2', '3']
                                            font_size: 40 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: .5, .1

                                    AnchorLayout:
                                        size_hint: .5, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'           

                                        Label:
                                            size_hint: .8, 1
                                            text: '試驗噴嘴'
                                            font_name: './arialuni.ttf'
                                            font_size: 40  

                                    BoxLayout:
                                        orientation: 'horizontal'
                                        size_hint: .5, 1

                                        BoxLayout:
                                            orientation: 'horizontal'
                                            size_hint: .2, 1

                                            CheckBox:
                                                id: spray_head_2p5_1
                                                size_hint: .3, 1 
                                                active: root.setting_id.default_setting[18]

                                            Label:
                                                size_hint: .7, 1 
                                                text: '2.5'
                                                font_size: 30  

                                        BoxLayout:
                                            orientation: 'horizontal'
                                            size_hint: .2, 1

                                            CheckBox:
                                                id: spray_head_2p5_2
                                                size_hint: .3, 1 
                                                active: root.setting_id.default_setting[19]

                                            Label:
                                                size_hint: .7, 1 
                                                text: '2.5'
                                                font_size: 30  

                                        BoxLayout:
                                            orientation: 'horizontal'
                                            size_hint: .2, 1

                                            CheckBox:
                                                id: spray_head_3
                                                size_hint: .3, 1 
                                                active: root.setting_id.default_setting[20]

                                            Label:
                                                size_hint: .7, 1 
                                                text: '3'
                                                font_size: 30  

                                        BoxLayout:
                                            orientation: 'horizontal'
                                            size_hint: .2, 1

                                            CheckBox:
                                                id: spray_head_4
                                                size_hint: .3, 1 
                                                active: root.setting_id.default_setting[21]

                                            Label:
                                                size_hint: .7, 1 
                                                text: '4'
                                                font_size: 30  

                                        BoxLayout:
                                            orientation: 'horizontal'
                                            size_hint: .2, 1                                                                                    

                                            CheckBox:
                                                id: spray_head_6
                                                size_hint: .3, 1 
                                                active: root.setting_id.default_setting[22]

                                            Label:
                                                size_hint: .7, 1 
                                                text: '6'
                                                font_size: 30  

                        AnchorLayout:
                            size_hint: 1, .1
                            anchor_x: 'center'
                            anchor_y: 'center' 

                            Button:
                                size_hint: .1, .8
                                text: 'Save'
                                font_size: 40 
                                on_release: root.save_UI_setting_cfg()

        TabbedPanelItem:
            
            text: 'Real-Time'
            font_name: './arialuni.ttf'
            background_down: r'.\tabDown.PNG'
            background_normal: r'.\tabNormal.png'   
            on_release: root.TabbedPanel_choosed('Real-Time')

            canvas.before:
                Color: 
                    group: 'Color'
                    rgba: (.2, .2, .2, 1)
                Rectangle: 
                    pos: self.x, self.y
                    size: self.width, self.height  

            BoxLayout:
                orientation: 'horizontal'
                size_hint: 1, 1         

                AnchorLayout:
                    size_hint: .2, 1
                    anchor_x: 'center'
                    anchor_y: 'bottom'    

                    BoxLayout:
                        orientation: 'vertical'
                        size_hint: 1, .99

                        BoxLayout:
                            orientation: 'vertical'
                            size_hint: 1, 1

                            AnchorLayout:
                                size_hint: 1, 1
                                anchor_x: 'center'
                                anchor_y: 'center'   

                                TabbedPanel:
                                    size_hint: .95, 1
                                    do_default_tab: False
                                    
                                    tab_height: 20 

                                    TabbedPanelItem:
                                        
                                        text: 'Log Console'
                                        font_name: './arialuni.ttf'
                                        background_down: r'.\tabNormal.png'
                                        background_normal: r'.\tabDown.PNG'                                     

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: 1, 1

                                            canvas.before:
                                                Color: 
                                                    group: 'Color'
                                                    rgba: (0, 0, 0, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height  

                                            ScrollView:
                                                id: scroll_log
                                                size_hint: 1, 1

                                                Label:
                                                    id: lbl_log
                                                    text: ''
                                                    size_hint: None, None
                                                    size: self.texture_size         # Set the Label (width, height) to the text (width, height)
                                                    font_size: 20
                                                    font_name: './arialuni.ttf'
                                                    markup: True

                                    TabbedPanelItem:
                                        
                                        text: 'Board Log'
                                        font_name: './arialuni.ttf'
                                        background_down: r'.\tabNormal.png'
                                        background_normal: r'.\tabDown.PNG'                                     

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: 1, 1

                                            canvas.before:
                                                Color: 
                                                    group: 'Color'
                                                    rgba: (0, 0, 0, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height  

                                            ScrollView:
                                                id: scroll_debug_log
                                                size_hint: 1, 1

                                                Label:
                                                    id: lbl_debug_log
                                                    text: ''
                                                    size_hint: None, None
                                                    size: self.texture_size         # Set the Label (width, height) to the text (width, height)
                                                    font_size: 20
                                                    font_name: './arialuni.ttf'
                                                    markup: True

                                    TabbedPanelItem:
                                        
                                        text: 'Script'
                                        font_name: './arialuni.ttf'
                                        background_down: r'.\tabNormal.png'
                                        background_normal: r'.\tabDown.PNG'                                     

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: 1, 1

                                            ScrollView:
                                                id: scroll_script
                                                size_hint: 1, .9

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (0, 0, 0, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height  

                                                Label:
                                                    id: lbl_script
                                                    text: ''
                                                    size_hint: None, None
                                                    size: self.texture_size         # Set the Label (width, height) to the text (width, height)
                                                    font_size: 20
                                                    font_name: './arialuni.ttf'
                                                    markup: True

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .1

                                                AnchorLayout:
                                                    size_hint: .33, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'                                                    
                                                    
                                                    Button:
                                                        size_hint: .8, .8
                                                        text: 'Load'
                                                        font_size: 30
                                                        on_release: root.loadScriptCfg()

                                                AnchorLayout:
                                                    size_hint: .33, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'                                                    
                                                    
                                                    Button:
                                                        size_hint: .8, .8
                                                        text: 'Start'
                                                        font_size: 30
                                                        on_release: root.scriptStart()

                                                AnchorLayout:
                                                    size_hint: .33, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'                                                    
                                                    
                                                    Button:
                                                        size_hint: .8, .8
                                                        text: 'Stop'
                                                        font_size: 30
                                                        on_release: root.scriptStop()

                            Label:
                                text: '    控制板參數'
                                size_hint: None, None
                                size: self.texture_size
                                font_name: './arialuni.ttf'


                            AnchorLayout:
                                size_hint: 1, .25
                                anchor_x: 'center'
                                anchor_y: 'top'

                                ScrollView:
                                    size_hint: .95, .97 
                                    
                                    canvas.before:
                                        Color: 
                                            rgba: (0, 0, 0, 1)
                                        Rectangle: 
                                            pos: self.x, self.y
                                            size: self.width, self.height  

                                    GridLayout:
                                        cols: 3
                                        size_hint: 1.,None
                                        height: self.minimum_height 
                                        spacing : 0, 0

                                        AnchorLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 5
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                text: 'Parameter'
                                                size_hint: 1, 1
                                                font_size: root.font_size.title_lbl_font_size

                                        AnchorLayout:
                                            size_hint: .3, None       
                                            height: self.parent.parent.height / 5
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                text: ''
                                                size_hint: 1, 1
                                                font_size: root.font_size.title_lbl_font_size

                                        AnchorLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 5
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                text: 'Value'
                                                size_hint: 1, 1
                                                font_size: root.font_size.title_lbl_font_size

                                        AnchorLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                text: root.curve_param.curveName[root.curve_param.boardParaStrt + 0]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size

                                        AnchorLayout:
                                            size_hint: .3, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            CheckBox:
                                                id: set_enable_Comp
                                                size_hint: 1, 1
                                                active: True
                                                on_active: root.set_enable_active('set_enable_Comp')

                                        StackLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 4

                                            AnchorLayout:
                                                size_hint: .2, 1       
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Button:
                                                    text: '-'
                                                    size_hint: .8, .5
                                                    on_press: root.range_button_pressed(args[0], Input_compRPM, root.control_board_param.compRPM_step, 'int')

                                            AnchorLayout:
                                                size_hint: .6, 1       
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                TextInput:
                                                    id: Input_compRPM
                                                    text: root.control_board_param.compRPM_init
                                                    input_filter: 'int'
                                                    text_validate_unfocus: True                                          
                                                    multiline: False                                    
                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                    padding_y: ( self.height - self.line_height ) / 2
                                                    size_hint: .8, .5

                                            AnchorLayout:
                                                size_hint: .2, 1       
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Button:
                                                    text: '+'
                                                    size_hint: .8, .5
                                                    on_press: root.range_button_pressed(args[0], Input_compRPM, root.control_board_param.compRPM_step, 'int')

                                        AnchorLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                text: root.curve_param.curveName[root.curve_param.boardParaStrt + 6]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size

                                        AnchorLayout:
                                            size_hint: .3, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            CheckBox:
                                                id: set_enable_EEV
                                                size_hint: 1, 1
                                                active: True
                                                on_active: root.set_enable_active('set_enable_EEV')

                                        StackLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 4

                                            AnchorLayout:
                                                size_hint: .2, 1       
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Button:
                                                    text: '-'
                                                    size_hint: .8, .5
                                                    on_press: root.range_button_pressed(args[0], Input_EEVDeg, root.control_board_param.EEVDeg_step, 'int')

                                            AnchorLayout:
                                                size_hint: .6, 1       
                                                height: self.parent.parent.height / 4
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                TextInput:
                                                    id: Input_EEVDeg
                                                    text: root.control_board_param.EEVDeg_init
                                                    input_filter: 'int'
                                                    text_validate_unfocus: True                                          
                                                    multiline: False                                    
                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                    padding_y: ( self.height - self.line_height ) / 2
                                                    size_hint: .8, .5

                                            AnchorLayout:
                                                size_hint: .2, 1       
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Button:
                                                    text: '+'
                                                    size_hint: .8, .5
                                                    on_press: root.range_button_pressed(args[0], Input_EEVDeg, root.control_board_param.EEVDeg_step, 'int')

                                        AnchorLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                text: root.curve_param.curveName[root.curve_param.boardParaStrt + 3]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size

                                        AnchorLayout:
                                            size_hint: .3, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            CheckBox:
                                                id: set_enable_Fan
                                                size_hint: 1, 1
                                                active: True
                                                on_active: root.set_enable_active('set_enable_Fan')

                                        StackLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 4

                                            AnchorLayout:
                                                size_hint: .2, 1       
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Button:
                                                    text: '-'
                                                    size_hint: .8, .5
                                                    on_press: root.range_button_pressed(args[0], Input_FanSpeed, root.control_board_param.FanSpeed_step, 'int')

                                            AnchorLayout:
                                                size_hint: .6, 1       
                                                height: self.parent.parent.height / 4
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                TextInput:
                                                    id: Input_FanSpeed
                                                    # text: root.control_board_param.FanSpeed_init
                                                    input_filter: 'int'
                                                    text_validate_unfocus: True                                          
                                                    multiline: False                                    
                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                    padding_y: ( self.height - self.line_height ) / 2
                                                    size_hint: .8, .5
                                                    on_text: root.bootup()

                                            AnchorLayout:
                                                size_hint: .2, 1       
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Button:
                                                    text: '+'
                                                    size_hint: .8, .5
                                                    on_press: root.range_button_pressed(args[0], Input_FanSpeed, root.control_board_param.FanSpeed_step, 'int')

                                        AnchorLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                text: '冷暖模式'
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size

                                        AnchorLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                        AnchorLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Spinner:
                                                size_hint: .8, .8
                                                id: cool_warm_mode
                                                text: 'Cool'
                                                values: ['Cool', 'Warm']
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size


                            AnchorLayout:
                                size_hint: 1, .1
                                anchor_x: 'center'
                                anchor_y: 'top'

                                BoxLayout:
                                    orientation:　'horizontal'
                                    size_hint: .95, .97 
                                    
                                    canvas.before:
                                        Color: 
                                            rgba: (0, 0, 0, 1)
                                        Rectangle: 
                                            pos: self.x, self.y
                                            size: self.width, self.height  

                                    BoxLayout:
                                        orientation:　'vertical'
                                        size_hint: 1, 1

                                        AnchorLayout:
                                            size_hint: 1, .5
                                            anchor_x: 'center'
                                            anchor_y: 'bottom'  

                                            Button:
                                                id: btn_conn
                                                text: 'Conn'
                                                size_hint: .8, .8
                                                font_size: 24
                                                on_press: root.conn_button_pressed()
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1, .5
                                            anchor_x: 'center'
                                            anchor_y: 'top'      

                                            Label:
                                                id: lbl_conn
                                                text: '[color=ff3333]未連線[/color]'
                                                size_hint: .8, .8
                                                font_size: 20
                                                markup: True
                                                font_name: './arialuni.ttf'


                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'        

                                        Button:
                                            id: btn_start
                                            text: 'Start'
                                            size_hint: .8, .8
                                            font_size: 24
                                            on_press: root.start_button_pressed()
                                            markup: True

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'        

                                        Button:
                                            id: btn_stop
                                            text: 'Stop'
                                            size_hint: .8, .8
                                            font_size: 24
                                            on_press: root.stop_button_pressed(False)
                                            markup: True

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'        

                                        Button:
                                            id: btn_set
                                            text: 'Set'
                                            size_hint: .8, .8
                                            font_size: 24
                                            on_press: root.set_button_pressed()
                                            markup: True

                AnchorLayout:
                    size_hint: .8, 1
                    anchor_x: 'center'
                    anchor_y: 'bottom' 

                    TabbedPanel:
                        size_hint: 1, .99
                        do_default_tab: False
                        
                        tab_height: 20 

                        TabbedPanelItem:
                            
                            text: '圖形'
                            font_name: './arialuni.ttf'
                            background_down: r'.\tabNormal.png'
                            background_normal: r'.\tabDown.PNG'   

                            BoxLayout:
                                orientation: 'vertical'
                                size_hint: 1, 1
                                canvas.before:
                                    Color: 
                                        rgba: (.2, .2, .2, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height  
                                Label:
                                    text: '  Graph0'
                                    size_hint: None, None
                                    size: self.texture_size

                                AnchorLayout:
                                    size_hint: 1, .5
                                    anchor_x: 'left'
                                    anchor_y: 'top'         

                                    MatplotFigure:
                                        id: fig_0
                                        size_hint: .99, .97
                                        canvas.before:
                                            Color: 
                                                rgba: (0, 0, 0, 1)
                                            Rectangle: 
                                                pos: self.x, self.y
                                                size: self.width, self.height  

                                    FloatLayout:
                                        MatplotNavToolbar_0:       
                                            id: tool_bar_graph_0          
                                            figure_widget: fig_0
                                            info_lbl_0: info_lbl_0
                                            cursor_line_0: cursor_line_0

                                            FloatLayout:        
                                                Widget:
                                                    id: cursor_line_0
                                                    canvas.before:                                                
                                                        Color: 
                                                            group: 'Color'
                                                            rgba: (1, 1, 1, 0)
                                                        Rectangle:
                                                            group: 'Rect'
                                                            size: 1, 400 

                                            FloatLayout:
                                                Label:
                                                    id: info_lbl_0
                                                    size: self.texture_size
                                                    markup: True
                                                    # text_size: self.size   
                                                    font_name: './arialuni.ttf'


                                Label:
                                    text: '  Graph1'
                                    size_hint: None, None
                                    size: self.texture_size

                                AnchorLayout:
                                    size_hint: 1, .5
                                    anchor_x: 'left'
                                    anchor_y: 'top'         

                                    MatplotFigure:
                                        id: fig_1
                                        size_hint: .99, .97
                                        canvas.before:
                                            Color: 
                                                rgba: (0, 0, 0, 1)
                                            Rectangle: 
                                                pos: self.x, self.y
                                                size: self.width, self.height

                                    FloatLayout:
                                        MatplotNavToolbar_1:       
                                            id: tool_bar_graph_1
                                            figure_widget: fig_1       
                                            cursor_line_1: cursor_line_1
                                            info_lbl_1: info_lbl_1

                                            FloatLayout:        
                                                Widget:
                                                    id: cursor_line_1
                                                    canvas.before:                                                
                                                        Color: 
                                                            group: 'Color'
                                                            rgba: (1, 1, 1, 0)
                                                        Rectangle:
                                                            group: 'Rect'
                                                            size: 1, 400

                                            FloatLayout:
                                                Label:
                                                    id: info_lbl_1
                                                    size: self.texture_size
                                                    markup: True
                                                    # text_size: self.size   
                                                    font_name: './arialuni.ttf'

                        TabbedPanelItem:
                            
                            text: '數字'
                            font_name: './arialuni.ttf'
                            background_down: r'.\tabNormal.png'
                            background_normal: r'.\tabDown.PNG'   

                            BoxLayout:
                                orientation: 'vertical'
                                size_hint: 1, 1

                                canvas.before:
                                    Color: 
                                        rgba: (.2, .2, .2, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height  

                                Label:
                                    text: '  環境量測'
                                    size_hint: None, None
                                    size: self.texture_size
                                    font_name: './arialuni.ttf'

                                AnchorLayout:
                                    size_hint: 1, .7
                                    anchor_x: 'left'
                                    anchor_y: 'top'  

                                    BoxLayout:
                                        size_hint: .99, .99
                                        canvas.before:
                                            Color: 
                                                rgba: (0, 0, 0, 1)
                                            Rectangle: 
                                                pos: self.x, self.y
                                                size: self.width, self.height  

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'  

                                        GridLayout:
                                            size_hint: .99, .9
                                            cols: 6

                                            AnchorLayout:
                                                size_hint: 1, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'right'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_curve_name_0
                                                    text: root.curve_param.curveName[0]
                                                    size_hint: .8, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.lbl_rpt_font_size
                                                    markup: True

                                            AnchorLayout:
                                                size_hint: .7, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'left'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_0
                                                    text: ''
                                                    size_hint: 1, .8
                                                    font_size: root.font_size.lbl_rpt_font_size

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                            AnchorLayout:
                                                size_hint: .4, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                AnchorLayout:
                                                    size_hint: .8, .8       
                                                    height: self.parent.height / 5
                                                    anchor_x: 'left'
                                                    anchor_y: 'bottom'

                                                    Label:
                                                        text: root.curve_param.unitName[0]
                                                        size_hint: None, None
                                                        size: self.texture_size
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.unit_font_size
                                            AnchorLayout:
                                                size_hint: 1, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'right'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_curve_name_1
                                                    text: root.curve_param.curveName[1]
                                                    size_hint: .8, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.lbl_rpt_font_size
                                                    markup: True

                                            AnchorLayout:
                                                size_hint: .7, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'left'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_1
                                                    text: ''
                                                    size_hint: 1, .8
                                                    font_size: root.font_size.lbl_rpt_font_size

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                            AnchorLayout:
                                                size_hint: .4, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                AnchorLayout:
                                                    size_hint: .8, .8       
                                                    height: self.parent.height / 5
                                                    anchor_x: 'left'
                                                    anchor_y: 'bottom'

                                                    Label:
                                                        text: root.curve_param.unitName[1]
                                                        size_hint: None, None
                                                        size: self.texture_size
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.unit_font_size

                                            AnchorLayout:
                                                size_hint: 1, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'right'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_curve_name_2
                                                    text: root.curve_param.curveName[2]
                                                    size_hint: .8, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.lbl_rpt_font_size
                                                    markup: True

                                            AnchorLayout:
                                                size_hint: .7, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'left'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_2
                                                    text: ''
                                                    size_hint: 1, .8
                                                    font_size: root.font_size.lbl_rpt_font_size

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                            AnchorLayout:
                                                size_hint: .4, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                AnchorLayout:
                                                    size_hint: .8, .8       
                                                    height: self.parent.height / 5
                                                    anchor_x: 'left'
                                                    anchor_y: 'bottom'

                                                    Label:
                                                        text: root.curve_param.unitName[2]
                                                        size_hint: None, None
                                                        size: self.texture_size
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.unit_font_size

                                            AnchorLayout:
                                                size_hint: 1, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'right'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_curve_name_3
                                                    text: root.curve_param.curveName[3]
                                                    size_hint: .8, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.lbl_rpt_font_size
                                                    markup: True

                                            AnchorLayout:
                                                size_hint: .7, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'left'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_3
                                                    text: ''
                                                    size_hint: 1, .8
                                                    font_size: root.font_size.lbl_rpt_font_size

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                            AnchorLayout:
                                                size_hint: .4, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                AnchorLayout:
                                                    size_hint: .8, .8       
                                                    height: self.parent.height / 5
                                                    anchor_x: 'left'
                                                    anchor_y: 'bottom'

                                                    Label:
                                                        text: root.curve_param.unitName[3]
                                                        size_hint: None, None
                                                        size: self.texture_size
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.unit_font_size

                                            AnchorLayout:
                                                size_hint: 1, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'right'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_curve_name_4
                                                    text: root.curve_param.curveName[4]
                                                    size_hint: .8, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.lbl_rpt_font_size
                                                    markup: True

                                            AnchorLayout:
                                                size_hint: .7, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'left'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_4
                                                    text: ''
                                                    size_hint: 1, .8
                                                    font_size: root.font_size.lbl_rpt_font_size

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                            AnchorLayout:
                                                size_hint: .4, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                AnchorLayout:
                                                    size_hint: .8, .8       
                                                    height: self.parent.height / 5
                                                    anchor_x: 'left'
                                                    anchor_y: 'bottom'

                                                    Label:
                                                        text: root.curve_param.unitName[4]
                                                        size_hint: None, None
                                                        size: self.texture_size
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.unit_font_size

                                            AnchorLayout:
                                                size_hint: 1, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'right'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_curve_name_5
                                                    text: root.curve_param.curveName[5]
                                                    size_hint: .8, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.lbl_rpt_font_size
                                                    markup: True

                                            AnchorLayout:
                                                size_hint: .7, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'left'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_5
                                                    text: ''
                                                    size_hint: 1, .8
                                                    font_size: root.font_size.lbl_rpt_font_size

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                            AnchorLayout:
                                                size_hint: .4, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                AnchorLayout:
                                                    size_hint: .8, .8       
                                                    height: self.parent.height / 5
                                                    anchor_x: 'left'
                                                    anchor_y: 'bottom'

                                                    Label:
                                                        text: root.curve_param.unitName[5]
                                                        size_hint: None, None
                                                        size: self.texture_size
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.unit_font_size

                                            AnchorLayout:
                                                size_hint: 1, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'right'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_curve_name_6
                                                    text: root.curve_param.curveName[6]
                                                    size_hint: .8, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.lbl_rpt_font_size
                                                    markup: True

                                            AnchorLayout:
                                                size_hint: .7, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'left'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_6
                                                    text: ''
                                                    size_hint: 1, .8
                                                    font_size: root.font_size.lbl_rpt_font_size

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                            AnchorLayout:
                                                size_hint: .4, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                AnchorLayout:
                                                    size_hint: .8, .8       
                                                    height: self.parent.height / 5
                                                    anchor_x: 'left'
                                                    anchor_y: 'bottom'

                                                    Label:
                                                        text: root.curve_param.unitName[6]
                                                        size_hint: None, None
                                                        size: self.texture_size
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.unit_font_size

                                            AnchorLayout:
                                                size_hint: 1, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'right'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_curve_name_7
                                                    text: root.curve_param.curveName[7]
                                                    size_hint: .8, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.lbl_rpt_font_size
                                                    markup: True

                                            AnchorLayout:
                                                size_hint: .7, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'left'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_7
                                                    text: ''
                                                    size_hint: 1, .8
                                                    font_size: root.font_size.lbl_rpt_font_size

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                            AnchorLayout:
                                                size_hint: .4, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                AnchorLayout:
                                                    size_hint: .8, .8       
                                                    height: self.parent.height / 5
                                                    anchor_x: 'left'
                                                    anchor_y: 'bottom'

                                                    Label:
                                                        text: root.curve_param.unitName[7]
                                                        size_hint: None, None
                                                        size: self.texture_size
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.unit_font_size

                                            AnchorLayout:
                                                size_hint: 1, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'right'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_curve_name_8
                                                    text: root.curve_param.curveName[8]
                                                    size_hint: .8, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.lbl_rpt_font_size
                                                    markup: True

                                            AnchorLayout:
                                                size_hint: .7, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'left'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_8
                                                    text: ''
                                                    size_hint: 1, .8
                                                    font_size: root.font_size.lbl_rpt_font_size

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                            AnchorLayout:
                                                size_hint: .4, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                AnchorLayout:
                                                    size_hint: .8, .8       
                                                    height: self.parent.height / 5
                                                    anchor_x: 'left'
                                                    anchor_y: 'bottom'

                                                    Label:
                                                        text: root.curve_param.unitName[8]
                                                        size_hint: None, None
                                                        size: self.texture_size
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.unit_font_size

                                            AnchorLayout:
                                                size_hint: 1, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'right'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_curve_name_9
                                                    text: root.curve_param.curveName[9]
                                                    size_hint: .8, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: root.font_size.lbl_rpt_font_size
                                                    markup: True

                                            AnchorLayout:
                                                size_hint: .7, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'left'
                                                anchor_y: 'center'

                                                Label:
                                                    id: lbl_rpt_9
                                                    text: ''
                                                    size_hint: 1, .8
                                                    font_size: root.font_size.lbl_rpt_font_size

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                            AnchorLayout:
                                                size_hint: .4, None       
                                                height: self.parent.height / 5
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                AnchorLayout:
                                                    size_hint: .8, .8       
                                                    height: self.parent.height / 5
                                                    anchor_x: 'left'
                                                    anchor_y: 'bottom'

                                                    Label:
                                                        text: root.curve_param.unitName[9]
                                                        size_hint: None, None
                                                        size: self.texture_size
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.unit_font_size

                                Label:
                                    text: '  控制板數據'
                                    size_hint: None, None
                                    size: self.texture_size
                                    font_name: './arialuni.ttf'

                                AnchorLayout:
                                    size_hint: 1, .3
                                    anchor_x: 'left'
                                    anchor_y: 'top'   

                                    BoxLayout:
                                        size_hint: .99, .99
                                        canvas.before:
                                            Color: 
                                                rgba: (0, 0, 0, 1)
                                            Rectangle: 
                                                pos: self.x, self.y
                                                size: self.width, self.height   

                                        AnchorLayout:
                                            size_hint: 1, 1
                                            anchor_x: 'left'
                                            anchor_y: 'center'  

                                            ScrollView:
                                                size_hint: 1, 1 
                                                
                                                canvas.before:
                                                    Color: 
                                                        rgba: (0, 0, 0, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height  

                                                GridLayout:
                                                    size_hint: 1.,None
                                                    height: self.minimum_height 
                                                    cols: 9

                                                    AnchorLayout:
                                                        size_hint: 1, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'right'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_curve_name_10
                                                            text: root.curve_param.curveName[10]
                                                            size_hint: .8, 1
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.lbl_rpt_font_size - 10
                                                            markup: True

                                                    AnchorLayout:
                                                        size_hint: .7, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'left'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_10
                                                            text: ''
                                                            size_hint: 1, .8
                                                            font_size: root.font_size.lbl_rpt_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                    AnchorLayout:
                                                        size_hint: .4, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        AnchorLayout:
                                                            size_hint: .8, .8       
                                                            height: self.parent.parent.height / 2
                                                            anchor_x: 'left'
                                                            anchor_y: 'bottom'

                                                            Label:
                                                                text: root.curve_param.unitName[10]
                                                                size_hint: None, None
                                                                size: self.texture_size
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.unit_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'right'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_curve_name_11
                                                            text: root.curve_param.curveName[11]
                                                            size_hint: .8, 1
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.lbl_rpt_font_size - 24
                                                            markup: True

                                                    AnchorLayout:
                                                        size_hint: .7, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'left'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_11
                                                            text: ''
                                                            size_hint: 1, .8
                                                            font_size: root.font_size.lbl_rpt_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                    AnchorLayout:
                                                        size_hint: .4, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        AnchorLayout:
                                                            size_hint: .8, .8       
                                                            height: self.parent.parent.height / 2
                                                            anchor_x: 'left'
                                                            anchor_y: 'bottom'

                                                            Label:
                                                                text: root.curve_param.unitName[11]
                                                                size_hint: None, None
                                                                size: self.texture_size
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.unit_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'right'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_curve_name_12
                                                            text: root.curve_param.curveName[12]
                                                            size_hint: .8, 1
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.lbl_rpt_font_size - 24
                                                            markup: True

                                                    AnchorLayout:
                                                        size_hint: .7, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'left'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_12
                                                            text: ''
                                                            size_hint: 1, .8
                                                            font_size: root.font_size.lbl_rpt_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                    AnchorLayout:
                                                        size_hint: .4, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        AnchorLayout:
                                                            size_hint: .8, .8       
                                                            height: self.parent.parent.height / 2
                                                            anchor_x: 'left'
                                                            anchor_y: 'bottom'

                                                            Label:
                                                                text: root.curve_param.unitName[12]
                                                                size_hint: None, None
                                                                size: self.texture_size
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.unit_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'right'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_curve_name_13
                                                            text: root.curve_param.curveName[13]
                                                            size_hint: .8, 1
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.lbl_rpt_font_size
                                                            markup: True

                                                    AnchorLayout:
                                                        size_hint: .7, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'left'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_13
                                                            text: ''
                                                            size_hint: 1, .8
                                                            font_size: root.font_size.lbl_rpt_font_size - 10

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                    AnchorLayout:
                                                        size_hint: .4, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        AnchorLayout:
                                                            size_hint: .8, .8       
                                                            height: self.parent.parent.height / 2
                                                            anchor_x: 'left'
                                                            anchor_y: 'bottom'

                                                            Label:
                                                                text: root.curve_param.unitName[13]
                                                                size_hint: None, None
                                                                size: self.texture_size
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.unit_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'right'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_curve_name_14
                                                            text: root.curve_param.curveName[14]
                                                            size_hint: .8, 1
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.lbl_rpt_font_size - 24
                                                            markup: True

                                                    AnchorLayout:
                                                        size_hint: .7, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'left'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_14
                                                            text: ''
                                                            size_hint: 1, .8
                                                            font_size: root.font_size.lbl_rpt_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                    AnchorLayout:
                                                        size_hint: .4, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        AnchorLayout:
                                                            size_hint: .8, .8       
                                                            height: self.parent.parent.height / 2
                                                            anchor_x: 'left'
                                                            anchor_y: 'bottom'

                                                            Label:
                                                                text: root.curve_param.unitName[14]
                                                                size_hint: None, None
                                                                size: self.texture_size
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.unit_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'right'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_curve_name_15
                                                            text: root.curve_param.curveName[15]
                                                            size_hint: .8, 1
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.lbl_rpt_font_size - 24
                                                            markup: True

                                                    AnchorLayout:
                                                        size_hint: .7, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'left'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_15
                                                            text: ''
                                                            size_hint: 1, .8
                                                            font_size: root.font_size.lbl_rpt_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                    AnchorLayout:
                                                        size_hint: .4, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        AnchorLayout:
                                                            size_hint: .8, .8       
                                                            height: self.parent.parent.height / 2
                                                            anchor_x: 'left'
                                                            anchor_y: 'bottom'

                                                            Label:
                                                                text: root.curve_param.unitName[15]
                                                                size_hint: None, None
                                                                size: self.texture_size
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.unit_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'right'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_curve_name_16
                                                            text: root.curve_param.curveName[16]
                                                            size_hint: .8, 1
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.lbl_rpt_font_size
                                                            markup: True

                                                    AnchorLayout:
                                                        size_hint: .7, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'left'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: lbl_rpt_16
                                                            text: ''
                                                            size_hint: 1, .8
                                                            font_size: root.font_size.lbl_rpt_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                    AnchorLayout:
                                                        size_hint: .4, None       
                                                        height: self.parent.parent.height / 2
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        AnchorLayout:
                                                            size_hint: .8, .8       
                                                            height: self.parent.parent.height / 2
                                                            anchor_x: 'left'
                                                            anchor_y: 'bottom'

                                                            Label:
                                                                text: root.curve_param.unitName[16]
                                                                size_hint: None, None
                                                                size: self.texture_size
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.unit_font_size

                        TabbedPanelItem:
                            
                            text: 'Raw Data'
                            font_name: './arialuni.ttf'
                            background_down: r'.\tabNormal.png'
                            background_normal: r'.\tabDown.PNG'   
 
                            BoxLayout:
                                orientation: 'horizontal'
                                size_hint: .99, .99
                                canvas.before:
                                    Color: 
                                        rgba: (0, 0, 0, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height  

                                StackLayout:
                                    size_hint: .2, 1

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_0_0
                                            text: root.raw_data_param.param_name_row_0[0]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_0_0
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_0_0
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_0_1
                                            text: root.raw_data_param.param_name_row_0[1]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_0_1
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_0_1
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size      

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_0_2
                                            text: root.raw_data_param.param_name_row_0[2]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_0_2
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_0_2
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size   

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_0_3
                                            text: root.raw_data_param.param_name_row_0[3]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_0_3
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_0_3
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size   

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_0_4
                                            text: root.raw_data_param.param_name_row_0[4]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_0_4
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_0_4
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size   

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_0_5
                                            text: root.raw_data_param.param_name_row_0[5]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_0_5
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_0_5
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size   

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_0_6
                                            text: root.raw_data_param.param_name_row_0[6]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_0_6
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_0_6
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_0_7
                                            text: root.raw_data_param.param_name_row_0[7]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_0_7
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_0_7
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                StackLayout:
                                    size_hint: .2, 1

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_1_0
                                            text: root.raw_data_param.param_name_row_1[0]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_1_0
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_1_0
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_1_1
                                            text: root.raw_data_param.param_name_row_1[1]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_1_1
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_1_1
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_1_2
                                            text: root.raw_data_param.param_name_row_1[2]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_1_2
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_1_2
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_1_3
                                            text: root.raw_data_param.param_name_row_1[3]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_1_3
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_1_3
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_1_4
                                            text: root.raw_data_param.param_name_row_1[4]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_1_4
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_1_4
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_1_5
                                            text: root.raw_data_param.param_name_row_1[5]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_1_5
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_1_5
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_1_6
                                            text: root.raw_data_param.param_name_row_1[6]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_1_6
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_1_6
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_1_7
                                            text: root.raw_data_param.param_name_row_1[7]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_1_7
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_1_7
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                StackLayout:
                                    size_hint: .2, 1

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_2_0
                                            text: root.raw_data_param.param_name_row_2[0]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_2_0
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_2_0
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_2_1
                                            text: root.raw_data_param.param_name_row_2[1]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_2_1
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_2_1
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_2_2
                                            text: root.raw_data_param.param_name_row_2[2]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_2_2
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_2_2
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_2_3
                                            text: root.raw_data_param.param_name_row_2[3]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_2_3
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_2_3
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_2_4
                                            text: root.raw_data_param.param_name_row_2[4]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_2_4
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_2_4
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_2_5
                                            text: root.raw_data_param.param_name_row_2[5]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_2_5
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_2_5
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_2_6
                                            text: root.raw_data_param.param_name_row_2[6]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_2_6
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_2_6
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_2_7
                                            text: root.raw_data_param.param_name_row_2[7]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_2_7
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_2_7
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                StackLayout:
                                    size_hint: .2, 1

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_3_0
                                            text: root.raw_data_param.param_name_row_3[0]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_3_0
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_3_0
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_3_1
                                            text: root.raw_data_param.param_name_row_3[1]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_3_1
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_3_1
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_3_2
                                            text: root.raw_data_param.param_name_row_3[2]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_3_2
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_3_2
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_3_3
                                            text: root.raw_data_param.param_name_row_3[3]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_3_3
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_3_3
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_3_4
                                            text: root.raw_data_param.param_name_row_3[4]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_3_4
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_3_4
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_3_5
                                            text: root.raw_data_param.param_name_row_3[5]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_3_5
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_3_5
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_3_6
                                            text: root.raw_data_param.param_name_row_3[6]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_3_6
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_3_6
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_3_7
                                            text: root.raw_data_param.param_name_row_3[7]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_3_7
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_3_7
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                StackLayout:
                                    size_hint: .2, 1

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_4_0
                                            text: root.raw_data_param.param_name_row_4[0]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_4_0
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_4_0
                                            text: 'V'
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_4_1
                                            text: root.raw_data_param.param_name_row_4[1]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_4_1
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_4_1
                                            text: 'A'
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_4_2
                                            text: root.raw_data_param.param_name_row_4[2]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_4_2
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_4_2
                                            text: 'W'
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_4_3
                                            text: root.raw_data_param.param_name_row_4[3]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_4_3
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_4_3
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_4_4
                                            text: root.raw_data_param.param_name_row_4[4]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_4_4
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_4_4
                                            text: 'W'
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_4_5
                                            text: root.raw_data_param.param_name_row_4[5]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_4_5
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_4_5
                                            text: '%'
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_4_6
                                            text: root.raw_data_param.param_name_row_4[6]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_4_6
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_4_6
                                            text: ''
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                                    AnchorLayout:
                                        size_hint: .5, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_name_4_7
                                            text: root.raw_data_param.param_name_row_4[7]
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                 

                                    AnchorLayout:
                                        size_hint: .3, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_val_4_7
                                            text: ''
                                            size_hint: 1, .5
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: .2, .125       
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: lbl_raw_data_unit_4_7
                                            text: '%'
                                            size_hint: 1, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.raw_data_font_size  

                        TabbedPanelItem:
                            
                            text: '統計數據'
                            font_name: './arialuni.ttf'
                            background_down: r'.\tabNormal.png'
                            background_normal: r'.\tabDown.PNG'   
 

                            BoxLayout:
                                orientation: 'vertical'
                                size_hint: .99, .99
                                canvas.before:
                                    Color: 
                                        rgba: (0, 0, 0, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height  

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'

                                        Label:
                                            text: 'Total Count'
                                            size_hint: .5, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.statisic_font_size         

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'

                                        Label:
                                            id: total_test_cnt
                                            text: ''
                                            size_hint: .5, .7
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.statisic_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'

                                        Label:
                                            text: 'Pass Count'
                                            size_hint: .5, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.statisic_font_size         

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'

                                        Label:
                                            id: pass_test_cnt
                                            text: ''
                                            size_hint: .5, .7
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.statisic_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'

                                        Label:
                                            text: 'Fail Count'
                                            size_hint: .5, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.statisic_font_size         

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'

                                        Label:
                                            id: fail_test_cnt
                                            text: ''
                                            size_hint: .5, .7
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.statisic_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'right'
                                        anchor_y: 'center'

                                        Label:
                                            text: 'Pass Rate (%)'
                                            size_hint: .5, 1
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.statisic_font_size         

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'left'
                                        anchor_y: 'center'

                                        Label:
                                            id: pass_rate
                                            text: ''
                                            size_hint: .5, .7
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.statisic_font_size                      

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

        TabbedPanelItem:
            
            text: 'Reload'
            font_name: './arialuni.ttf'
            background_down: r'.\tabDown.PNG'
            background_normal: r'.\tabNormal.png'   
            on_release: root.TabbedPanel_choosed('Reload')

            canvas.before:
                Color: 
                    group: 'Color'
                    rgba: (.2, .2, .2, 1)
                Rectangle: 
                    pos: self.x, self.y
                    size: self.width, self.height  

            BoxLayout:
                orientation: 'horizontal'
                size_hint: 1, 1         

                AnchorLayout:
                    size_hint: .2, 1
                    anchor_x: 'center'
                    anchor_y: 'bottom'    

                    BoxLayout:
                        orientation: 'vertical'
                        size_hint: 1, .99

                        BoxLayout:
                            orientation: 'vertical'
                            size_hint: 1, 1

                            Label:
                                text: '    量測結果'
                                size_hint: None, None
                                size: self.texture_size
                                font_name: './arialuni.ttf'

                            AnchorLayout:
                                size_hint: 1, .7
                                anchor_x: 'center'
                                anchor_y: 'top'

                                ScrollView:
                                    size_hint: .95, 1
                                    do_scroll_x: False    
                                    canvas.before:
                                        Color: 
                                            rgba: (0, 0, 0, 1)
                                        Rectangle: 
                                            pos: self.x, self.y
                                            size: self.width, self.height  

                                    GridLayout:
                                        cols: 2
                                        size_hint: 1.,None
                                        height: self.minimum_height 
                                        spacing : 0, 0

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 12
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                text: 'Name'
                                                size_hint: 1.5, 1
                                                font_size: root.font_size.title_lbl_font_size

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 12
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                text: 'Log'
                                                size_hint: .5, 1
                                                font_size: root.font_size.title_lbl_font_size

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_0
                                                text: root.curve_param.curveName[0]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.instr_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_0
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_1
                                                text: root.curve_param.curveName[1]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.instr_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_1
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_2
                                                text: root.curve_param.curveName[2]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.instr_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_2
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_3
                                                text: root.curve_param.curveName[3]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.instr_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_3
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_4
                                                text: root.curve_param.curveName[4]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.instr_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_4
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_5
                                                text: root.curve_param.curveName[5]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.instr_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_5
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_6
                                                text: root.curve_param.curveName[6]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.instr_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_6
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_7
                                                text: root.curve_param.curveName[7]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.instr_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_7
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_8
                                                text: root.curve_param.curveName[8]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.instr_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_8
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_9
                                                text: root.curve_param.curveName[9]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.instr_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_9
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 11
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                            Label:
                                text: '    控制板結果'
                                size_hint: None, None
                                size: self.texture_size
                                font_name: './arialuni.ttf'

                            AnchorLayout:
                                size_hint: 1, .25
                                anchor_x: 'center'
                                anchor_y: 'top'

                                ScrollView:
                                    size_hint: .95, .99
                                    do_scroll_x: False    
                                    canvas.before:
                                        Color: 
                                            rgba: (0, 0, 0, 1)
                                        Rectangle: 
                                            pos: self.x, self.y
                                            size: self.width, self.height  

                                    GridLayout:
                                        cols: 2
                                        size_hint: 1.,None
                                        height: self.minimum_height 
                                        spacing : 0, 0

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 5
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                text: 'Name'
                                                size_hint: 1, 1
                                                font_size: root.font_size.title_lbl_font_size

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 5
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                text: 'Log'
                                                size_hint: 1, 1
                                                font_size: root.font_size.title_lbl_font_size

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_10
                                                text: root.curve_param.curveName[10]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_10
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_11
                                                text: root.curve_param.curveName[11]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_11
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_12
                                                text: root.curve_param.curveName[12]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_12
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_13
                                                text: root.curve_param.curveName[13]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_13
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_14
                                                text: root.curve_param.curveName[14]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_14
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_15
                                                text: root.curve_param.curveName[15]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_15
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1.5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_curve_name_16
                                                text: root.curve_param.curveName[16]
                                                size_hint: 1, 1
                                                font_name: './arialuni.ttf'
                                                font_size: root.font_size.board_lbl_font_size
                                                markup: True

                                        AnchorLayout:
                                            size_hint: .5, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            Label:
                                                id: reload_lbl_enable_16
                                                text: 'N/A'
                                                size_hint: 1, 1
                                                markup: True

                                        AnchorLayout:
                                            size_hint: 1, None       
                                            height: self.parent.parent.height / 4
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                            AnchorLayout:
                                size_hint: 1, .1
                                anchor_x: 'center'
                                anchor_y: 'top'

                                BoxLayout:
                                    orientation:　'horizontal'
                                    size_hint: .95, .97 
                                    
                                    canvas.before:
                                        Color: 
                                            rgba: (0, 0, 0, 1)
                                        Rectangle: 
                                            pos: self.x, self.y
                                            size: self.width, self.height  

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'        

                                        Button:
                                            text: 'Choose File'
                                            size_hint: .5, .7
                                            font_size: 26
                                            on_press: root.loadFile()

                AnchorLayout:
                    size_hint: .8, 1
                    anchor_x: 'center'
                    anchor_y: 'bottom' 
                            
                    text: '圖形'
                    font_name: './arialuni.ttf'
                    background_down: r'.\tabNormal.png'
                    background_normal: r'.\tabDown.PNG'   

                    BoxLayout:
                        orientation: 'vertical'
                        size_hint: 1, 1
                        canvas.before:
                            Color: 
                                rgba: (.2, .2, .2, 1)
                            Rectangle: 
                                pos: self.x, self.y
                                size: self.width, self.height  
                        Label:
                            text: '  Graph0'
                            size_hint: None, None
                            size: self.texture_size

                        AnchorLayout:
                            size_hint: 1, .5
                            anchor_x: 'left'
                            anchor_y: 'top'         

                            MatplotFigure:
                                id: reload_fig_0
                                size_hint: .99, .97
                                canvas.before:
                                    Color: 
                                        rgba: (0, 0, 0, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height  

                            FloatLayout:
                                MatplotNavToolbar_reload_0:       
                                    id: reload_tool_bar_graph_0          
                                    figure_widget: reload_fig_0
                                    info_lbl_0: reload_info_lbl_0
                                    cursor_line_0: reload_cursor_line_0
                                    move_btn_reload_0: move_btn_reload_0
                                    zoom_in_btn_reload_0: zoom_in_btn_reload_0

                                    FloatLayout:        
                                        Widget:
                                            id: reload_cursor_line_0
                                            canvas.before:                                                
                                                Color: 
                                                    group: 'Color'
                                                    rgba: (1, 1, 1, 0)
                                                Rectangle:
                                                    group: 'Rect'
                                                    size: 1, 417

                                    FloatLayout:
                                        Label:
                                            id: reload_info_lbl_0
                                            size: self.texture_size
                                            markup: True
                                            # text_size: self.size   
                                            font_name: './arialuni.ttf'

                                    FloatLayout:
                                        BoxLayout:
                                            orientation: "vertical"
                                            pos: 1860, 538
                                            size_hint: .1, .2

                                            AnchorLayout:
                                                size_hint: 1, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center'                                                  

                                                ToggleButton:
                                                    size_hint: .8, .8
                                                    id: move_btn_reload_0
                                                    group: '0'
                                                    text: 'M'

                                            AnchorLayout:
                                                size_hint: 1, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center'                                                  

                                                ToggleButton:
                                                    size_hint: .8, .8
                                                    id: zoom_in_btn_reload_0
                                                    group: '0'
                                                    text: '+'

                                            AnchorLayout:
                                                size_hint: 1, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center'                                                  

                                                Button:
                                                    size_hint: .8, .8
                                                    id: home_btn_reload_0
                                                    text: 'H'
                                                    on_release: root.plotGraph([0])

                        Label:
                            text: '  Graph1'
                            size_hint: None, None
                            size: self.texture_size

                        AnchorLayout:
                            size_hint: 1, .5
                            anchor_x: 'left'
                            anchor_y: 'top'         

                            MatplotFigure:
                                id: reload_fig_1
                                size_hint: .99, .97
                                canvas.before:
                                    Color: 
                                        rgba: (0, 0, 0, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height

                            FloatLayout:
                                MatplotNavToolbar_reload_1:       
                                    id: reload_tool_bar_graph_1
                                    figure_widget: reload_fig_1       
                                    cursor_line_1: reload_cursor_line_1
                                    info_lbl_1: reload_info_lbl_1
                                    move_btn_reload_1: move_btn_reload_1
                                    zoom_in_btn_reload_1: zoom_in_btn_reload_1

                                    FloatLayout:        
                                        Widget:
                                            id: reload_cursor_line_1
                                            canvas.before:                                                
                                                Color: 
                                                    group: 'Color'
                                                    rgba: (1, 1, 1, 0)
                                                Rectangle:
                                                    group: 'Rect'
                                                    size: 1, 417

                                    FloatLayout:
                                        Label:
                                            id: reload_info_lbl_1
                                            size: self.texture_size
                                            markup: True
                                            # text_size: self.size   
                                            font_name: './arialuni.ttf'

                                    FloatLayout:
                                        BoxLayout:
                                            orientation: "vertical"
                                            pos: 1860, 11
                                            size_hint: .1, .2

                                            AnchorLayout:
                                                size_hint: 1, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center'                                                  

                                                ToggleButton:
                                                    size_hint: .8, .8
                                                    id: move_btn_reload_1
                                                    group: '1'
                                                    text: 'M'

                                            AnchorLayout:
                                                size_hint: 1, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center'                                                  

                                                ToggleButton:
                                                    size_hint: .8, .8
                                                    id: zoom_in_btn_reload_1
                                                    group: '1'
                                                    text: '+'

                                            AnchorLayout:
                                                size_hint: 1, 1
                                                anchor_x: 'center'
                                                anchor_y: 'center'                                                  

                                                Button:
                                                    size_hint: .8, .8
                                                    id: home_btn_reload_1
                                                    text: 'H'
                                                    on_release: root.plotGraph([1])

        TabbedPanelItem:
            
            text: '電源控制'
            font_name: './arialuni.ttf'
            background_down: r'.\tabDown.PNG'
            background_normal: r'.\tabNormal.png'   
            on_release: root.TabbedPanel_choosed('電源控制')

            canvas.before:
                Color: 
                    group: 'Color'
                    rgba: (.2, .2, .2, 1)
                Rectangle: 
                    pos: self.x, self.y
                    size: self.width, self.height  

            TabbedPanel:
                size_hint: 1, 1
                do_default_tab: False
                
                tab_height: 20 

                TabbedPanelItem:
                    
                    text: 'TOS5200'
                    font_name: './arialuni.ttf'
                    background_down: r'.\tabNormal.png'
                    background_normal: r'.\tabDown.PNG'

                    canvas.before:
                        Color: 
                            group: 'Color'
                            rgba: (.2, .2, .2, 1)
                        Rectangle: 
                            pos: self.x, self.y
                            size: self.width, self.height 

                    BoxLayout:
                        orientation: 'vertical'
                        size_hint: 1, 1   

                        Label:
                            text: '    Panel'
                            size_hint: None, None
                            size: self.texture_size
                            font_name: './arialuni.ttf'

                        AnchorLayout:
                            size_hint: 1, .5
                            anchor_x: 'center'
                            anchor_y: 'top'   

                            BoxLayout:
                                orientation: 'horizontal'
                                size_hint: .99, .99
                                canvas.before:
                                    Color: 
                                        group: 'Color'
                                        rgba: (0, 0, 0, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height    

                                BoxLayout:
                                    orientation: 'vertical'
                                    size_hint: 1, 1

                                    Label:
                                        text: 'Instrument Config'
                                        size_hint: 1, .2
                                        font_name: './arialuni.ttf'
                                        font_size: root.font_size.experiment_setting_font_size

                                    StackLayout:
                                        size_hint: 1, .8

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .66
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Frequency (Hz)'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Label:
                                                    id: tos5200_panel_frequency
                                                    text: ''
                                                    size_hint: .5, .8
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Voltage (V)'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'        

                                                    Label:
                                                        text: 'Test'
                                                        size_hint: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20                                                

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'        

                                                    Label:
                                                        text: 'Limit'
                                                        size_hint: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20   

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: tos5200_panel_voltage_test
                                                        text: ''
                                                        size_hint: .5, .8
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: tos5200_panel_voltage_limit
                                                        text: ''
                                                        size_hint: .5, .8
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Current Limit (mA)'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'        

                                                    Label:
                                                        text: 'Upper'
                                                        size_hint: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20                                                

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'        

                                                    Label:
                                                        text: 'Lower'
                                                        size_hint: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20   

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: tos5200_panel_current_limit_upper
                                                        text: ''
                                                        size_hint: .5, .8
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: tos5200_panel_current_limit_lower
                                                        text: ''
                                                        size_hint: .5, .8
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .66
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Test Time (s)'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Label:
                                                    id: tos5200_panel_test_time
                                                    text: ''
                                                    size_hint: .5, .8
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Voltage Time (s)'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'        

                                                    Label:
                                                        text: 'Rise Time'
                                                        size_hint: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20                                                

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'        

                                                    Label:
                                                        text: 'Fall Time'
                                                        size_hint: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20   

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: tos5200_panel_voltage_rise_time
                                                        text: ''
                                                        size_hint: .8, .8
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: tos5200_panel_voltage_fall_time
                                                        text: ''
                                                        size_hint: .8, .8
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .66
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Start Voltage'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Label:
                                                    id: tos5200_panel_start_voltage
                                                    text: ''
                                                    size_hint: .5, .8
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .66
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Meas Mode'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Label:
                                                    id: tos5200_panel_meas_mode
                                                    text: ''
                                                    size_hint: .5, .8
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                BoxLayout:
                                    orientation: 'vertical'
                                    size_hint: 1, 1

                                    Label:
                                        text: 'Meas Result'
                                        size_hint: 1, .2
                                        font_name: './arialuni.ttf'
                                        font_size: root.font_size.experiment_setting_font_size

                                    StackLayout:
                                        size_hint: 1, .8

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .33, .5

                                            AnchorLayout:
                                                size_hint: 1, .5
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Test Round'
                                                    size_hint: 1, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .5
                                                anchor_x: 'center'
                                                anchor_y: 'top'        

                                                Label:
                                                    id: tos5200_rpt_test_round
                                                    text: ''
                                                    size_hint: .5, .5
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .33, .5

                                            AnchorLayout:
                                                size_hint: 1, .5
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Voltage (V)'
                                                    size_hint: 1, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .5
                                                anchor_x: 'center'
                                                anchor_y: 'top'        

                                                Label:
                                                    id: tos5200_rpt_voltage
                                                    text: ''
                                                    size_hint: .5, .5
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .33, .5

                                            AnchorLayout:
                                                size_hint: 1, .5
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Current (mA)'
                                                    size_hint: 1, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .5
                                                anchor_x: 'center'
                                                anchor_y: 'top'        

                                                Label:
                                                    id: tos5200_rpt_current
                                                    text: ''
                                                    size_hint: .5, .5
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .5, .5

                                            AnchorLayout:
                                                size_hint: 1, .5
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Test Time (s)'
                                                    size_hint: 1, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .5
                                                anchor_x: 'center'
                                                anchor_y: 'top'        

                                                Label:
                                                    id: tos5200_rpt_test_time
                                                    text: ''
                                                    size_hint: .3, .5
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .5, .5

                                            AnchorLayout:
                                                size_hint: 1, .5
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Test Result'
                                                    size_hint: 1, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .5
                                                anchor_x: 'center'
                                                anchor_y: 'top'        

                                                Label:
                                                    id: tos5200_rpt_test_result
                                                    text: ''
                                                    size_hint: .3, .5
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                                    canvas.before:
                                                        Color: 
                                                            rgba: (.2, .2, .2, 1)                                                    
                                                        Line:
                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                            width: 2
                                                        Color: 
                                                            rgba: (.1, .1, .1, 1)
                                                        Rectangle: 
                                                            pos: self.x, self.y
                                                            size: self.width, self.height                                                    

                        BoxLayout:
                            orientation: 'horizontal'
                            size_hint: 1, .1  

                            BoxLayout:
                                orientation: 'horizontal'
                                size_hint: .33, 1  

                                AnchorLayout:
                                    size_hint: .33, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center'                                 

                                AnchorLayout:
                                    size_hint: .33, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center' 

                                    Button:
                                        text: 'Start'
                                        size_hint: 1, .8
                                        font_size: root.font_size.experiment_setting_font_size
                                        on_release: root.tos5200_start()

                                BoxLayout:
                                    orientation: 'vertical'
                                    size_hint: .33, 1

                                    BoxLayout:
                                        orientation: 'horizontal'
                                        size_hint: 1, .5

                                        AnchorLayout:
                                            size_hint: 1, 1
                                            anchor_x: 'center'
                                            anchor_y: 'center'   

                                            Label:
                                                size_hint: .2, 1  
                                                text: 'Test Round:           '

                                        AnchorLayout:
                                            size_hint: .5, 1
                                            anchor_x: 'left'
                                            anchor_y: 'center'   

                                            TextInput:
                                                id: tos5200_test_round
                                                size_hint: 1, .8
                                                text: '1'         
                                                input_filter: 'int'
                                                text_validate_unfocus: True                                          
                                                multiline: False                                    
                                                padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                padding_y: ( self.height - self.line_height ) / 2     

                                    BoxLayout:
                                        orientation: 'horizontal'
                                        size_hint: 1, .5

                                        AnchorLayout:
                                            size_hint: 1, 1
                                            anchor_x: 'center'
                                            anchor_y: 'center'   

                                            Label:
                                                size_hint: .2, 1  
                                                text: 'Stop Duration (s): '

                                        AnchorLayout:
                                            size_hint: .5, 1
                                            anchor_x: 'left'
                                            anchor_y: 'center'   

                                            TextInput:
                                                id: tos5200_stop_duration
                                                size_hint: 1, .8
                                                text: '2'         
                                                input_filter: 'float'
                                                text_validate_unfocus: True                                          
                                                multiline: False                                    
                                                padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                padding_y: ( self.height - self.line_height ) / 2                                                                               

                            AnchorLayout:
                                size_hint: .33, 1
                                anchor_x: 'center'
                                anchor_y: 'center' 

                                Button:
                                    text: 'Stop'
                                    size_hint: .3, .8
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.tos5200_stop()

                            AnchorLayout:
                                size_hint: .33, 1
                                anchor_x: 'center'
                                anchor_y: 'center' 

                                Button:
                                    text: 'Refresh'
                                    size_hint: .3, .8
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.tos5200_config_refresh()

                        Label:
                            text: '    Config'
                            size_hint: None, None
                            size: self.texture_size
                            font_name: './arialuni.ttf'

                        AnchorLayout:
                            size_hint: 1, .5
                            anchor_x: 'center'
                            anchor_y: 'top'   

                            BoxLayout:
                                size_hint: .99, .99
                                canvas.before:
                                    Color: 
                                        group: 'Color'
                                        rgba: (0, 0, 0, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height    

                                AnchorLayout:
                                    size_hint: 1, 1
                                    anchor_x: 'center'
                                    anchor_y: 'center' 

                                    StackLayout:
                                        size_hint: .5, .8

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .66
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Frequency (Hz)'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Spinner:
                                                    id: tos5200_config_frequency
                                                    text: '60'
                                                    values: ['50', '60']
                                                    size_hint: .5, .8
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Voltage (V)'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'        

                                                    Label:
                                                        text: 'Test'
                                                        size_hint: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20                                                

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'        

                                                    Label:
                                                        text: 'Limit'
                                                        size_hint: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20   

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    TextInput:
                                                        id: tos5200_config_voltage_test
                                                        text: '220'
                                                        size_hint: .5, .8
                                                        input_filter: 'float'
                                                        text_validate_unfocus: True                                          
                                                        multiline: False                                    
                                                        padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                        padding_y: ( self.height - self.line_height ) / 2                                                          
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    TextInput:
                                                        id: tos5200_config_voltage_limit
                                                        text: '1000'
                                                        size_hint: .5, .8
                                                        input_filter: 'float'
                                                        text_validate_unfocus: True                                          
                                                        multiline: False                                    
                                                        padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                        padding_y: ( self.height - self.line_height ) / 2                                                          
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Current Limit (mA)'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'        

                                                    Label:
                                                        text: 'Upper'
                                                        size_hint: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20                                                

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: .5, 1

                                                    CheckBox:
                                                        id: tos5200_config_current_limit_lower_active
                                                        size_hint: .5, 1
                                                        active: True

                                                    AnchorLayout:
                                                        size_hint: .5, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'        

                                                        Label:
                                                            text: 'Lower'
                                                            size_hint: .5, 1
                                                            font_name: './arialuni.ttf'
                                                            font_size: 20   

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    TextInput:
                                                        id: tos5200_config_current_limit_upper
                                                        text: '110'
                                                        size_hint: .8, .8
                                                        input_filter: 'float'
                                                        text_validate_unfocus: True                                          
                                                        multiline: False                                    
                                                        padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                        padding_y: ( self.height - self.line_height ) / 2                                                          
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    TextInput:
                                                        id: tos5200_config_current_limit_lower
                                                        text: '0.01'
                                                        size_hint: .8, .8
                                                        input_filter: 'float'
                                                        text_validate_unfocus: True                                          
                                                        multiline: False                                    
                                                        padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                        padding_y: ( self.height - self.line_height ) / 2                                                          
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20


                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Test Time (s)'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center' 

                                                CheckBox:
                                                    id: tos5200_config_test_time_active
                                                    size_hint: 1, 1
                                                    active: True

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                TextInput:
                                                    id: tos5200_config_test_time
                                                    text: '2.0'
                                                    size_hint: .5, .8
                                                    input_filter: 'float'
                                                    text_validate_unfocus: True                                          
                                                    multiline: False                                    
                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                    padding_y: ( self.height - self.line_height ) / 2                                                      
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Voltage Time (s)'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'        

                                                    Label:
                                                        text: 'Rise Time'
                                                        size_hint: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20                                                

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'        

                                                    Label:
                                                        text: 'Fall Time'
                                                        size_hint: .5, 1
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20   

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, .33

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    TextInput:
                                                        id: tos5200_config_voltage_rise_time
                                                        text: '2.0'                                                        
                                                        size_hint: .8, .8
                                                        input_filter: 'float'
                                                        text_validate_unfocus: True                                          
                                                        multiline: False                                    
                                                        padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                        padding_y: ( self.height - self.line_height ) / 2  
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20

                                                AnchorLayout:
                                                    size_hint: .5, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: tos5200_config_voltage_fall_time
                                                        text: 'Enabled'
                                                        values: ['Enabled', 'Disabled']
                                                        size_hint: .8, .8
                                                        font_name: './arialuni.ttf'
                                                        font_size: 20

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .66
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Start Voltage'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Spinner:
                                                    id: tos5200_config_start_voltage
                                                    text: 'Disabled'
                                                    values: ['Enabled', 'Disabled']
                                                    size_hint: .5, .8
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .25, .5

                                            AnchorLayout:
                                                size_hint: 1, .66
                                                anchor_x: 'center'
                                                anchor_y: 'center'        

                                                Label:
                                                    text: 'Meas Mode'
                                                    size_hint: .5, 1
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                                            AnchorLayout:
                                                size_hint: 1, .33
                                                anchor_x: 'center'
                                                anchor_y: 'center'

                                                Spinner:
                                                    id: tos5200_config_meas_mode
                                                    text: 'RMS'
                                                    values: ['RMS', 'AVE']
                                                    size_hint: .5, .8
                                                    font_name: './arialuni.ttf'
                                                    font_size: 20

                        BoxLayout:
                            orientation: 'horizontal'
                            size_hint: 1, .1 

                            AnchorLayout:
                                size_hint: .25, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    id: btn_tos5200_set
                                    size_hint: .3, .8
                                    text: 'Set'
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.tos5200_config_set()

                            AnchorLayout:
                                size_hint: .25, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    id: btn_tos5200_load
                                    size_hint: .3, .8
                                    text: 'Load'
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.loadtos5200Cfg()

                            AnchorLayout:
                                size_hint: .25, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    id: btn_tos5200_save
                                    size_hint: .3, .8
                                    text: 'Save'
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.save_tos5200_setting_cfg()

                            BoxLayout:
                                orientation: 'vertical'
                                size_hint: .25, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Label:
                                    size_hint: 1, .3
                                    text: 'Saved Config Name:'

                                AnchorLayout:
                                    size_hint: 1, .7
                                    anchor_x: 'center'
                                    anchor_y: 'top' 

                                    TextInput:
                                        size_hint: .6, .8
                                        id: tos5200_setting_save_cfg
                                        text: 'Default'
                                        font_name: './arialuni.ttf'
                                        text_validate_unfocus: True
                                        multiline: False                                    
                                        padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                        padding_y: ( self.height - self.line_height ) / 2  
                                        font_size: root.font_size.experiment_setting_font_size

                TabbedPanelItem:
                    
                    text: 'NF_DP030s'
                    font_name: './arialuni.ttf'
                    background_down: r'.\tabNormal.png'
                    background_normal: r'.\tabDown.PNG'

                    BoxLayout:
                        orientation: 'vertical'
                        size_hint: 1, 1

                        TabbedPanel:
                            id: NF
                            size_hint: 1, 1
                            do_default_tab: False
                            
                            tab_height: 20 

                            TabbedPanelItem:
                                id: NF_continuous
                                text: 'Continuous'
                                font_name: './arialuni.ttf'
                                background_down: r'.\tabNormal.png'
                                background_normal: r'.\tabDown.PNG'

                                canvas.before:
                                    Color: 
                                        group: 'Color'
                                        rgba: (.2, .2, .2, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    BoxLayout:
                                        orientation: 'vertical'
                                        size_hint: .5, 1

                                        Label:
                                            text: '    Config'
                                            size_hint: None, None
                                            size: self.texture_size
                                            font_name: './arialuni.ttf'

                                        AnchorLayout:
                                            size_hint: 1, .5
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            BoxLayout:
                                                orientation: 'vertical'
                                                size_hint: .99, .99

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (0, 0, 0, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'AC/DC Mode'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: .6, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Spinner:
                                                            id: NF_Continuous_Mode
                                                            size_hint: .3, .8
                                                            text: 'AC'
                                                            font_name: './arialuni.ttf'
                                                            values: ['AC', 'ACDC']
                                                            font_size: root.font_size.experiment_setting_font_size
                                                            on_text: root.NF_continuous_mode_change(self.text)

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'AC Voltage (V)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: .6, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        TextInput:
                                                            id: NF_Continuous_AC_Voltage
                                                            size_hint: .3, .8
                                                            text: '220'
                                                            input_filter: 'float'
                                                            font_name: './arialuni.ttf'
                                                            text_validate_unfocus: True
                                                            multiline: False                                    
                                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                            padding_y: ( self.height - self.line_height ) / 2  
                                                            font_size: root.font_size.experiment_setting_font_size

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        id: NF_Continuous_DC_Voltage_lbl
                                                        size_hint: .4, 1
                                                        text: '[color=404040]DC Voltage (V)[/color]'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size
                                                        markup: True

                                                    AnchorLayout:
                                                        size_hint: .6, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        TextInput:
                                                            id: NF_Continuous_DC_Voltage
                                                            size_hint: .3, .8
                                                            text: '0'
                                                            input_filter: 'float'
                                                            font_name: './arialuni.ttf'
                                                            text_validate_unfocus: True
                                                            multiline: False                                    
                                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                            padding_y: ( self.height - self.line_height ) / 2  
                                                            font_size: root.font_size.experiment_setting_font_size

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'Vrms limiter (V)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: .6, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        TextInput:
                                                            id: NF_Continuous_Vrms_Limiter
                                                            size_hint: .3, .8
                                                            text: '310'
                                                            input_filter: 'float'
                                                            font_name: './arialuni.ttf'
                                                            text_validate_unfocus: True
                                                            multiline: False                                    
                                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                            padding_y: ( self.height - self.line_height ) / 2  
                                                            font_size: root.font_size.experiment_setting_font_size

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'Frequency (Hz)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: .6, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        TextInput:
                                                            id: NF_Continuous_Frequency
                                                            size_hint: .3, .8
                                                            text: '60'
                                                            input_filter: 'float'
                                                            font_name: './arialuni.ttf'
                                                            text_validate_unfocus: True
                                                            multiline: False                                    
                                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                            padding_y: ( self.height - self.line_height ) / 2  
                                                            font_size: root.font_size.experiment_setting_font_size

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'Freq. limiter (Hz)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    BoxLayout:
                                                        orientation: 'horizontal'
                                                        size_hint: .6, 1

                                                        AnchorLayout:
                                                            size_hint: .25, 1
                                                            anchor_x: 'right'
                                                            anchor_y: 'center'

                                                            Label:
                                                                size_hint: .8, .8
                                                                text: 'Low'

                                                        AnchorLayout:
                                                            size_hint: .25, 1
                                                            anchor_x: 'left'
                                                            anchor_y: 'center'

                                                            TextInput:
                                                                id: NF_Continuous_Freq_Limiter_Low
                                                                size_hint: .8, .8
                                                                text: '40'
                                                                input_filter: 'float'
                                                                font_name: './arialuni.ttf'
                                                                text_validate_unfocus: True
                                                                multiline: False                                    
                                                                padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                padding_y: ( self.height - self.line_height ) / 2  
                                                                font_size: root.font_size.experiment_setting_font_size

                                                        AnchorLayout:
                                                            size_hint: .25, 1
                                                            anchor_x: 'right'
                                                            anchor_y: 'center'

                                                            Label:
                                                                size_hint: .8, .8
                                                                text: 'High'

                                                        AnchorLayout:
                                                            size_hint: .25, 1
                                                            anchor_x: 'left'
                                                            anchor_y: 'center'

                                                            TextInput:
                                                                id: NF_Continuous_Freq_Limiter_High
                                                                size_hint: .8, .8
                                                                text: '550'
                                                                input_filter: 'float'
                                                                font_name: './arialuni.ttf'
                                                                text_validate_unfocus: True
                                                                multiline: False                                    
                                                                padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                padding_y: ( self.height - self.line_height ) / 2  
                                                                font_size: root.font_size.experiment_setting_font_size

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'Phase (deg)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    BoxLayout:
                                                        orientation: 'horizontal'
                                                        size_hint: .6, 1

                                                        AnchorLayout:
                                                            size_hint: .25, 1
                                                            anchor_x: 'right'
                                                            anchor_y: 'center'

                                                            Label:
                                                                size_hint: .8, .8
                                                                text: 'Start'

                                                        AnchorLayout:
                                                            size_hint: .25, 1
                                                            anchor_x: 'left'
                                                            anchor_y: 'center'

                                                            TextInput:
                                                                id: NF_Continuous_Start_Phase
                                                                size_hint: .8, .8
                                                                text: '0'
                                                                input_filter: 'float'
                                                                font_name: './arialuni.ttf'
                                                                text_validate_unfocus: True
                                                                multiline: False                                    
                                                                padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                padding_y: ( self.height - self.line_height ) / 2  
                                                                font_size: root.font_size.experiment_setting_font_size

                                                        AnchorLayout:
                                                            size_hint: .25, 1
                                                            anchor_x: 'right'
                                                            anchor_y: 'center'

                                                            Label:
                                                                size_hint: .8, .8
                                                                text: 'Off'

                                                        AnchorLayout:
                                                            size_hint: .25, 1
                                                            anchor_x: 'left'
                                                            anchor_y: 'center'

                                                            TextInput:
                                                                id: NF_Continuous_Off_Phase
                                                                size_hint: .8, .8
                                                                text: '0'
                                                                input_filter: 'float'
                                                                font_name: './arialuni.ttf'
                                                                text_validate_unfocus: True
                                                                multiline: False                                    
                                                                padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                padding_y: ( self.height - self.line_height ) / 2  
                                                                font_size: root.font_size.experiment_setting_font_size

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'I peak limiter (A)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size
                                                        markup: True

                                                    BoxLayout:
                                                        orientation: 'horizontal'
                                                        size_hint: .6, 1

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1   

                                                            CheckBox:
                                                                size_hint: 1, 1 
                                                                id: NF_Continuous_Current_Peak_Limiter_Checkbox
                                                                active: True

                                                            Label:
                                                                size_hint: 1, 1 
                                                                text: 'OFF if exceed'

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1                                                        

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    size_hint: .8, .8
                                                                    text: 'Positive'
                                                                    font_name: './arialuni.ttf'

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Continuous_Current_Peak_Limiter_Positive
                                                                    size_hint: .8, 1
                                                                    text: '63'
                                                                    input_filter: 'float'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.experiment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1      

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    size_hint: .8, .8
                                                                    text: 'Negative'
                                                                    font_name: './arialuni.ttf'                                                          

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Continuous_Current_Peak_Limiter_Negative
                                                                    size_hint: .8, 1
                                                                    text: '-63'
                                                                    input_filter: 'float'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.experiment_setting_font_size

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'I rms limiter (A)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size
                                                        markup: True

                                                    BoxLayout:
                                                        orientation: 'horizontal'
                                                        size_hint: .6, 1

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1

                                                            CheckBox:
                                                                size_hint: 1, 1 
                                                                id: NF_Continuous_Current_rms_Limiter_Checkbox
                                                                active: True

                                                            Label:
                                                                size_hint: 1, 1 
                                                                text: 'OFF if exceed'

                                                        AnchorLayout:
                                                            size_hint: 2, 1
                                                            anchor_x: 'center'
                                                            anchor_y: 'center'

                                                            TextInput:
                                                                id: NF_Continuous_Current_rms_Limiter
                                                                size_hint: .3, .6
                                                                text: '15.8'
                                                                input_filter: 'float'
                                                                font_name: './arialuni.ttf'
                                                                text_validate_unfocus: True
                                                                multiline: False                                    
                                                                padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                padding_y: ( self.height - self.line_height ) / 2  
                                                                font_size: root.font_size.experiment_setting_font_size

                                    BoxLayout:
                                        orientation: 'vertical'
                                        size_hint: .5, 1

                                        Label:
                                            text: '    Meas Result'
                                            size_hint: None, None
                                            size: self.texture_size
                                            font_name: './arialuni.ttf'

                                        TabbedPanel:
                                            size_hint: 1, 1
                                            do_default_tab: False
                                            
                                            tab_height: 20 

                                            TabbedPanelItem:
                                                
                                                text: 'Normal'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1.5

                                                            Label:
                                                                size_hint: .4, 1
                                                                text: 'Voltage (V)'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: .6, 1                    

                                                                BoxLayout:
                                                                    orientation: 'vertical'
                                                                    size_hint: 1, 1 

                                                                    Label:
                                                                        size_hint: 1, .5
                                                                        text: 'RMS'
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 26

                                                                    AnchorLayout:
                                                                        size_hint: 1, .5
                                                                        anchor_x: 'center'
                                                                        anchor_y: 'top'

                                                                        Label:
                                                                            id: NF_continuous_rpt_voltage_rms
                                                                            text: ''
                                                                            size_hint: .8, .8
                                                                            font_name: './arialuni.ttf'
                                                                            font_size: 20

                                                                            canvas.before:
                                                                                Color: 
                                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                                Line:
                                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                    width: 2
                                                                                Color: 
                                                                                    rgba: (.1, .1, .1, 1)
                                                                                Rectangle: 
                                                                                    pos: self.x, self.y
                                                                                    size: self.width, self.height

                                                                BoxLayout:
                                                                    orientation: 'vertical'
                                                                    size_hint: 1, 1 

                                                                    Label:
                                                                        size_hint: 1, .5
                                                                        text: 'AVG'
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 26

                                                                    AnchorLayout:
                                                                        size_hint: 1, .5
                                                                        anchor_x: 'center'
                                                                        anchor_y: 'top'

                                                                        Label:
                                                                            id: NF_continuous_rpt_voltage_avg
                                                                            text: ''
                                                                            size_hint: .8, .8
                                                                            font_name: './arialuni.ttf'
                                                                            font_size: 20

                                                                            canvas.before:
                                                                                Color: 
                                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                                Line:
                                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                    width: 2
                                                                                Color: 
                                                                                    rgba: (.1, .1, .1, 1)
                                                                                Rectangle: 
                                                                                    pos: self.x, self.y
                                                                                    size: self.width, self.height

                                                                BoxLayout:
                                                                    orientation: 'vertical'
                                                                    size_hint: 1, 1 

                                                                    Label:
                                                                        size_hint: 1, .5
                                                                        text: 'Peak max'
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 26

                                                                    AnchorLayout:
                                                                        size_hint: 1, .5
                                                                        anchor_x: 'center'
                                                                        anchor_y: 'top'

                                                                        Label:
                                                                            id: NF_continuous_rpt_voltage_peak_max
                                                                            text: ''
                                                                            size_hint: .8, .8
                                                                            font_name: './arialuni.ttf'
                                                                            font_size: 20

                                                                            canvas.before:
                                                                                Color: 
                                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                                Line:
                                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                    width: 2
                                                                                Color: 
                                                                                    rgba: (.1, .1, .1, 1)
                                                                                Rectangle: 
                                                                                    pos: self.x, self.y
                                                                                    size: self.width, self.height

                                                                BoxLayout:
                                                                    orientation: 'vertical'
                                                                    size_hint: 1, 1 

                                                                    Label:
                                                                        size_hint: 1, .5
                                                                        text: 'Peak min'
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 26

                                                                    AnchorLayout:
                                                                        size_hint: 1, .5
                                                                        anchor_x: 'center'
                                                                        anchor_y: 'top'

                                                                        Label:
                                                                            id: NF_continuous_rpt_voltage_peak_min
                                                                            text: ''
                                                                            size_hint: .8, .8
                                                                            font_name: './arialuni.ttf'
                                                                            font_size: 20

                                                                            canvas.before:
                                                                                Color: 
                                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                                Line:
                                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                    width: 2
                                                                                Color: 
                                                                                    rgba: (.1, .1, .1, 1)
                                                                                Rectangle: 
                                                                                    pos: self.x, self.y
                                                                                    size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1.5

                                                            Label:
                                                                size_hint: .4, 1
                                                                text: 'Current (A)'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: .6, 1                    

                                                                BoxLayout:
                                                                    orientation: 'vertical'
                                                                    size_hint: 1, 1 

                                                                    Label:
                                                                        size_hint: 1, .5
                                                                        text: 'RMS'
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 26

                                                                    AnchorLayout:
                                                                        size_hint: 1, .5
                                                                        anchor_x: 'center'
                                                                        anchor_y: 'top'

                                                                        Label:
                                                                            id: NF_continuous_rpt_current_rms
                                                                            text: ''
                                                                            size_hint: .8, .8
                                                                            font_name: './arialuni.ttf'
                                                                            font_size: 20

                                                                            canvas.before:
                                                                                Color: 
                                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                                Line:
                                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                    width: 2
                                                                                Color: 
                                                                                    rgba: (.1, .1, .1, 1)
                                                                                Rectangle: 
                                                                                    pos: self.x, self.y
                                                                                    size: self.width, self.height

                                                                BoxLayout:
                                                                    orientation: 'vertical'
                                                                    size_hint: 1, 1 

                                                                    Label:
                                                                        size_hint: 1, .5
                                                                        text: 'AVG'
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 26
                                                                        
                                                                    AnchorLayout:
                                                                        size_hint: 1, .5
                                                                        anchor_x: 'center'
                                                                        anchor_y: 'top'

                                                                        Label:
                                                                            id: NF_continuous_rpt_current_avg
                                                                            text: ''
                                                                            size_hint: .8, .8
                                                                            font_name: './arialuni.ttf'
                                                                            font_size: 20

                                                                            canvas.before:
                                                                                Color: 
                                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                                Line:
                                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                    width: 2
                                                                                Color: 
                                                                                    rgba: (.1, .1, .1, 1)
                                                                                Rectangle: 
                                                                                    pos: self.x, self.y
                                                                                    size: self.width, self.height

                                                                BoxLayout:
                                                                    orientation: 'vertical'
                                                                    size_hint: 1, 1 

                                                                    Label:
                                                                        size_hint: 1, .5
                                                                        text: 'Peak max'
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 26
                                                                        
                                                                    AnchorLayout:
                                                                        size_hint: 1, .5
                                                                        anchor_x: 'center'
                                                                        anchor_y: 'top'

                                                                        Label:
                                                                            id: NF_continuous_rpt_current_peak_max
                                                                            text: ''
                                                                            size_hint: .8, .8
                                                                            font_name: './arialuni.ttf'
                                                                            font_size: 20

                                                                            canvas.before:
                                                                                Color: 
                                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                                Line:
                                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                    width: 2
                                                                                Color: 
                                                                                    rgba: (.1, .1, .1, 1)
                                                                                Rectangle: 
                                                                                    pos: self.x, self.y
                                                                                    size: self.width, self.height

                                                                BoxLayout:
                                                                    orientation: 'vertical'
                                                                    size_hint: 1, 1 

                                                                    Label:
                                                                        size_hint: 1, .5
                                                                        text: 'Peak min'
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 26
                                                                        
                                                                    AnchorLayout:
                                                                        size_hint: 1, .5
                                                                        anchor_x: 'center'
                                                                        anchor_y: 'top'
                                                                        
                                                                        Label:
                                                                            id: NF_continuous_rpt_current_peak_min
                                                                            text: ''
                                                                            size_hint: .8, .8
                                                                            font_name: './arialuni.ttf'
                                                                            font_size: 20

                                                                            canvas.before:
                                                                                Color: 
                                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                                Line:
                                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                    width: 2
                                                                                Color: 
                                                                                    rgba: (.1, .1, .1, 1)
                                                                                Rectangle: 
                                                                                    pos: self.x, self.y
                                                                                    size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                size_hint: 1, 1
                                                                text: 'Appearant Power (VA)'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_continuous_rpt_appearant_power
                                                                    size_hint: .5, .8
                                                                    text: ''
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.experiment_setting_font_size

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                size_hint: 1, 1
                                                                text: 'Active Power (W)'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_continuous_rpt_active_power
                                                                    size_hint: .5, .8
                                                                    text: ''
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.experiment_setting_font_size

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height


                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                size_hint: 1, 1
                                                                text: 'Inactive Power (Var)'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_continuous_rpt_inactive_power
                                                                    size_hint: .5, .8
                                                                    text: ''
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.experiment_setting_font_size

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                size_hint: 1, 1
                                                                text: 'Power Factor'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_continuous_rpt_power_factor
                                                                    size_hint: .5, .8
                                                                    text: ''
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.experiment_setting_font_size

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                size_hint: 1, 1
                                                                text: 'Crest Factor'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_continuous_rpt_crest_factor
                                                                    size_hint: .5, .8
                                                                    text: ''
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.experiment_setting_font_size

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                            TabbedPanelItem:
                                                
                                                text: 'Harmonic'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'horizontal'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: 'Harmonic'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                Label: 
                                                                    text: 'Irms (A)'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20
                                                                 
                                                                Label: 
                                                                    text: 'nth / 1st'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '1st'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_1
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_1
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '2nd'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_2
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_2
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '3rd'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_3
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_3
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '4th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_4
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_4
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '5th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_5
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_5
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '6th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_6
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_6
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '7th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_7
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_7
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '8th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_8
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_8
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '9th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_9
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_9
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '10th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_10
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_10
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '11th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_11
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_11
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '12th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_12
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_12
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '13th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_13
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_13
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '14th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_14
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_14
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '15th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_15
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_15
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '16th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_16
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_16
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '17th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_17
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_17
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '18th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_18
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_18
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '19th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_19
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_19
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '20th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_20
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_20
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: 'Harmonic'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                Label: 
                                                                    text: 'Irms (A)'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20
                                                                 
                                                                Label: 
                                                                    text: 'nth / 1st'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '21th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_21
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_21
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '22th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_22
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_22
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '23th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_23
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_23
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '24th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_24
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_24
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '25th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_25
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_25
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '26th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_26
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_26
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '27th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_27
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_27
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '28th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_28
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_28
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '29th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_29
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_29
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '30th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_30
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_30
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '31th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_31
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_31
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '32th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_32
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_32
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '33th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_33
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_33
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '34th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_34
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_34
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '35th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_35
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_35
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '36th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_36
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_36
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '37th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_37
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_37
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '38th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_38
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_38
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '39th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_39
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_39
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                            BoxLayout:
                                                                orientation: 'horizontal'
                                                                size_hint: 1, 1

                                                                Label:
                                                                    text: '40th'
                                                                    size_hint: 1, 1
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_current_40
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                                                                AnchorLayout:
                                                                    size_hint: 1, 1
                                                                    anchor_x: 'center'
                                                                    anchor_y: 'center' 

                                                                    Label: 
                                                                        id: NF_continuous_rpt_harmonic_ratio_40
                                                                        text: ''
                                                                        size_hint: .8, .8
                                                                        font_name: './arialuni.ttf'
                                                                        font_size: 20

                                                                        canvas.before:
                                                                            Color: 
                                                                                rgba: (.2, .2, .2, 1)                                                    
                                                                            Line:
                                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                                width: 2
                                                                            Color: 
                                                                                rgba: (.1, .1, .1, 1)
                                                                            Rectangle: 
                                                                                pos: self.x, self.y
                                                                                size: self.width, self.height

                            TabbedPanelItem:
                                id: NF_sequence
                                text: 'Sequence'
                                font_name: './arialuni.ttf'
                                background_down: r'.\tabNormal.png'
                                background_normal: r'.\tabDown.PNG'

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    BoxLayout:
                                        orientation: 'vertical'
                                        size_hint: 1, 1

                                        TabbedPanel:
                                            size_hint: 1, 9
                                            do_default_tab: False
                                            
                                            tab_height: 20 

                                            TabbedPanelItem:
                                                
                                                text: 'Step 0'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step0_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step0_AC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step0_AC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step0_DC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]DC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step0_DC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step0_DC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step0_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step0_Frequency
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step0_Frequency_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step0_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step0_Time
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step0_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step0_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step0_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step0_Start_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step0_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step0_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step0_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step0_Off_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step0_Jump_To_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Jump To[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Sequence_Step0_Jump_To
                                                                    size_hint: .3, .8
                                                                    text: '--'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.experiment_setting_font_size

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step0_Jump_Count_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Jump Count[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Sequence_Step0_Jump_Count
                                                                    size_hint: .3, .8
                                                                    text: '--'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.experiment_setting_font_size

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step0_Step_Termination_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Step Termination[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Sequence_Step0_Step_Termination
                                                                    size_hint: .3, .8
                                                                    text: '--'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.experiment_setting_font_size

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                            TabbedPanelItem:
                                                
                                                text: 'Step 1'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step1_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step1_AC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step1_AC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step1_DC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]DC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step1_DC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step1_DC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step1_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step1_Frequency
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step1_Frequency_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step1_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step1_Time
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step1_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step1_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step1_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step1_Start_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step1_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step1_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step1_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step1_Off_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step1_Jump_To_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Jump To[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step1_Jump_To_Enable
                                                                size_hint: .1, 1
                                                                active: False
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step1_Jump_To_lbl', 'NF_Sequence_Step1_Jump_Count_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step1_Jump_To
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step1_Jump_Count_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Jump Count[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step1_Jump_Count
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step1_Step_Termination_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Step Termination[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step1_Step_Termination
                                                                    size_hint: .6, .8
                                                                    input_filter: 'float'
                                                                    text: 'Continue'
                                                                    values: ['Continue', 'Hold', 'End']
                                                                    font_name: './arialuni.ttf' 
                                                                    font_size: root.font_size.environment_setting_font_size

                                            TabbedPanelItem:
                                                
                                                text: 'Step 2'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step2_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step2_AC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step2_AC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step2_DC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]DC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step2_DC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step2_DC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step2_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step2_Frequency
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step2_Frequency_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step2_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step2_Time
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step2_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step2_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step2_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step2_Start_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step2_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step2_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step2_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step2_Off_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step2_Jump_To_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Jump To[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step2_Jump_To_Enable
                                                                size_hint: .1, 1
                                                                active: False
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step2_Jump_To_lbl', 'NF_Sequence_Step2_Jump_Count_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step2_Jump_To
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step2_Jump_Count_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Jump Count[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step2_Jump_Count
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step2_Step_Termination_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Step Termination[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step2_Step_Termination
                                                                    size_hint: .6, .8
                                                                    input_filter: 'float'
                                                                    text: 'Continue'
                                                                    values: ['Continue', 'Hold', 'End']
                                                                    font_name: './arialuni.ttf' 
                                                                    font_size: root.font_size.environment_setting_font_size

                                            TabbedPanelItem:
                                                
                                                text: 'Step 3'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step3_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step3_AC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step3_AC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step3_DC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]DC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step3_DC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step3_DC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step3_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step3_Frequency
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step3_Frequency_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step3_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step3_Time
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step3_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step3_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step3_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step3_Start_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step3_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step3_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step3_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step3_Off_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step3_Jump_To_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Jump To[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step3_Jump_To_Enable
                                                                size_hint: .1, 1
                                                                active: False
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step3_Jump_To_lbl', 'NF_Sequence_Step3_Jump_Count_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step3_Jump_To
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step3_Jump_Count_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Jump Count[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step3_Jump_Count
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step3_Step_Termination_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Step Termination[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step3_Step_Termination
                                                                    size_hint: .6, .8
                                                                    input_filter: 'float'
                                                                    text: 'Continue'
                                                                    values: ['Continue', 'Hold', 'End']
                                                                    font_name: './arialuni.ttf' 
                                                                    font_size: root.font_size.environment_setting_font_size

                                            TabbedPanelItem:
                                                
                                                text: 'Step 4'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step4_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step4_AC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step4_AC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step4_DC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]DC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step4_DC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step4_DC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step4_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step4_Frequency
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step4_Frequency_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step4_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step4_Time
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step4_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step4_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step4_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step4_Start_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step4_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step4_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step4_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step4_Off_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step4_Jump_To_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Jump To[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step4_Jump_To_Enable
                                                                size_hint: .1, 1
                                                                active: False
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step4_Jump_To_lbl', 'NF_Sequence_Step4_Jump_Count_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step4_Jump_To
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step4_Jump_Count_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Jump Count[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step4_Jump_Count
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step4_Step_Termination_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Step Termination[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step4_Step_Termination
                                                                    size_hint: .6, .8
                                                                    input_filter: 'float'
                                                                    text: 'Continue'
                                                                    values: ['Continue', 'Hold', 'End']
                                                                    font_name: './arialuni.ttf' 
                                                                    font_size: root.font_size.environment_setting_font_size

                                            TabbedPanelItem:
                                                
                                                text: 'Step 5'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step5_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step5_AC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step5_AC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step5_DC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]DC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step5_DC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step5_DC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step5_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step5_Frequency
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step5_Frequency_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step5_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step5_Time
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step5_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step5_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step5_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step5_Start_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step5_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step5_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step5_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step5_Off_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step5_Jump_To_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Jump To[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step5_Jump_To_Enable
                                                                size_hint: .1, 1
                                                                active: False
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step5_Jump_To_lbl', 'NF_Sequence_Step5_Jump_Count_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step5_Jump_To
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step5_Jump_Count_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Jump Count[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step5_Jump_Count
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step5_Step_Termination_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Step Termination[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step5_Step_Termination
                                                                    size_hint: .6, .8
                                                                    input_filter: 'float'
                                                                    text: 'Continue'
                                                                    values: ['Continue', 'Hold', 'End']
                                                                    font_name: './arialuni.ttf' 
                                                                    font_size: root.font_size.environment_setting_font_size

                                            TabbedPanelItem:
                                                
                                                text: 'Step 6'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step6_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step6_AC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step6_AC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step6_DC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]DC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step6_DC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step6_DC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step6_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step6_Frequency
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step6_Frequency_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step6_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step6_Time
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step6_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step6_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step6_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step6_Start_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step6_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step6_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step6_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step6_Off_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step6_Jump_To_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Jump To[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step6_Jump_To_Enable
                                                                size_hint: .1, 1
                                                                active: False
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step6_Jump_To_lbl', 'NF_Sequence_Step6_Jump_Count_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step6_Jump_To
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step6_Jump_Count_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Jump Count[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step6_Jump_Count
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step6_Step_Termination_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Step Termination[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step6_Step_Termination
                                                                    size_hint: .6, .8
                                                                    input_filter: 'float'
                                                                    text: 'Continue'
                                                                    values: ['Continue', 'Hold', 'End']
                                                                    font_name: './arialuni.ttf' 
                                                                    font_size: root.font_size.environment_setting_font_size

                                            TabbedPanelItem:
                                                
                                                text: 'Step 7'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step7_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step7_AC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step7_AC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step7_DC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]DC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step7_DC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step7_DC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step7_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step7_Frequency
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step7_Frequency_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step7_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step7_Time
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step7_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step7_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step7_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step7_Start_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step7_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step7_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step7_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step7_Off_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step7_Jump_To_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Jump To[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step7_Jump_To_Enable
                                                                size_hint: .1, 1
                                                                active: False
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step7_Jump_To_lbl', 'NF_Sequence_Step7_Jump_Count_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step7_Jump_To
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step7_Jump_Count_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Jump Count[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step7_Jump_Count
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step7_Step_Termination_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Step Termination[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step7_Step_Termination
                                                                    size_hint: .6, .8
                                                                    input_filter: 'float'
                                                                    text: 'Continue'
                                                                    values: ['Continue', 'Hold', 'End']
                                                                    font_name: './arialuni.ttf' 
                                                                    font_size: root.font_size.environment_setting_font_size

                                            TabbedPanelItem:
                                                
                                                text: 'Step 8'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step8_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step8_AC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step8_AC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step8_DC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]DC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step8_DC_Voltage
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step8_DC_Voltage_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step8_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: .7, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step8_Frequency
                                                                    size_hint: .5, .8
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                            AnchorLayout:
                                                                size_hint: .3, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step8_Frequency_Mode
                                                                    size_hint: .9, .8
                                                                    text: 'Const'
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    values: ['Const', 'Sweep', 'Keep']

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step8_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step8_Time
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step8_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step8_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step8_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step8_Start_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step8_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step8_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step8_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step8_Off_Phase
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step8_Jump_To_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Jump To[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Sequence_Step8_Jump_To_Enable
                                                                size_hint: .1, 1
                                                                active: False
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Sequence_Step8_Jump_To_lbl', 'NF_Sequence_Step8_Jump_Count_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step8_Jump_To
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step8_Jump_Count_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Jump Count[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Sequence_Step8_Jump_Count
                                                                    size_hint: .3, .8
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Sequence_Step8_Step_Termination_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Step Termination[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Spinner:
                                                                    id: NF_Sequence_Step8_Step_Termination
                                                                    size_hint: .6, .8
                                                                    input_filter: 'float'
                                                                    text: 'End'
                                                                    values: ['Continue', 'Hold', 'End']
                                                                    font_name: './arialuni.ttf' 
                                                                    font_size: root.font_size.environment_setting_font_size

                                        Label:
                                            text: '    Common Param'
                                            size_hint: None, None
                                            size: self.texture_size
                                            font_name: './arialuni.ttf'

                                        AnchorLayout:
                                            size_hint: 1, 1
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: .99, .99

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (0, 0, 0, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .5, 1
                                                        text: 'AC/DC Mode'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: .5, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Spinner:
                                                            id: NF_Sequence_Mode
                                                            size_hint: .6, .8
                                                            text: 'AC'
                                                            font_name: './arialuni.ttf'
                                                            values: ['AC', 'ACDC']
                                                            font_size: root.font_size.experiment_setting_font_size
                                                            on_text: root.NF_sequence_mode_change(self.text)

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .5, 1
                                                        text: 'Time Unit'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: .5, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'                                                    

                                                        Spinner:
                                                            id: NF_Sequence_time_unit
                                                            size_hint: .6, .8
                                                            text: 's'
                                                            values: ['s', 'ms']
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size
                                                            on_text: root.NF_Sequence_Time_Unit(self.text)

                                    BoxLayout:
                                        orientation: 'vertical'
                                        size_hint: 1, 1

                                        Label:
                                            text: '    Meas Result'
                                            size_hint: None, None
                                            size: self.texture_size
                                            font_name: './arialuni.ttf'

                                        AnchorLayout:
                                            size_hint: 1, 1
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            BoxLayout:
                                                orientation: 'vertical'
                                                size_hint: .99, .99

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (0, 0, 0, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Current Step'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: .75, 1
                                                        anchor_x: 'right'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_sequence_rpt_state
                                                            size_hint: .7, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                    AnchorLayout:
                                                        size_hint: .25, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Button:
                                                            text: 'Resume'
                                                            size_hint: .7, .5
                                                            on_release: root.NF_sequence_resume()

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'Voltage (V)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    BoxLayout:
                                                        orientation: 'horizontal'
                                                        size_hint: .6, 1                    

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'RMS'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26

                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_sequence_rpt_voltage_rms
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'AVG'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26

                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_sequence_rpt_voltage_avg
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'Peak max'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26

                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_sequence_rpt_voltage_peak_max
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'Peak min'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26

                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_sequence_rpt_voltage_peak_min
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'Current (A)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    BoxLayout:
                                                        orientation: 'horizontal'
                                                        size_hint: .6, 1                    

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'RMS'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26

                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_sequence_rpt_current_rms
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'AVG'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26
                                                                
                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_sequence_rpt_current_avg
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'Peak max'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26
                                                                
                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_sequence_rpt_current_peak_max
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'Peak min'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26
                                                                
                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'
                                                                
                                                                Label:
                                                                    id: NF_sequence_rpt_current_peak_min
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Appearant Power (VA)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_sequence_rpt_appearant_power
                                                            size_hint: .5, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Active Power (W)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_sequence_rpt_active_power
                                                            size_hint: .5, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height


                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Inactive Power (Var)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_sequence_rpt_inactive_power
                                                            size_hint: .5, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Power Factor'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_sequence_rpt_power_factor
                                                            size_hint: .5, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Crest Factor'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_sequence_rpt_crest_factor
                                                            size_hint: .5, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                            TabbedPanelItem:
                                id: NF_simulation
                                text: 'Simulation'
                                font_name: './arialuni.ttf'
                                background_down: r'.\tabNormal.png'
                                background_normal: r'.\tabDown.PNG'

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    BoxLayout:
                                        orientation: 'vertical'
                                        size_hint: 1, 1

                                        TabbedPanel:
                                            size_hint: 1, 8
                                            do_default_tab: False
                                            
                                            tab_height: 20 

                                            TabbedPanelItem:
                                                
                                                text: 'Initial'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Initial_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Initial_AC_Voltage
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Initial_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Initial_Frequency
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Initial_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Simulation_Initial_Time
                                                                    size_hint: .3, .5
                                                                    text: '[color=404040]--[/color]'
                                                                    markup: True
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Initial_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Simulation_Initial_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Simulation_Initial_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Initial_Start_Phase
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Initial_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Simulation_Initial_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Simulation_Initial_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Initial_Off_Phase
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                            TabbedPanelItem:
                                                
                                                text: 'Normal1'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Normal1_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Normal1_AC_Voltage
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    on_text: root.NF_simulation_normal2_text_sync()

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Normal1_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Normal1_Frequency
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    on_text: root.NF_simulation_normal2_text_sync()

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Normal1_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Normal1_Time
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Normal1_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Simulation_Normal1_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Simulation_Normal1_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Normal1_Start_Phase
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Normal1_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Simulation_Normal1_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Simulation_Normal1_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Normal1_Off_Phase
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                            TabbedPanelItem:
                                                
                                                text: 'Trans1'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Trans1_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Simulation_Trans1_AC_Voltage
                                                                    size_hint: .3, .5
                                                                    text: '[color=404040]--[/color]'
                                                                    markup: True
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Trans1_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Simulation_Trans1_Frequency
                                                                    size_hint: .3, .5
                                                                    text: '[color=404040]--[/color]'
                                                                    markup: True
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Trans1_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Trans1_Time
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Trans1_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            Label:
                                                                size_hint: .1, 1
                                                                text: ''

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Simulation_Trans1_Start_Phase
                                                                    size_hint: .3, .5
                                                                    text: '[color=404040]--[/color]'
                                                                    markup: True
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Trans1_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            Label:
                                                                size_hint: .1, 1
                                                                text: ''

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Simulation_Trans1_Off_Phase
                                                                    size_hint: .3, .5
                                                                    text: '[color=404040]--[/color]'
                                                                    markup: True
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                            TabbedPanelItem:
                                                
                                                text: 'Abnormal'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Abnormal_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Abnormal_AC_Voltage
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '220'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Abnormal_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Abnormal_Frequency
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '60'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Abnormal_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Abnormal_Time
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Abnormal_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Simulation_Abnormal_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Simulation_Abnormal_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Abnormal_Start_Phase
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Abnormal_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Simulation_Abnormal_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Simulation_Abnormal_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Abnormal_Off_Phase
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                            TabbedPanelItem:
                                                
                                                text: 'Trans2'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Trans2_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Simulation_Trans2_AC_Voltage
                                                                    size_hint: .3, .5
                                                                    text: '[color=404040]--[/color]'
                                                                    markup: True
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Trans2_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=404040]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Simulation_Trans2_Frequency
                                                                    size_hint: .3, .5
                                                                    text: '[color=404040]--[/color]'
                                                                    markup: True
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Trans2_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Trans2_Time
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Trans2_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            Label:
                                                                size_hint: .1, 1
                                                                text: ''

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Simulation_Trans2_Start_Phase
                                                                    size_hint: .3, .5
                                                                    text: '[color=404040]--[/color]'
                                                                    markup: True
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Trans2_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=404040]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            Label:
                                                                size_hint: .1, 1
                                                                text: ''

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Simulation_Trans2_Off_Phase
                                                                    size_hint: .3, .5
                                                                    text: '[color=404040]--[/color]'
                                                                    markup: True
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                            TabbedPanelItem:
                                                
                                                text: 'Normal2'
                                                font_name: './arialuni.ttf'
                                                background_down: r'.\tabNormal.png'
                                                background_normal: r'.\tabDown.PNG'

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (.2, .2, .2, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    BoxLayout:
                                                        orientation: 'vertical'
                                                        size_hint: .99, .99

                                                        canvas.before:
                                                            Color: 
                                                                group: 'Color'
                                                                rgba: (0, 0, 0, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height 

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Normal2_AC_Voltage_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]AC Voltage (V)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Simulation_Normal2_AC_Voltage
                                                                    size_hint: .3, .5
                                                                    text: '[color=ffffff]220[/color]'
                                                                    markup: True
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Normal2_Frequency_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Frequency (Hz)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                Label:
                                                                    id: NF_Simulation_Normal2_Frequency
                                                                    size_hint: .3, .5
                                                                    text: '[color=ffffff]60[/color]'
                                                                    markup: True
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: root.font_size.environment_setting_font_size
                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Normal2_Time_lbl
                                                                size_hint: 1, 1
                                                                text: '[color=ffffff]Time (s)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Normal2_Time
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '1'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Normal2_Start_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Start Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Simulation_Normal2_Start_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Simulation_Normal2_Start_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Normal2_Start_Phase
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                                        BoxLayout:
                                                            orientation: 'horizontal'
                                                            size_hint: 1, 1

                                                            Label:
                                                                id: NF_Simulation_Normal2_Off_Phase_lbl
                                                                size_hint: .9, 1
                                                                text: '[color=ffffff]Off Phase (deg)[/color]'
                                                                font_name: './arialuni.ttf'
                                                                font_size: root.font_size.experiment_setting_font_size
                                                                markup: True

                                                            CheckBox:
                                                                id: NF_Simulation_Normal2_Off_Phase_Enable
                                                                size_hint: .1, 1
                                                                active: True
                                                                on_active: root.NF_simulation_checkbox(self.active, ['NF_Simulation_Normal2_Off_Phase_lbl'])

                                                            AnchorLayout:
                                                                size_hint: 1, 1
                                                                anchor_x: 'center'
                                                                anchor_y: 'center'

                                                                TextInput:
                                                                    id: NF_Simulation_Normal2_Off_Phase
                                                                    size_hint: .3, .5
                                                                    input_filter: 'float'
                                                                    text: '0'
                                                                    font_name: './arialuni.ttf'
                                                                    text_validate_unfocus: True
                                                                    multiline: False                                    
                                                                    padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                                    padding_y: ( self.height - self.line_height ) / 2  
                                                                    font_size: root.font_size.environment_setting_font_size

                                        Label:
                                            text: '    Common Param'
                                            size_hint: None, None
                                            size: self.texture_size
                                            font_name: './arialuni.ttf'

                                        AnchorLayout:
                                            size_hint: 1, 2
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            BoxLayout:
                                                orientation: 'vertical'
                                                size_hint: .99, .99

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (0, 0, 0, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'Test Round'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: .6, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'                                                    

                                                        TextInput:
                                                            id: NF_Simulation_repeat
                                                            size_hint: .3, .8
                                                            input_filter: 'int'
                                                            text: '1'
                                                            font_name: './arialuni.ttf'
                                                            text_validate_unfocus: True
                                                            multiline: False                                    
                                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                                            padding_y: ( self.height - self.line_height ) / 2  
                                                            font_size: root.font_size.environment_setting_font_size

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'Time Unit'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: .6, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'                                                    

                                                        Spinner:
                                                            id: NF_Simulation_time_unit
                                                            size_hint: .3, .8
                                                            text: 's'
                                                            values: ['s', 'ms']
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size
                                                            on_text: root.NF_Simulation_Time_Unit(self.text)

                                    BoxLayout:
                                        orientation: 'vertical'
                                        size_hint: 1, 1

                                        Label:
                                            text: '    Meas Result'
                                            size_hint: None, None
                                            size: self.texture_size
                                            font_name: './arialuni.ttf'

                                        AnchorLayout:
                                            size_hint: 1, 1
                                            anchor_x: 'center'
                                            anchor_y: 'center'

                                            BoxLayout:
                                                orientation: 'vertical'
                                                size_hint: .99, .99

                                                canvas.before:
                                                    Color: 
                                                        group: 'Color'
                                                        rgba: (0, 0, 0, 1)
                                                    Rectangle: 
                                                        pos: self.x, self.y
                                                        size: self.width, self.height 

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Current State'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_simulation_rpt_state
                                                            size_hint: .5, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'Voltage (V)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    BoxLayout:
                                                        orientation: 'horizontal'
                                                        size_hint: .6, 1                    

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'RMS'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26

                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_simulation_rpt_voltage_rms
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'AVG'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26

                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_simulation_rpt_voltage_avg
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'Peak max'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26

                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_simulation_rpt_voltage_peak_max
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'Peak min'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26

                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_simulation_rpt_voltage_peak_min
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: .4, 1
                                                        text: 'Current (A)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    BoxLayout:
                                                        orientation: 'horizontal'
                                                        size_hint: .6, 1                    

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'RMS'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26

                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_simulation_rpt_current_rms
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'AVG'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26
                                                                
                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_simulation_rpt_current_avg
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'Peak max'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26
                                                                
                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'

                                                                Label:
                                                                    id: NF_simulation_rpt_current_peak_max
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                        BoxLayout:
                                                            orientation: 'vertical'
                                                            size_hint: 1, 1 

                                                            Label:
                                                                size_hint: 1, .5
                                                                text: 'Peak min'
                                                                font_name: './arialuni.ttf'
                                                                font_size: 26
                                                                
                                                            AnchorLayout:
                                                                size_hint: 1, .5
                                                                anchor_x: 'center'
                                                                anchor_y: 'top'
                                                                
                                                                Label:
                                                                    id: NF_simulation_rpt_current_peak_min
                                                                    text: ''
                                                                    size_hint: .8, .8
                                                                    font_name: './arialuni.ttf'
                                                                    font_size: 20

                                                                    canvas.before:
                                                                        Color: 
                                                                            rgba: (.2, .2, .2, 1)                                                    
                                                                        Line:
                                                                            rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                            width: 2
                                                                        Color: 
                                                                            rgba: (.1, .1, .1, 1)
                                                                        Rectangle: 
                                                                            pos: self.x, self.y
                                                                            size: self.width, self.height

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Appearant Power (VA)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_simulation_rpt_appearant_power
                                                            size_hint: .5, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Active Power (W)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_simulation_rpt_active_power
                                                            size_hint: .5, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height


                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Inactive Power (Var)'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_simulation_rpt_inactive_power
                                                            size_hint: .5, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Power Factor'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_simulation_rpt_power_factor
                                                            size_hint: .5, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                                                BoxLayout:
                                                    orientation: 'horizontal'
                                                    size_hint: 1, 1

                                                    Label:
                                                        size_hint: 1, 1
                                                        text: 'Crest Factor'
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                    AnchorLayout:
                                                        size_hint: 1, 1
                                                        anchor_x: 'center'
                                                        anchor_y: 'center'

                                                        Label:
                                                            id: NF_simulation_rpt_crest_factor
                                                            size_hint: .5, .8
                                                            text: ''
                                                            font_name: './arialuni.ttf'
                                                            font_size: root.font_size.experiment_setting_font_size

                                                            canvas.before:
                                                                Color: 
                                                                    rgba: (.2, .2, .2, 1)                                                    
                                                                Line:
                                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                    width: 2
                                                                Color: 
                                                                    rgba: (.1, .1, .1, 1)
                                                                Rectangle: 
                                                                    pos: self.x, self.y
                                                                    size: self.width, self.height

                        BoxLayout:
                            orientation: 'horizontal'
                            size_hint: 1, .1

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'

                                Button:
                                    size_hint: .8, .8
                                    text: 'Start'
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.NF_start()

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    size_hint: .8, .8
                                    text: 'Stop'
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.NF_stop()

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    size_hint: .8, .8
                                    text: 'Load'
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.loadtos5200Cfg()

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    size_hint: .8, .8
                                    text: 'Save'
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.save_NF_setting_cfg()

                            BoxLayout:
                                orientation: 'vertical'
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Label:
                                    size_hint: 1, .3
                                    text: 'Saved Config Name:'

                                AnchorLayout:
                                    size_hint: 1, .7
                                    anchor_x: 'center'
                                    anchor_y: 'top' 

                                    TextInput:
                                        id: NF_setting_save_cfg
                                        size_hint: .6, .8
                                        text: 'Default'
                                        font_name: './arialuni.ttf'
                                        text_validate_unfocus: True
                                        multiline: False                                    
                                        padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                        padding_y: ( self.height - self.line_height ) / 2  
                                        font_size: root.font_size.experiment_setting_font_size

                TabbedPanelItem:
                    
                    text: 'MDO4034C'
                    font_name: './arialuni.ttf'
                    background_down: r'.\tabNormal.png'
                    background_normal: r'.\tabDown.PNG'

                    BoxLayout:
                        orientation: 'vertical'
                        size_hint: 1, 1

                        canvas.before:
                            Color: 
                                group: 'Color'
                                rgba: (.2, .2, .2, 1)
                            Rectangle: 
                                pos: self.x, self.y
                                size: self.width, self.height 

                        BoxLayout:
                            orientation: 'vertical'
                            size_hint: 1, 1

                            BoxLayout:
                                orientation: 'horizontal'
                                size_hint: 1, 1

                                BoxLayout:
                                    orientation: 'vertical'
                                    size_hint: 1, 1

                                    Label:
                                        text: '    Config'
                                        size_hint: None, None
                                        size: self.texture_size
                                        font_name: './arialuni.ttf'

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .99, .99

                                            canvas.before:
                                                Color: 
                                                    group: 'Color'
                                                    rgba: (0, 0, 0, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height 

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: ''

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'CH1'
                                                    markup: True
                                                    font_size: root.font_size.experiment_setting_font_size

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'CH2'
                                                    markup: True
                                                    font_size: root.font_size.experiment_setting_font_size

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'CH3'
                                                    markup: True
                                                    font_size: root.font_size.experiment_setting_font_size

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'CH4'
                                                    markup: True
                                                    font_size: root.font_size.experiment_setting_font_size

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Enable'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                CheckBox:
                                                    id: MDO4034C_Ch1_Enable
                                                    size_hint: 1, 1
                                                    active: True
                                                    on_active: root.MDO4034C_enable_active('MDO4034C_Ch1_Enable', 1)

                                                CheckBox:
                                                    id: MDO4034C_Ch2_Enable
                                                    size_hint: 1, 1
                                                    active: True
                                                    on_active: root.MDO4034C_enable_active('MDO4034C_Ch2_Enable', 2)

                                                CheckBox:
                                                    id: MDO4034C_Ch3_Enable
                                                    size_hint: 1, 1
                                                    active: True
                                                    on_active: root.MDO4034C_enable_active('MDO4034C_Ch3_Enable', 3)

                                                CheckBox:
                                                    id: MDO4034C_Ch4_Enable
                                                    size_hint: 1, 1
                                                    active: True
                                                    on_active: root.MDO4034C_enable_active('MDO4034C_Ch4_Enable', 4)

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Measure'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                CheckBox:
                                                    id: MDO4034C_Ch1_Measure
                                                    size_hint: 1, 1
                                                    active: True
                                                    on_active: root.MDO4034C_meas_enable_active('MDO4034C_Ch1_Measure', 1)

                                                CheckBox:
                                                    id: MDO4034C_Ch2_Measure
                                                    size_hint: 1, 1
                                                    active: True
                                                    on_active: root.MDO4034C_meas_enable_active('MDO4034C_Ch2_Measure', 2)

                                                CheckBox:
                                                    id: MDO4034C_Ch3_Measure
                                                    size_hint: 1, 1
                                                    active: False
                                                    on_active: root.MDO4034C_meas_enable_active('MDO4034C_Ch3_Measure', 3)

                                                CheckBox:
                                                    id: MDO4034C_Ch4_Measure
                                                    size_hint: 1, 1
                                                    active: False
                                                    on_active: root.MDO4034C_meas_enable_active('MDO4034C_Ch4_Measure', 4)

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Coupling'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch1_Coupling
                                                        size_hint: .8, .6
                                                        text: 'AC'
                                                        values: ['AC', 'DC']
                                                        font_size: root.font_size.experiment_setting_font_size                                    

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch2_Coupling
                                                        size_hint: .8, .6
                                                        text: 'AC'
                                                        values: ['AC', 'DC']
                                                        font_size: root.font_size.experiment_setting_font_size     

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch3_Coupling
                                                        size_hint: .8, .6
                                                        text: 'AC'
                                                        values: ['AC', 'DC']
                                                        font_size: root.font_size.experiment_setting_font_size     

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch4_Coupling
                                                        size_hint: .8, .6
                                                        text: 'AC'
                                                        values: ['AC', 'DC']
                                                        font_size: root.font_size.experiment_setting_font_size     

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Termination\n     (ohm)'
                                                    font_size: root.font_size.experiment_setting_font_size - 10

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch1_Termination
                                                        size_hint: .8, .6
                                                        text: '1M'
                                                        values: ['1M', '50']
                                                        font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch2_Termination
                                                        size_hint: .8, .6
                                                        text: '1M'
                                                        values: ['1M', '50']
                                                        font_size: root.font_size.experiment_setting_font_size  

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch3_Termination
                                                        size_hint: .8, .6
                                                        text: '1M'
                                                        values: ['1M', '50']
                                                        font_size: root.font_size.experiment_setting_font_size     

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch4_Termination
                                                        size_hint: .8, .6
                                                        text: '1M'
                                                        values: ['1M', '50']
                                                        font_size: root.font_size.experiment_setting_font_size

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Invert'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch1_Invert
                                                        size_hint: .8, .6
                                                        text: 'OFF'
                                                        values: ['ON', 'OFF']
                                                        font_size: root.font_size.experiment_setting_font_size                                    

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch2_Invert
                                                        size_hint: .8, .6
                                                        text: 'OFF'
                                                        values: ['ON', 'OFF']
                                                        font_size: root.font_size.experiment_setting_font_size       

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch3_Invert
                                                        size_hint: .8, .6
                                                        text: 'OFF'
                                                        values: ['ON', 'OFF']
                                                        font_size: root.font_size.experiment_setting_font_size    

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch4_Invert
                                                        size_hint: .8, .6
                                                        text: 'OFF'
                                                        values: ['ON', 'OFF']
                                                        font_size: root.font_size.experiment_setting_font_size    

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Bandwidth\n    (MHz)'
                                                    font_size: root.font_size.experiment_setting_font_size - 10

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch1_Bandwidth
                                                        size_hint: .8, .6
                                                        text: '350'
                                                        values: ['350', '250', '20']
                                                        font_size: root.font_size.experiment_setting_font_size                                    

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch2_Bandwidth
                                                        size_hint: .8, .6
                                                        text: '350'
                                                        values: ['350', '250', '20']
                                                        font_size: root.font_size.experiment_setting_font_size      

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch3_Bandwidth
                                                        size_hint: .8, .6
                                                        text: '350'
                                                        values: ['350', '250', '20']
                                                        font_size: root.font_size.experiment_setting_font_size       

                                                AnchorLayout:
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Ch4_Bandwidth
                                                        size_hint: .8, .6
                                                        text: '350'
                                                        values: ['350', '250', '20']
                                                        font_size: root.font_size.experiment_setting_font_size    

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Length'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout
                                                    size_hint: 4, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Length
                                                        size_hint: .3, .6
                                                        text: '10000'
                                                        values: ['1000', '10000', '100000', '1M', '5M', '10M', '20M']
                                                        font_size: root.font_size.experiment_setting_font_size   

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Scale'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout
                                                    size_hint: 2, 1
                                                    anchor_x: 'right'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Scale
                                                        size_hint: .3, .6
                                                        text: '1'
                                                        values: ['1', '2', '4', '10', '20', '40', '100', '200', '400']
                                                        font_name: './arialuni.ttf'                        
                                                        font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout
                                                    size_hint: 2, 1
                                                    anchor_x: 'left'
                                                    anchor_y: 'center'

                                                    Spinner:
                                                        id: MDO4034C_Scale_Unit
                                                        size_hint: .3, .6
                                                        text: 's'
                                                        values: ['s', 'ms', 'us', 'ns']
                                                        font_name: './arialuni.ttf'                        
                                                        font_size: root.font_size.experiment_setting_font_size

                                BoxLayout:
                                    orientation: 'vertical'
                                    size_hint: 1, 1

                                    Label:
                                        text: '    Report'
                                        size_hint: None, None
                                        size: self.texture_size
                                        font_name: './arialuni.ttf'

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        BoxLayout:
                                            orientation: 'vertical'
                                            size_hint: .99, .99

                                            canvas.before:
                                                Color: 
                                                    group: 'Color'
                                                    rgba: (0, 0, 0, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height 

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: ''

                                                Label:
                                                    id: MDO4034C_Ch1_Label
                                                    size_hint: 1, 1
                                                    text: 'CH1'
                                                    font_size: root.font_size.experiment_setting_font_size
                                                    markup: True

                                                Label:
                                                    id: MDO4034C_Ch2_Label
                                                    size_hint: 1, 1
                                                    text: 'CH2'
                                                    font_size: root.font_size.experiment_setting_font_size
                                                    markup: True

                                                Label:
                                                    id: MDO4034C_Ch3_Label
                                                    size_hint: 1, 1
                                                    text: 'CH3'
                                                    font_size: root.font_size.experiment_setting_font_size
                                                    markup: True

                                                Label:
                                                    id: MDO4034C_Ch4_Label
                                                    size_hint: 1, 1
                                                    text: 'CH4'
                                                    font_size: root.font_size.experiment_setting_font_size
                                                    markup: True

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Frequency'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Frequency_Ch1
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Frequency_Ch2
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Frequency_Ch3
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Frequency_Ch4
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'RMS'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Rms_Ch1
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Rms_Ch2
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Rms_Ch3
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Rms_Ch4
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Max'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Max_Ch1
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Max_Ch2
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Max_Ch3
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Max_Ch4
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Min'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Min_Ch1
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Min_Ch2
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Min_Ch3
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                                AnchorLayout
                                                    size_hint: 1, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Min_Ch4
                                                        size_hint: .8, .6
                                                        text: ''
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Length'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout
                                                    size_hint: 4, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Length_rpt
                                                        size_hint: .3, .6
                                                        text: ''
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Scale'
                                                    font_size: root.font_size.experiment_setting_font_size

                                                AnchorLayout
                                                    size_hint: 4, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Scale_rpt
                                                        size_hint: .3, .6
                                                        text: ''
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                                            BoxLayout:
                                                orientation: 'horizontal'
                                                size_hint: 1, 1

                                                Label:
                                                    size_hint: 1, 1
                                                    text: 'Sample\n   Rate'
                                                    font_size: root.font_size.experiment_setting_font_size - 10

                                                AnchorLayout
                                                    size_hint: 4, 1
                                                    anchor_x: 'center'
                                                    anchor_y: 'center'

                                                    Label:
                                                        id: MDO4034C_Sample_Rate
                                                        size_hint: .3, .6
                                                        text: ''
                                                        font_name: './arialuni.ttf'
                                                        font_size: root.font_size.experiment_setting_font_size

                                                        canvas.before:
                                                            Color: 
                                                                rgba: (.2, .2, .2, 1)                                                    
                                                            Line:
                                                                rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                                width: 2
                                                            Color: 
                                                                rgba: (.1, .1, .1, 1)
                                                            Rectangle: 
                                                                pos: self.x, self.y
                                                                size: self.width, self.height

                        BoxLayout:
                            orientation: 'horizontal'
                            size_hint: 1, .1

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'

                                Button:
                                    size_hint: .8, .8
                                    text: 'Run'
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.MDO4034C_run()

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    size_hint: .8, .8
                                    text: 'Stop'
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.MDO4034C_stop()

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    size_hint: .8, .8
                                    text: 'Load'
                                    font_size: root.font_size.experiment_setting_font_size
                                    # on_release: root.loadtos5200Cfg()

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    size_hint: .8, .8
                                    text: 'Save'
                                    font_size: root.font_size.experiment_setting_font_size
                                    # on_release: root.save_NF_setting_cfg()

                            BoxLayout:
                                orientation: 'vertical'
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Label:
                                    size_hint: 1, .3
                                    text: 'Saved Config Name:'

                                AnchorLayout:
                                    size_hint: 1, .7
                                    anchor_x: 'center'
                                    anchor_y: 'top' 

                                    TextInput:
                                        id: MDO4034C_setting_save_cfg
                                        size_hint: .6, .8
                                        text: 'Default'
                                        font_name: './arialuni.ttf'
                                        text_validate_unfocus: True
                                        multiline: False                                    
                                        padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                        padding_y: ( self.height - self.line_height ) / 2  
                                        font_size: root.font_size.experiment_setting_font_size

                TabbedPanelItem:
                    
                    text: 'T-Machine'
                    font_name: './arialuni.ttf'
                    background_down: r'.\tabNormal.png'
                    background_normal: r'.\tabDown.PNG'

                    BoxLayout:
                        orientation: 'vertical'
                        size_hint: 1, 1

                        canvas.before:
                            Color: 
                                group: 'Color'
                                rgba: (.2, .2, .2, 1)
                            Rectangle: 
                                pos: self.x, self.y
                                size: self.width, self.height 

                        Label:
                            text: '    Config'
                            size_hint: None, None
                            size: self.texture_size
                            font_name: './arialuni.ttf'

                        AnchorLayout:
                            size_hint: 1, 2
                            anchor_x: 'center'
                            anchor_y: 'top'

                            BoxLayout:
                                orientation: 'vertical'
                                size_hint: .99, .99

                                canvas.before:
                                    Color: 
                                        group: 'Color'
                                        rgba: (0, 0, 0, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    Label:
                                        size_hint: 1, 1
                                        text: '溫度 (℃)'
                                        font_name: './arialuni.ttf'
                                        font_size: root.font_size.experiment_setting_font_size + 10

                                    Label:
                                        size_hint: 1, 1
                                        text: '濕度 (%)'
                                        font_name: './arialuni.ttf'
                                        font_size: root.font_size.experiment_setting_font_size + 10

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'                                                    

                                        TextInput:
                                            id: T_Machine_Temperature
                                            size_hint: .3, .8
                                            input_filter: 'float'
                                            text: '36.00'
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.environment_setting_font_size + 10

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'   

                                        TextInput:
                                            id: T_Machine_Humidity
                                            size_hint: .3, .8
                                            input_filter: 'float'
                                            text: '0.00'
                                            font_name: './arialuni.ttf'
                                            text_validate_unfocus: True
                                            multiline: False                                    
                                            padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                            padding_y: ( self.height - self.line_height ) / 2  
                                            font_size: root.font_size.environment_setting_font_size + 10

                        Label:
                            text: '    Report'
                            size_hint: None, None
                            size: self.texture_size
                            font_name: './arialuni.ttf'

                        AnchorLayout:
                            size_hint: 1, 5
                            anchor_x: 'center'
                            anchor_y: 'top'

                            BoxLayout:
                                orientation: 'vertical'
                                size_hint: .99, .99

                                canvas.before:
                                    Color: 
                                        group: 'Color'
                                        rgba: (0, 0, 0, 1)
                                    Rectangle: 
                                        pos: self.x, self.y
                                        size: self.width, self.height 

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    Label:
                                        size_hint: 1, 1
                                        text: ''
                                        font_name: './arialuni.ttf'
                                        font_size: root.font_size.experiment_setting_font_size + 10

                                    Label:
                                        size_hint: 1, 1
                                        text: 'Current'
                                        font_name: './arialuni.ttf'
                                        font_size: root.font_size.experiment_setting_font_size + 10

                                    Label:
                                        size_hint: 1, 1
                                        text: 'Set Point'
                                        font_name: './arialuni.ttf'
                                        font_size: root.font_size.experiment_setting_font_size + 10

                                    Label:
                                        size_hint: 1, 1
                                        text: 'Target SP'
                                        font_name: './arialuni.ttf'
                                        font_size: root.font_size.experiment_setting_font_size + 10

                                    Label:
                                        size_hint: 1, 1
                                        text: 'Output'
                                        font_name: './arialuni.ttf'
                                        font_size: root.font_size.experiment_setting_font_size + 10

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    Label:
                                        size_hint: 1, 1
                                        text: '溫度 (℃)'
                                        font_name: './arialuni.ttf'
                                        font_size: root.font_size.experiment_setting_font_size + 10

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: T_Machine_Temperature_Current
                                            size_hint: .5, .6
                                            text: ''
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.experiment_setting_font_size + 10

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: T_Machine_Temperature_Set_Point
                                            size_hint: .5, .6
                                            text: ''
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.experiment_setting_font_size + 10

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: T_Machine_Temperature_Target_Set_Point
                                            size_hint: .5, .6
                                            text: ''
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.experiment_setting_font_size + 10

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: T_Machine_Temperature_Output
                                            size_hint: .5, .6
                                            text: ''
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.experiment_setting_font_size + 10

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                BoxLayout:
                                    orientation: 'horizontal'
                                    size_hint: 1, 1

                                    Label:
                                        size_hint: 1, 1
                                        text: '濕度 (%)'
                                        font_name: './arialuni.ttf'
                                        font_size: root.font_size.experiment_setting_font_size + 10

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: T_Machine_Humidity_Current
                                            size_hint: .5, .6
                                            text: ''
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.experiment_setting_font_size + 10

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: T_Machine_Humidity_Set_Point
                                            size_hint: .5, .6
                                            text: ''
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.experiment_setting_font_size + 10

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: T_Machine_Humidity_Target_Set_Point
                                            size_hint: .5, .6
                                            text: ''
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.experiment_setting_font_size + 10

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                                    AnchorLayout:
                                        size_hint: 1, 1
                                        anchor_x: 'center'
                                        anchor_y: 'center'

                                        Label:
                                            id: T_Machine_Humidity_Output
                                            size_hint: .5, .6
                                            text: ''
                                            font_name: './arialuni.ttf'
                                            font_size: root.font_size.experiment_setting_font_size + 10

                                            canvas.before:
                                                Color: 
                                                    rgba: (.2, .2, .2, 1)                                                    
                                                Line:
                                                    rectangle: self.x+1,self.y+1,self.width-1,self.height-1
                                                    width: 2
                                                Color: 
                                                    rgba: (.1, .1, .1, 1)
                                                Rectangle: 
                                                    pos: self.x, self.y
                                                    size: self.width, self.height

                        BoxLayout:
                            orientation: 'horizontal'
                            size_hint: 1, 1

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'

                                Button:
                                    size_hint: .8, .8
                                    text: 'Start'
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.T_Machine_start()

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    size_hint: .8, .8
                                    text: 'Stop'
                                    font_size: root.font_size.experiment_setting_font_size
                                    on_release: root.T_Machine_stop()

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    size_hint: .8, .8
                                    text: 'Load'
                                    font_size: root.font_size.experiment_setting_font_size
                                    # on_release: root.loadtos5200Cfg()

                            AnchorLayout:
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Button:
                                    size_hint: .8, .8
                                    text: 'Save'
                                    font_size: root.font_size.experiment_setting_font_size
                                    # on_release: root.save_NF_setting_cfg()

                            BoxLayout:
                                orientation: 'vertical'
                                size_hint: .2, 1
                                anchor_x: 'center'
                                anchor_y: 'center'    

                                Label:
                                    size_hint: 1, .3
                                    text: 'Saved Config Name:'

                                AnchorLayout:
                                    size_hint: 1, .7
                                    anchor_x: 'center'
                                    anchor_y: 'top' 

                                    TextInput:
                                        id: T_Machine_setting_save_cfg
                                        size_hint: .6, .8
                                        text: 'Default'
                                        font_name: './arialuni.ttf'
                                        text_validate_unfocus: True
                                        multiline: False                                    
                                        padding_x: (self.width - self._get_text_width( self.text, self.tab_width, self._label_cached))/2  
                                        padding_y: ( self.height - self.line_height ) / 2  
                                        font_size: root.font_size.experiment_setting_font_size

<PopUpDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"

        Label:            
            id: fileName
            text: root.text

        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'center' 

            Button:
                size_hint: .5, .7
                text: "Ok"
                font_size: 20
                on_release: root.cancel()

<PopUpDialogNoCancel>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"

        Label:            
            id: fileName
            text: root.text

<LoadFileDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"

        FileChooserIconView
            id: fileChooserLoadFile
            path: './/'
            filters: ['*.TXT']
            on_selection: root.showFileName(fileChooserLoadFile.selection)

        BoxLayout:
            size_hint: 1, None
            height: 30        
            orientation: "horizontal"

            Label:            
                id: fileName
                text: ''

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.chooseFile(fileChooserLoadFile.path, fileChooserLoadFile.selection)

<LoadExpCfgDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"

        FileChooserIconView
            id: fileChooserLoadExpCfg
            path: './/'
            filters: ['*.TXT']
            on_selection: root.showExpCfgName(fileChooserLoadExpCfg.selection)

        BoxLayout:
            size_hint: 1, None
            height: 30        
            orientation: "horizontal"

            Label:            
                id: expCfgName
                text: ''

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.chooseExpCfg(fileChooserLoadExpCfg.path, fileChooserLoadExpCfg.selection)

<LoadTempCfgDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"

        FileChooserIconView
            id: fileChooserLoadTempCfg
            path: './/'
            filters: ['*.TXT']
            on_selection: root.showTempCfgName(fileChooserLoadTempCfg.selection)

        BoxLayout:
            size_hint: 1, None
            height: 30        
            orientation: "horizontal"

            Label:            
                id: tempCfgName
                text: ''

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.chooseTempCfg(fileChooserLoadTempCfg.path, fileChooserLoadTempCfg.selection)

<LoadScriptCfgDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"

        FileChooserIconView
            id: fileChooserLoadScriptCfg
            path: './/'
            filters: ['*.TXT']
            on_selection: root.showScriptCfgName(fileChooserLoadScriptCfg.selection)

        BoxLayout:
            size_hint: 1, None
            height: 30        
            orientation: "horizontal"

            Label:            
                id: scriptCfgName
                text: ''

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.chooseScriptCfg(fileChooserLoadScriptCfg.path, fileChooserLoadScriptCfg.selection)

<LoadEnvCfgDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"

        FileChooserIconView
            id: fileChooserLoadEnvCfg
            path: './/'
            filters: ['*.TXT']
            on_selection: root.showEnvCfgName(fileChooserLoadEnvCfg.selection)

        BoxLayout:
            size_hint: 1, None
            height: 30        
            orientation: "horizontal"

            Label:            
                id: envCfgName
                text: ''

        BoxLayout:
            size_hint: 1, .3  
            orientation: "horizontal"

            BoxLayout:
                size_hint: .125, 1  
                orientation: "vertical"

                Label:            
                    size_hint: 1, .5 
                    text: root.setting_id.environment_setting_lbl[0]
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

                Label:            
                    id: envCfgDetail_0
                    size_hint: 1, .5 
                    text: ''
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

            BoxLayout:
                size_hint: .125, 1  
                orientation: "vertical"

                Label:            
                    size_hint: 1, .5 
                    text: root.setting_id.environment_setting_lbl[1]
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

                Label:            
                    id: envCfgDetail_1
                    size_hint: 1, .5 
                    text: ''
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

            BoxLayout:
                size_hint: .125, 1  
                orientation: "vertical"

                Label:            
                    size_hint: 1, .5 
                    text: root.setting_id.environment_setting_lbl[2]
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

                Label:            
                    id: envCfgDetail_2
                    size_hint: 1, .5 
                    text: ''
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

            BoxLayout:
                size_hint: .125, 1  
                orientation: "vertical"

                Label:            
                    size_hint: 1, .5 
                    text: root.setting_id.environment_setting_lbl[3]
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

                Label:            
                    id: envCfgDetail_3
                    size_hint: 1, .5 
                    text: ''
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

            BoxLayout:
                size_hint: .125, 1  
                orientation: "vertical"

                Label:            
                    size_hint: 1, .5 
                    text: root.setting_id.environment_setting_lbl[4]
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

                Label:            
                    id: envCfgDetail_4
                    size_hint: 1, .5 
                    text: ''
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

            BoxLayout:
                size_hint: .125, 1  
                orientation: "vertical"

                Label:            
                    size_hint: 1, .5 
                    text: root.setting_id.environment_setting_lbl[5]
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

                Label:            
                    id: envCfgDetail_5
                    size_hint: 1, .5 
                    text: ''
                    font_name: './arialuni.ttf'
                    font_size: root.font_size

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.chooseEnvCfg(fileChooserLoadEnvCfg.path, fileChooserLoadEnvCfg.selection)

<Loadtos5200CfgDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"

        FileChooserIconView
            id: fileChooserLoadtos5200Cfg
            path: './/'
            filters: ['*.TXT']
            on_selection: root.showtos5200CfgName(fileChooserLoadtos5200Cfg.selection)

        BoxLayout:
            size_hint: 1, None
            height: 30        
            orientation: "horizontal"

            Label:            
                id: tos5200CfgName
                text: ''

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.choosetos5200Cfg(fileChooserLoadtos5200Cfg.path, fileChooserLoadtos5200Cfg.selection)

<MatplotFigure>:
    canvas:
        Color:
            rgb: (1, 1, 1)
        Rectangle:
            pos: self.pos
            size: self.size
            texture: self._img_texture
        Color:
            rgba: 1, 0, 0, 0.5
        BorderImage:
            pos: self._box_pos
            size: self._box_size
            border: 0, 0, 0, 0                            
# <MatplotNavToolbar_0>:  
# <MatplotNavToolbar_1>:     
# <MatplotNavToolbar_reload_0>:  
# <MatplotNavToolbar_reload_1>:  
''')

class TestCamera(App):

    def build(self):
        return presentation

TestCamera().run()
 